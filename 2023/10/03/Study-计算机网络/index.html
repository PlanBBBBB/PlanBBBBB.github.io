<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>计算机网络 | PlanB's Blog</title><meta name="author" content="PlanB,2741718884@qq.com"><meta name="copyright" content="PlanB"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="计算机网络笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络">
<meta property="og:url" content="https://planbbbbb.github.io/2023/10/03/Study-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html">
<meta property="og:site_name" content="PlanB&#39;s Blog">
<meta property="og:description" content="计算机网络笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://planbbbbb.github.io/img/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.png">
<meta property="article:published_time" content="2023-10-03T13:30:58.476Z">
<meta property="article:modified_time" content="2024-01-11T14:59:26.438Z">
<meta property="article:author" content="PlanB">
<meta property="article:tag" content="408">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://planbbbbb.github.io/img/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.png"><link rel="shortcut icon" href="/./img/%E9%A5%AE%E6%96%99.png"><link rel="canonical" href="https://planbbbbb.github.io/2023/10/03/Study-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机网络',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-11 22:59:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/%E5%A4%B4%E5%83%8F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/../img/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">PlanB's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机网络</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-03T13:30:58.476Z" title="发表于 2023-10-03 21:30:58">2023-10-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-11T14:59:26.438Z" title="更新于 2024-01-11 22:59:26">2024-01-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Study/">Study</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计算机网络"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>[TOC]</p>
<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>本篇文章参考自：</p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1c4411d7jb">https://www.bilibili.com/video/BV1c4411d7jb</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://frxcat.fun/pages/39e2a1/">https://frxcat.fun/pages/39e2a1/</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/BloothOfYouth/Computer-Network-Notes">https://github.com/BloothOfYouth/Computer-Network-Notes</a></p>
</li>
</ol>
<p>做题视频：P12，P13，P18，P19，P23，P30</p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ol>
<li>网络</li>
</ol>
<p>计算机网络由若干的<strong>结点</strong>(node)和连接这些结点的<strong>链路</strong>(link)组成。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118164945924.png" alt="image-20231118164945924"></p>
<ol start="2">
<li>互联网</li>
</ol>
<p>网络的网络就叫互联网，网络和网络之间还可以通过路由器相互连接起来，构造成一个更大的计算机网络。</p>
<ol start="3">
<li>因特网</li>
</ol>
<p>世界上最大的互联网就是因特网。</p>
<ol start="4">
<li>互联网的组成</li>
</ol>
<p>互联网主要包括下述两个部分：</p>
<ul>
<li>边缘部分</li>
</ul>
<ol>
<li>有所有连接在互联网上的主机组成</li>
<li>是用户<strong>直接使用</strong>的</li>
<li>用来通信和资源共享</li>
</ol>
<ul>
<li>核心部分</li>
</ul>
<ol>
<li>由大量网络和连接这些网络的路由器组成</li>
<li>主要为<strong>边缘部分提供服务</strong>的</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118165236589.png" alt="image-20231118165236589"></p>
<h2 id="三种交换方式"><a href="#三种交换方式" class="headerlink" title="三种交换方式"></a>三种交换方式</h2><p><mark>从通信的角度来看，<strong>交换</strong> (switching)就是按照某种方式动态的分配传输线路的资源。</mark></p>
<h3 id="电路交换"><a href="#电路交换" class="headerlink" title="电路交换"></a>电路交换</h3><p>直接用电路进行连接传输资源</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118165516252.png" alt="image-20231118165516252"></p>
<p>电路交换通常需要以下的三个步骤。</p>
<ol>
<li>建立连接 (分配通信资源)</li>
<li>通话 (一直占用资源)</li>
<li>释放连接 (归还通信资源)</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118165544003.png" alt="image-20231118165544003"></p>
<h3 id="分组交换⭐⭐⭐"><a href="#分组交换⭐⭐⭐" class="headerlink" title="分组交换⭐⭐⭐"></a>分组交换⭐⭐⭐</h3><p><mark>一段信息通常会被分成多条信息。每条都是一段报文。</mark></p>
<p>在发送前会在每个分组前加上头信息。</p>
<p>分组交换通常会需要以下三个部分。</p>
<ol>
<li>发送方: 构造分组、发送分组</li>
<li>路由器: 缓存分组、转发分组</li>
<li>接收方: 接受分组、还原报文</li>
</ol>
<h3 id="报文交换"><a href="#报文交换" class="headerlink" title="报文交换"></a>报文交换</h3><p>报文交换与分组交换类似，不过由于<mark>其报文的大小未做限制</mark>，因此对路由器等设备的空间要求较高，所以使用的较少。</p>
<h3 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118165825500.png" alt="image-20231118165825500"></p>
<h2 id="八个性能指标"><a href="#八个性能指标" class="headerlink" title="八个性能指标"></a>八个性能指标</h2><h3 id="速率"><a href="#速率" class="headerlink" title="速率"></a>速率</h3><ul>
<li>在数字信道上传输比特的速率</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118170225088.png" alt="image-20231118170225088"></p>
<h3 id="带宽"><a href="#带宽" class="headerlink" title="带宽"></a>带宽</h3><ul>
<li><p>用来表示网络的通信线路所能传输数据的<strong>能力</strong>，通常为<mark>「最高数据率」</mark>。</p>
</li>
<li><p>单位 <code>b/s</code></p>
</li>
</ul>
<h3 id="吞吐量"><a href="#吞吐量" class="headerlink" title="吞吐量"></a>吞吐量</h3><ul>
<li><p>在单位时间内通过某个网络(或信道、接口)的<strong>数据量</strong></p>
</li>
<li><p>吞吐量受到<strong>网络的带宽或额定速率</strong>的限制</p>
</li>
</ul>
<h3 id="时延"><a href="#时延" class="headerlink" title="时延"></a>时延</h3><ul>
<li>主要由三部分时延<ul>
<li>发送时延 : 是由源主机发送到传输线路的时间</li>
<li>传播时延 : 信号在传输线线路上传输的时间</li>
<li>处理时延 : 信号在路由器上处理的时间</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118170422957.png" alt="image-20231118170422957"></p>
<p>计算方式如下：</p>
<table>
<thead>
<tr>
<th>时延类别</th>
<th>计算方式</th>
</tr>
</thead>
<tbody><tr>
<td>发送时延</td>
<td>分组长度发送速率分组长度(b)&#x2F;发送速率(b&#x2F;s)</td>
</tr>
<tr>
<td>传播时延</td>
<td>信道长度电磁波传播速率信道长度(m)&#x2F;电磁波传播速率(m&#x2F;s)</td>
</tr>
<tr>
<td>处理时延</td>
<td>不方便计算</td>
</tr>
</tbody></table>
<h3 id="时延带宽积"><a href="#时延带宽积" class="headerlink" title="时延带宽积"></a>时延带宽积</h3><p>时延带宽积传播时延带宽时延带宽积&#x3D;传播时延×带宽</p>
<ul>
<li>在发送端连续发送数据的情况下，在第一个比特到达终点的时候，发送端到终点中的 <code>bit</code> 数就是时延带宽积</li>
<li>链路的时延带宽积又称 <strong>以比特为单位的链路长度</strong></li>
<li>起点到终点的链路中所能容纳的最大数据量。</li>
</ul>
<h3 id="往返时间"><a href="#往返时间" class="headerlink" title="往返时间"></a>往返时间</h3><p>往返时间 <strong>RTT</strong>(<strong>R</strong>ound-<strong>T</strong>rip <strong>T</strong>ime) 是指从出发点发出分组信号，直到出发点收到终点的确认收到为止。</p>
<h3 id="利用率"><a href="#利用率" class="headerlink" title="利用率"></a>利用率</h3><ol>
<li><ol>
<li>信道利用率 : 用来表示信道有百分之多少的时间是被利用的</li>
<li>网络利用率 : 全网络的信道利用绿的加权平均值</li>
</ol>
</li>
</ol>
<ul>
<li>根据排队论，信道的利用率增大时，信道引起的时延也会增大。因此信道的<strong>利用率并非越大越好</strong></li>
<li>用 D0 表示网络空闲时的时延，D 表示当前网络的时延，U 表示利用率。 D&#x3D;D0&#x2F;(1−U) 有如下所示的关系</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.610n552gl640.webp" alt="image"></p>
<ul>
<li><ul>
<li>当网络的利用率达到50%时，时延就要加倍;</li>
<li>当网络的利用率超过50%时，时延急剧增大;</li>
<li>当网络的利用率接近100%时，时延就趋于无穷大;</li>
<li>因此，一些拥有较大主干网的ISP通常会控制它们的信道利用率不超过50%。</li>
</ul>
</li>
</ul>
<h3 id="丢包率"><a href="#丢包率" class="headerlink" title="丢包率"></a>丢包率</h3><ul>
<li><p>丢包率是指，丢失分组的数量与总分组数量的比率</p>
</li>
<li><p>丢包主要有以下两种情况</p>
</li>
</ul>
<ol>
<li>传输过程中出现误码，被结点丢弃</li>
<li>网络拥塞时被丢弃</li>
</ol>
<h2 id="计算机网络体系结构"><a href="#计算机网络体系结构" class="headerlink" title="计算机网络体系结构"></a>计算机网络体系结构</h2><h3 id="每一层解决的问题"><a href="#每一层解决的问题" class="headerlink" title="每一层解决的问题"></a>每一层解决的问题</h3><ol>
<li>物理层<ul>
<li>实现比特 0\1 的传输</li>
<li>采用怎样的传输媒体(介质)</li>
<li>采用怎样的物理接口</li>
<li>使用怎样的信号表示比特0和1</li>
</ul>
</li>
<li>数据链路层<ul>
<li>标识网络中各个主机</li>
<li>从信号中区分出地址和数据信息</li>
<li>实现<strong>一个网络</strong>之间的<strong>相互通信</strong></li>
</ul>
</li>
<li>网络层<ul>
<li>标识各个网络以及各个网络中的各主机</li>
<li>路由器如何转发分组，路由器如何进行路由选择</li>
</ul>
</li>
<li>运输层<ul>
<li>解决进程之间基于网络的通信功能</li>
<li>传输出现错误的时候，如何处理</li>
</ul>
</li>
<li>应用层<ul>
<li>通过应用进程的交互来完成特定的网络应用</li>
</ul>
</li>
</ol>
<h3 id="应用进程间基于网络的通信的流程"><a href="#应用进程间基于网络的通信的流程" class="headerlink" title="应用进程间基于网络的通信的流程"></a>应用进程间基于网络的通信的流程</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118170914318.png" alt="image-20231118170914318"></p>
<h3 id="计算机网络中的相关术语"><a href="#计算机网络中的相关术语" class="headerlink" title="计算机网络中的相关术语"></a>计算机网络中的相关术语</h3><ol>
<li><p>实体</p>
<ul>
<li>实体是指任何可发送或接受信息的 <strong>硬件或软件进程</strong></li>
<li>对等实体，是指收发双方中 <strong>相同层次中的实体</strong></li>
</ul>
</li>
<li><p>协议</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.qdst3f2qk40.webp" alt="image"></p>
<ul>
<li>协议是指两个对等实体进行逻辑通信的规则的集合</li>
<li>逻辑通信实际中并不存在，只是假设的一种通信</li>
<li>协议的三要素<ul>
<li>语法 定义交换信息的格式</li>
<li>语义 定义双方需要完成的的操作</li>
<li>同步 定义收发双方的时序关系</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.2wbmp47a8u20.webp" alt="image"></p>
<ol start="3">
<li>服务</li>
</ol>
<ul>
<li>在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务</li>
<li>如果要实现本层的协议，必须要下一层所提供的服务</li>
<li>协议是<strong>水平</strong>的，而服务是<strong>垂直</strong>的</li>
<li>实体看得见下层提供的服务，但并不知道实现该服务的具体协议。</li>
</ul>
<ol start="4">
<li><p>Other</p>
</li>
<li><p>服务访问点 在同一系统中<strong>相邻两层的实体交换信息的逻辑接口</strong>，用于区分不同服务的类型。</p>
</li>
<li><p>服务原语 上层使用下层所提供的服务必须通过与下层<strong>交换一些命令</strong> ，这些命令成为服务原语。</p>
</li>
<li><p>协议数据单元PDU <strong>对等层次之间传送的数据包</strong> ，成为该层的协议数据单元</p>
</li>
<li><p>服务数据单元SDU <strong>同意系统内，层与层之间交换的数据包</strong> 成为服务数据单元。</p>
</li>
<li><p>多个 SDU 可以合并为一个 PDU ；一个 SDU 也可以划分为几个 PDU</p>
</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.6ukjo5tcdsc0.webp" alt="image"></p>
<h1 id="物理层✏️"><a href="#物理层✏️" class="headerlink" title="物理层✏️"></a>物理层✏️</h1><h2 id="物理层的基本概念"><a href="#物理层的基本概念" class="headerlink" title="物理层的基本概念"></a>物理层的基本概念</h2><p><strong>物理层协议的主要任务：</strong></p>
<ol>
<li>机械特性</li>
</ol>
<p>指明接口所用接线器的 <strong>形状</strong> 和 <strong>尺寸</strong> 、 <strong>引脚数目</strong> 和 <strong>排列</strong> 、 <strong>固定和锁定</strong> 装置。</p>
<ol start="2">
<li>电气特性</li>
</ol>
<p>指明在接口电缆的各条线上出现的 <strong>电压的范围</strong> 。</p>
<ol start="3">
<li>功能特性</li>
</ol>
<p>指明某条显示行出现某一电平的 <strong>电压表示何种意义</strong>。</p>
<ol start="4">
<li>过程特性</li>
</ol>
<p>指明对于不同功能的各种可能 <strong>事件的出现顺序</strong>。</p>
<p><mark><strong>物理层的主要作用：</strong></mark></p>
<ol>
<li>物理层考虑的是<mark>怎样才能连接各种传输媒体上传输数据比特流</mark></li>
<li>物理层为数据链路层屏蔽了各种传输媒体的差异，是数据链路层只需要考虑如何完成本层的协议，不必考虑网络具体传输的媒体是什么</li>
</ol>
<h2 id="物理层下面的传输媒体"><a href="#物理层下面的传输媒体" class="headerlink" title="物理层下面的传输媒体"></a>物理层下面的传输媒体</h2><h3 id="导引型传输媒体"><a href="#导引型传输媒体" class="headerlink" title="导引型传输媒体"></a>导引型传输媒体</h3><ol>
<li>双绞线</li>
<li>同轴电缆</li>
<li>光纤</li>
<li>电力线</li>
</ol>
<h3 id="非引导型传输媒体"><a href="#非引导型传输媒体" class="headerlink" title="非引导型传输媒体"></a>非引导型传输媒体</h3><ol>
<li>无线电波</li>
<li>微波</li>
<li>红外线</li>
<li>可见光</li>
</ol>
<h2 id="传输方式"><a href="#传输方式" class="headerlink" title="传输方式"></a>传输方式</h2><h3 id="串行与并行"><a href="#串行与并行" class="headerlink" title="串行与并行"></a>串行与并行</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118195914716.png" alt="image-20231118195914716"></p>
<h3 id="同步与异步"><a href="#同步与异步" class="headerlink" title="同步与异步"></a>同步与异步</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118195949977.png" alt="image-20231118195949977"></p>
<ul>
<li>同步传输时，收发双方同步的方法<ul>
<li>外同步：在收发双方之间添加一条单独的时钟信号线</li>
<li>内同步：发送端将始终同步信号变慢到发送数据中一起传输</li>
</ul>
</li>
<li>异步发送时，每个字节单独发送，且起始段与结束段有单独的标记。</li>
</ul>
<h3 id="单向通信-双向交替通信-双方同时通信-单工-半双工-全双工"><a href="#单向通信-双向交替通信-双方同时通信-单工-半双工-全双工" class="headerlink" title="单向通信&#x2F;双向交替通信&#x2F;双方同时通信(单工&#x2F;半双工&#x2F;全双工)"></a>单向通信&#x2F;双向交替通信&#x2F;双方同时通信(单工&#x2F;半双工&#x2F;全双工)</h3><p>在许多情况下，我们要使用“<strong>信道（channel）</strong>”这一名词。信道和电路并不等同。信道一般都是用来表示向某一个方向传送信息的媒体。因此，一条通信电路往往包含一条发送信道和一条接收信道。</p>
<p>从通信的双方信息交互的方式来看，可以有以下三种基本方式：</p>
<p><strong>单向通信</strong>：</p>
<p>又称为<strong>单工通信</strong>，即只能有一个方向的通信而没有反方向的交互。无线电广播或有线电以及电视广播就属于这种类型</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201008141345239.png" alt="image-20201008141345239"></p>
<p><strong>双向交替通信</strong>：</p>
<p>又称为<strong>半双工通信</strong>，即通信的双方可以发送信息，但不能双方同时发送（当然也就不能同时接收）。这种通信方式使一方发送另一方接收，过一段时间后可以再反过来</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201008141921924.png" alt="image-20201008141921924"></p>
<p><strong>双向同时通信</strong>：</p>
<p>又称为<strong>全双工通信</strong>，即通信的双发可以同时发送和接收信息。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201008142037846.png" alt="image-20201008142037846"></p>
<blockquote>
<p><strong>单向通信</strong>只需要一条信道，而<strong>双向交替通信</strong>或<strong>双向同时通信</strong>则需要两条信道（每个方向各一条）</p>
<p><strong>双向同时通信</strong>的传输效率最高</p>
</blockquote>
<h2 id="编码与调制✏️"><a href="#编码与调制✏️" class="headerlink" title="编码与调制✏️"></a>编码与调制✏️</h2><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118201632001.png" alt="image-20231118201632001"></p>
<p><strong>常用术语：</strong></p>
<ul>
<li><p><strong>数据 (data)</strong> —— 运送消息的实体。</p>
</li>
<li><p><strong>信号 (signal)</strong> —— 数据的电气的或电磁的表现。 </p>
</li>
<li><p><strong>模拟信号 (analogous signal)</strong> —— 代表消息的参数的取值是连续的。 </p>
</li>
<li><p><strong>数字信号 (digital signal)</strong> —— 代表消息的参数的取值是离散的。 </p>
</li>
<li><p><strong>码元 (code)</strong> —— 在使用时间域（或简称为时域）的波形表示数字信号时，代表不同离散数值的基本波形。</p>
</li>
<li><p><strong>基带信号</strong>（即基本频带信号）—— 来自信源的信号。像计算机输出的代表各种文字或图像文件的数据信号都属于基带信号。</p>
</li>
<li><p>基带信号往往包含有较多的低频成分，甚至有直流成分，而许多信道并不能传输这种低频分量或直流分量。因此必须对基带信号进行<strong>调制</strong>  (modulation)。</p>
</li>
</ul>
<p>🌈补充：</p>
<ul>
<li><strong>编码：</strong> 通过编码，可以<mark>将原始的基带信号表示为更紧凑、高效的形式</mark>，以便在网络中传输。编码也可以用于纠错和安全性，确保数据的完整性和保密性。</li>
<li><strong>调制：</strong> 调制<mark>允许基带信号在传输介质中传播</mark>。不同的调制方式适用于不同的传输介质和应用场景。调制可以使信号适应传输媒体的特性，同时提高信号的传输距离和抗干扰能力。</li>
<li><mark>编码是将数字信号或者模拟信号转换为数字信号去在数字信道中传输，而调制是将数字信号或者模拟信号转换为模拟信号去在模拟信道中传输。</mark></li>
</ul>
<h3 id="常见编码方式"><a href="#常见编码方式" class="headerlink" title="常见编码方式"></a>常见编码方式</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.z6k4dfxm0io.webp" alt="image"></p>
<ul>
<li>不归零编码中存在时钟不一致的问题</li>
<li>归零编码中存在浪费数据带宽的问题</li>
<li>曼切斯特编码有自动同步的能力</li>
<li>差分曼切斯特编码相交上面的编码变化少，更适合网络传输</li>
</ul>
<h3 id="常见调制方式✏️"><a href="#常见调制方式✏️" class="headerlink" title="常见调制方式✏️"></a>常见调制方式✏️</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231118202306963.png" alt="image-20231118202306963"></p>
<p>不过有一个缺点，使用基本调制方式，一个码元只能包含一个比特信息。通常来说可以有混合调制的方式，也就是多个维度一起调制的方式。</p>
<p>下面就是一个典型的例子</p>
<p>正交振幅调制 QAM</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4tc9rfwo3l40.webp" alt="image"></p>
<blockquote>
<p>听不太懂，待补充。。。。。</p>
</blockquote>
<h2 id="信道的极限容量✏️"><a href="#信道的极限容量✏️" class="headerlink" title="信道的极限容量✏️"></a>信道的极限容量✏️</h2><h3 id="造成信号失真的因素"><a href="#造成信号失真的因素" class="headerlink" title="造成信号失真的因素"></a>造成信号失真的因素</h3><ul>
<li>任何实际的信道都不是理想的，在传输信号时会产生各种失真以及带来多种干扰。 </li>
<li>码元传输的速率越高，或信号传输的距离越远，或传输媒体质量越差，在信道的输出端的波形的失真就越严重。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201010204336400.png" alt="image-20201010204336400"></p>
<p>失真的原因：</p>
<ul>
<li>码元传输的速率越高</li>
<li>信号传输的距离越远</li>
<li>噪声干扰越大</li>
<li>传输媒体质量越差</li>
</ul>
<h3 id="奈氏准则和香农公式"><a href="#奈氏准则和香农公式" class="headerlink" title="奈氏准则和香农公式"></a>奈氏准则和香农公式</h3><blockquote>
<p>待补充。。。。。。</p>
<p>奈氏准则</p>
<p>香农公式</p>
</blockquote>
<h3 id="奈氏准则和香农公式的意义"><a href="#奈氏准则和香农公式的意义" class="headerlink" title="奈氏准则和香农公式的意义"></a>奈氏准则和香农公式的意义</h3><ul>
<li>在信道带宽一定的情况下，根据奈氏准则和香农公式，要想提高信息的传输速率就必须<mark>采用多元制</mark> (更好的调制方法)和<mark>努力提高信道中的信噪比</mark>。</li>
<li>自从香农公式发表后，各种新的信号处理和调制方法就不断出现，其目的都是为了尽可能地<mark>接近香农公式给出的传输速率极限</mark></li>
</ul>
<h2 id="补充：信道复用技术"><a href="#补充：信道复用技术" class="headerlink" title="补充：信道复用技术"></a>补充：信道复用技术</h2><h3 id="频分复用、时分复用和统计时分复用"><a href="#频分复用、时分复用和统计时分复用" class="headerlink" title="频分复用、时分复用和统计时分复用"></a>频分复用、时分复用和统计时分复用</h3><ol>
<li>频分复用</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4hed19sa9cg.webp" alt="image"></p>
<p>每个用户划分出一个频段来就是频分复用。 存在大量的带宽闲置的问题</p>
<ol start="2">
<li>时分复用(TDM)</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.58cg0bzk2uw0.webp" alt="image"></p>
<ul>
<li>所有用户被划分在了不同的时间帧中，每个用户周期出现。</li>
<li>存在大量的限制</li>
</ul>
<ol start="3">
<li>统计时分复用</li>
</ol>
<p>动态分配时间间隙，提高利用率</p>
<h3 id="波分复用-WDM"><a href="#波分复用-WDM" class="headerlink" title="波分复用(WDM)"></a>波分复用(WDM)</h3><p>波分复用就是光频拆分出来，通过一个光纤来传输多个信号。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4jwgzkrt4nq0.webp" alt="image"></p>
<h3 id="码分复用-CDMA"><a href="#码分复用-CDMA" class="headerlink" title="码分复用(CDMA)"></a>码分复用(CDMA)</h3><p>所有的用户在同一时刻使用同一频带进行通信。</p>
<ul>
<li>常用的名词是<strong>码分多址</strong> CDMA (Code Division Multiple Access)。</li>
<li>各用户使用经过特殊挑选的不同码型，因此彼此不会造成干扰。</li>
<li>这种系统发送的信号有很强的抗干扰能力，其频谱类似于白噪声，不易被敌人发现。</li>
</ul>
<p>🔴🟢🟡<strong>总结：</strong></p>
<ol>
<li><strong>频分复用（Frequency Division Multiplexing，FDM）：</strong><ul>
<li><strong>概念：</strong> 频分复用是一种多路复用技术，它通过将频谱划分成不同的频率带来允许多个信号同时传输。每个信号占据不同的频率带宽，从而可以同时在相同的物理媒介上传输。</li>
<li><strong>用途：</strong> 常见于广播电视、无线通信等领域，如无线电和电视广播。</li>
</ul>
</li>
<li><strong>时分复用（Time Division Multiplexing，TDM）：</strong><ul>
<li><strong>概念：</strong> 时分复用是一种多路复用技术，它通过将时间划分为不同的时隙来允许多个信号轮流传输。每个信号在不同的时间段传输，从而共享同一物理媒介。</li>
<li><strong>用途：</strong> 常见于电话网络、数字传输系统等，如 T1&#x2F;E1 数字传输线路。</li>
</ul>
</li>
<li><strong>统计时分复用（Statistical Time Division Multiplexing，STDM）：</strong><ul>
<li><strong>概念：</strong> 统计时分复用是一种时分复用的变体，其中时隙的分配是根据信道上实际需要传输的数据量而动态变化的。它允许灵活地分配时隙，以适应不同信道的变化需求。</li>
<li><strong>用途：</strong> 常见于数据网络，如以太网。</li>
</ul>
</li>
<li><strong>波分复用（Wavelength Division Multiplexing，WDM）：</strong><ul>
<li><strong>概念：</strong> 波分复用是一种光通信中的多路复用技术，它通过在光纤中传输多个不同波长的光信号来实现多路复用。每个波长可以独立传输数据，使得光纤的传输容量大幅提升。</li>
<li><strong>用途：</strong> 常见于光纤通信系统，如长距离传输、光网络等。</li>
</ul>
</li>
<li><strong>码分复用（Code Division Multiplexing，CDM）：</strong><ul>
<li><strong>概念：</strong> 码分复用是一种多路复用技术，它通过为每个用户分配独特的码片序列来实现多用户在相同频率范围内同时传输。每个用户的数据通过与其相关的码片进行扩频，然后在接收端使用相同的码片进行解扩频。</li>
<li><strong>用途：</strong> 常见于无线通信系统，如 CDMA（Code Division Multiple Access）系统。</li>
</ul>
</li>
</ol>
<h1 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h1><h2 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h2><p>要解决的问题：</p>
<ul>
<li>标识网络中各个主机</li>
<li>从信号中区分出地址和数据信息</li>
<li>实现<strong>一个网络</strong>之间的<strong>相互通信</strong></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231119155147938.png" alt="image-20231119155147938"></p>
<ul>
<li><code>链路(Link)</code>：指从一个结点到相邻结点的一段物理线路,而中间没有任何其他的交换结点。</li>
<li><code>数据链路(DataLink)</code>：指把实现通信协议的硬件和软件加到链路上,就构成了数据链路。</li>
<li><strong>数据链路层</strong>以<code>帧</code>为单位传输和处理数据。</li>
</ul>
<h2 id="三个重要问题"><a href="#三个重要问题" class="headerlink" title="三个重要问题"></a>三个重要问题</h2><p>数据链路层传送的协议数据单元是<strong>帧</strong></p>
<ol>
<li><strong>封装成帧</strong></li>
</ol>
<ul>
<li><strong>封装成帧</strong> (framing) 就是在一段数据的前后分别添加首部和尾部，然后就构成了一个帧。</li>
<li>首部和尾部的一个重要作用就是进行<strong>帧定界</strong>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011103650253.png" alt="image-20201011103650253"></p>
<ol start="2">
<li><strong>差错控制</strong></li>
</ol>
<p>在传输过程中可能会产生<strong>比特差错</strong>：1 可能会变成 0， 而 0 也可能变成 1。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011103917512.png" alt="image-20201011103917512"></p>
<ol start="3">
<li><strong>可靠传输</strong></li>
</ol>
<p>接收方主机收到有误码的帧后，是不会接受该帧的，会将它丢弃</p>
<p>如果数据链路层向其上层提供的是不可靠服务，那么丢弃就丢弃了，不会再有更多措施</p>
<p><strong>如果数据链路层向其上层提供的是可靠服务，那就还需要其他措施，来确保接收方主机还可以重新收到被丢弃的这个帧的正确副本</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011105314053.png" alt="image-20201011105314053"></p>
<blockquote>
<p>以上三个问题都是使用<strong>点对点信道的数据链路层</strong>来举例的</p>
</blockquote>
<p><strong>数据链路层使用的信道：</strong></p>
<p>数据链路层属于计算机网路的低层。<strong>数据链路层使用的信道主要有以下两种类型：</strong></p>
<ul>
<li>点对点信道</li>
<li>广播信道</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014004459744.png" alt="image-20201014004459744"></p>
<blockquote>
<p><strong>局域网属于数据链路层</strong></p>
<p>局域网虽然是个网络。但我们并不把局域网放在网络层中讨论。这是因为在网络层要讨论的是多个网络互连的问题，是讨论分组怎么从一个网络，通过路由器，转发到另一个网络。</p>
<p>而在同一个局域网中，分组怎么从一台主机传送到另一台主机，但并不经过路由器转发。从整个互联网来看，<strong>局域网仍属于数据链路层</strong>的范围</p>
</blockquote>
<p><strong>如果使用广播信道的数据链路层除了包含上面三个问题外，还有一些问题要解决</strong></p>
<p>如图所示，主机A，B，C，D，E通过一根总线进行互连，主机A要给主机C发送数据，代表帧的信号会通过总线传输到总线上的其他各主机，那么主机B，D，E如何知道所收到的帧不是发送给她们的，主机C如何知道发送的帧是发送给自己的（<mark>从信号中区分出地址和数据信息的问题</mark>）</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011105824466.png" alt="image-20201011105824466"></p>
<p>可以用编址（地址）的来解决</p>
<p>将帧的目的地址添加在帧中一起传输</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011110017415.png" alt="image-20201011110017415"></p>
<p>还有<mark>数据碰撞问题</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011110129994.png" alt="image-20201011110129994"></p>
<blockquote>
<p>随着技术的发展，交换技术的成熟，</p>
<p>在 有线（局域网）领域 使用<strong>点对点链路</strong>和<strong>链路层交换机</strong>的<strong>交换式局域网</strong>取代了<del>共享式局域网</del></p>
<p>在无线局域网中仍然使用的是共享信道技术</p>
</blockquote>
<h2 id="封装成帧"><a href="#封装成帧" class="headerlink" title="封装成帧"></a>封装成帧</h2><h3 id="基本概念-2"><a href="#基本概念-2" class="headerlink" title="基本概念"></a>基本概念</h3><p>封装成帧是指数据链路层给上层交付的协议数据单元<mark>添加帧头和帧尾使之成为帧</mark></p>
<ul>
<li><strong>帧头和帧尾中包含有重要的<mark>控制信息</mark>。</strong></li>
</ul>
<ul>
<li><strong>帧头和帧尾的作用之一就是<mark>帧定界</mark>。</strong></li>
</ul>
<p>问：接收方的数据链路层如何从物理层交付的比特流中提取出一个个的帧？</p>
<p>答：帧定界。</p>
<p>例如PPP帧中的帧头和帧尾都会有标志符。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011111334052.png" alt="image-20201011111334052"></p>
<p>但比不是每一种数据链路层协议的帧都包含有帧定界标志，例如下面例子</p>
<p>⭐⭐⭐<strong>MAC帧的格式：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011111729324.png" alt="image-20201011111729324"></p>
<blockquote>
<p>前导码</p>
<ul>
<li>前同步码：作用是使接收方的时钟同步</li>
<li>帧开始定界符：表明其后面紧跟着的就是MAC帧</li>
</ul>
</blockquote>
<p>另外以太网还规定了帧间间隔为96比特时间，因此，MAC帧不需要帧结束定界符</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011112450187.png" alt="image-20201011112450187"></p>
<h3 id="透明传输"><a href="#透明传输" class="headerlink" title="透明传输"></a>透明传输</h3><p>透明传输：指数据链路层对上层交付的传输数据<strong>没有任何限制</strong>,就好像数据链路层不存在一样。</p>
<ol>
<li>面向字节的物理链路使用字节填充实现</li>
</ol>
<blockquote>
<p>在每个标志字符和转义字符前都加上一个转义字符，让接收方认为其是数据而不是结束标志</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4zvllsddnng0.webp" alt="image"></p>
<ol start="2">
<li>面向比特的物理链路使用比特填充实现</li>
</ol>
<blockquote>
<p>例如在没连续5个1之后添加一个0来避免出现与帧头和帧尾冲突的情况</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.56uvouiuuaw0.webp" alt="image"></p>
<h3 id="帧的数据部分长度"><a href="#帧的数据部分长度" class="headerlink" title="帧的数据部分长度"></a>帧的数据部分长度</h3><p>为了提高<strong>帧的传输效率</strong>,应当使帧的<mark><strong>数据部分的长度</strong>尽可能大些</mark>。</p>
<p>考虑到差错控制等多种因素,每一种数据链路层协议都规定了帧的数据部分的长度上限,即**最大传送单元MTU (Maximum Transfer Unit)**。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.702czciz8940.webp" alt="image"></p>
<h2 id="差错检测"><a href="#差错检测" class="headerlink" title="差错检测"></a>差错检测</h2><h3 id="基本概念-3"><a href="#基本概念-3" class="headerlink" title="基本概念"></a>基本概念</h3><ul>
<li>实际的通信链路都不是理想的，比特在传输过程中可能会产生差错：1可能会变成0，而0也可能变成1。这称为<mark>比特差错</mark></li>
<li>在一段时间内，传输错误的比特占所传输比特总数的比率称为误码率BER(Bit Error Rate).</li>
<li>使用<mark>差错检测码</mark>来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的重要问题之一</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231119163254347.png" alt="image-20231119163254347"></p>
<blockquote>
<p>如图上的帧尾都有FCS来进行检测，帧校验序列 FCS 是添加在数据后面的<mark>冗余码</mark>来进行检测</p>
</blockquote>
<h3 id="两种校验方式"><a href="#两种校验方式" class="headerlink" title="两种校验方式"></a>两种校验方式</h3><h4 id="奇偶校验"><a href="#奇偶校验" class="headerlink" title="奇偶校验"></a>奇偶校验</h4><ul>
<li>在待发送的数据后面添加1位奇偶校验位，使整个数据(包括所添加的校验位在内)中<mark>“1”的个数</mark>为奇数(奇校验)或偶数(偶校验)</li>
<li>如果有<strong>奇数个位发生误码</strong>，则奇偶性发生变化，<strong>可以检查出误码</strong></li>
<li>如果有<strong>偶数个位发生误码</strong>，则奇偶性不发生变化，<strong>不能检查出误码(<mark>漏检</mark>)</strong>;</li>
</ul>
<blockquote>
<p>漏检的概率很大，所以不采用</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231119163759281.png" alt="image-20231119163759281"></p>
<h4 id="循环冗余校验CRC-Cyclic-Redundancy-Check-⭐⭐⭐"><a href="#循环冗余校验CRC-Cyclic-Redundancy-Check-⭐⭐⭐" class="headerlink" title="循环冗余校验CRC(Cyclic Redundancy Check)⭐⭐⭐"></a>循环冗余校验CRC(Cyclic Redundancy Check)⭐⭐⭐</h4><ul>
<li>收发双方约定好一个生成多项式G(x)；</li>
<li>发送方基于待发送的数据和生成多项式计算出差错检测码（冗余码），将其添加到待传输数据的后面一起传输；</li>
<li>接收方通过生成多项式来计算收到的数据是否产生了误码。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231119164219319.png" alt="image-20231119164219319"></p>
<p><strong>举例说明：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011234701845-170038338842625.png" alt="image-20201011234701845"></p>
<p><strong>例题：</strong></p>
<blockquote>
<p>发送方</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231119164816418.png" alt="image-20231119164816418"></p>
<hr>
<blockquote>
<p>接收方</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201011235325022-170038338842627.png" alt="image-20201011235325022"></p>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>检错码只能检测出帧在传输过程中出现了差错，但并不能定位错误，因此<mark>无法纠正错误</mark>。</li>
<li>要想纠正传输中的差错，可以使用冗余信息更多的<mark>纠错码进行前向纠错</mark>。但纠错码的开销比较大，在计算机网络中<mark>较少使用</mark>。</li>
<li>循环冗余校验<strong>CRC</strong>有很好的检错能力(<mark>漏检率非常低</mark>)，虽然计算比较复杂，但非常易于用硬件实现，因此被<mark>广泛应用</mark>于数据链路层。</li>
<li>在计算机网络中通常采用我们后续课程中将要讨论的<mark>检错重传方式来纠正传输中的差错或者仅仅是丢弃检测到差错的帧</mark>，这取决于数据链路层向其上层提供的是可靠传输服务还是不可靠传输服务。</li>
</ul>
<h2 id="可靠传输"><a href="#可靠传输" class="headerlink" title="可靠传输"></a>可靠传输</h2><h3 id="基本概念-4"><a href="#基本概念-4" class="headerlink" title="基本概念"></a>基本概念</h3><ul>
<li>使用<mark>差错检测技术</mark>(例如循环冗余校验CRC)，可以检测<strong>是否产生了误码</strong>(比特错误)。</li>
</ul>
<p><strong>数据链路层向上层提供的服务类型：</strong></p>
<ol>
<li><p>不可靠传输服务：仅仅<mark>丢弃</mark>有误码的帧，其他什么也不做；</p>
</li>
<li><p>可靠传输服务：<mark>想办法实现发送端发送什么，接收端就接收什么</mark>。</p>
</li>
</ol>
<hr>
<ul>
<li><p>一般情况下，<code>有线链路的误码率比较低</code>，为了减小开销，并<code>不要求</code>数据链路层向上提供可靠传输服务。即使出现了误码，可靠传输的问题由其上层处理。</p>
</li>
<li><p><code>无线链路</code>易受干扰，误码率比较高，因此<code>要求</code>数据链路层必须向上层提供可靠传输服务。</p>
</li>
</ul>
<hr>
<ul>
<li><mark>比特差错</mark>只是传输差错中的一种</li>
<li>从整个计算机网络体系结构来看，传输差错还包括<mark>分组丢失、分组失序以及分组重复</mark>。</li>
</ul>
<hr>
<ul>
<li>分组丢失、分组失序以及分组重复这些传输差错，<code>一般不会出现在数据链路层</code>，而会出现在其上层。</li>
<li>可靠传输服务并不仅局限于数据链路层，其他各层均可选择实现<code>可靠传输</code>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.56i9yun4fa40.webp" alt="image"></p>
<ul>
<li><strong>可靠传输的实现比较复杂，开销也比较大</strong>，<mark>是否使用可靠传输取决于应用需求</mark>。</li>
</ul>
<h3 id="三种可靠协议"><a href="#三种可靠协议" class="headerlink" title="三种可靠协议"></a>三种可靠协议</h3><p><strong>注意：</strong></p>
<p>这三种可靠传输实现机制的基本原理并不仅限于数据链路层，可以<mark>应用到计算机网络体系结构的各层协议</mark></p>
<h4 id="停止-等待协议SW"><a href="#停止-等待协议SW" class="headerlink" title="停止-等待协议SW"></a>停止-等待协议SW</h4><h5 id="停止-等待协议可能遇到的四个问题"><a href="#停止-等待协议可能遇到的四个问题" class="headerlink" title="停止-等待协议可能遇到的四个问题"></a>停止-等待协议可能遇到的<mark><strong>四个问题</strong></mark></h5><ol>
<li><strong>确认与否认</strong></li>
</ol>
<img src="../assets/计算机网络/image-20201012162009780.png" alt="image-20201012162009780" style="zoom:67%;" />

<ol start="2">
<li><strong>超时重传</strong></li>
</ol>
<img src="../assets/计算机网络/image-20201012162112151.png" alt="image-20201012162112151" style="zoom:67%;" />

<ol start="3">
<li><strong>确认丢失</strong></li>
</ol>
<img src="../assets/计算机网络/image-20201012162318298.png" alt="image-20201012162318298" style="zoom:67%;" />

<img src="../assets/计算机网络/image-20201012162348428.png" alt="image-20201012162348428" style="zoom:67%;" />

<blockquote>
<p>问：既然数据分组需要编号，确认分组是否需要编号？</p>
<p>答：要，如下图所示：</p>
</blockquote>
<ol start="4">
<li><strong>确认迟到</strong></li>
</ol>
<img src="../assets/计算机网络/image-20201012162815885.png" alt="image-20201012162815885" style="zoom:67%;" />

<blockquote>
<p>注意，图中最下面那个数据分组与之前序号为0的那个数据分组不是同一个数据分组</p>
</blockquote>
<p>🌈<strong>注意事项：</strong></p>
<ul>
<li>接收端检测到教据分组有误码时，将其丢弃并等待发送方的超时重传。但对于误码率较高的点对点链路，为使发送方<mark>尽早重传</mark>，也可<mark>给发送方发送NAK分组</mark></li>
<li>为了让接收方能够判断所收到的数据分组是否是重复的，需要给<mark>数据分组编号</mark>，由于停止-等待协议的停等特性，<mark>只需1个比特编号</mark>就够了，即编号0和1。</li>
<li>为了让发送方能够判断所收到的ACK分组是否是重复的，需要给ACK分组编号，所用比特数量与数据分组编号所用比特数量一样，<mark>数据链路层一般不会出现ACK分组迟到的情况，因此在数据链路层实现停止-等待协议可以不用给ACK分组编号。</mark></li>
<li>超时计时器设置的重传时间应仔细选择。一般可将重传时间选为<mark>略大于“从发送方到接收方的平均往返时间”</mark><ul>
<li>在数据链路层点对点的往返时间比较确定，重传时间比较好设定。</li>
<li>然而在运输层，由于端到端往返时间非常不确定，设置合适的重传时间有时并不容易</li>
</ul>
</li>
</ul>
<hr>
<h5 id="停止-等待协议的信道利用率"><a href="#停止-等待协议的信道利用率" class="headerlink" title="停止-等待协议的信道利用率"></a>停止-等待协议的<mark><strong>信道利用率</strong></mark></h5><p>假设收发双方之间是一条直通的信道</p>
<ul>
<li><strong>TD</strong>：是发送方发送数据分组所耗费的发送时延</li>
<li><strong>RTT</strong>：是收发双方之间的往返时间</li>
<li><strong>TA</strong>：是接收方发送确认分组所耗费的发送时延</li>
</ul>
<p>TA一般都远小于TD，可以忽略，当RTT远大于TD时，信道利用率会非常低</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012164924635.png" alt="image-20201012164924635"></p>
<ul>
<li><strong>当往返时延RTT远大于数据帧发送时延T<del>D</del>时(例如使用卫星链路)，信道利用率非常低。</strong></li>
<li>若出现重传，则对于传送有用的数据信息来说，信道利用率还要降低。</li>
<li>为了克服停止-等待协议信道利用率很低的缺点，就产生了另外两种协议，即后退N帧协议GBN和选择重传协议SR。</li>
</ul>
<blockquote>
<p>像停止-等待协议这样通过确认和重传机制实现的可靠传输协议，常称为自动请求重传协议ARQ(<strong>A</strong>utomatic <strong>R</strong>epeat re<strong>Q</strong>uest)，意思是重传的请求是自动进行，因为不需要接收方显式地请求，发送方重传某个发送的分组</p>
</blockquote>
<h4 id="回退N帧协议GBN"><a href="#回退N帧协议GBN" class="headerlink" title="回退N帧协议GBN"></a>回退N帧协议GBN</h4><h5 id="为什么用回退N帧协议"><a href="#为什么用回退N帧协议" class="headerlink" title="为什么用回退N帧协议"></a>为什么用回退N帧协议</h5><p>在相同的时间内，使用停止-等待协议的发送方只能发送一个数据分组，而采用流水线传输的发送方，可以发送多个数据分组</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012190027828.png" alt="image-20201012190027828"></p>
<p>回退N帧协议在流水线传输的基础上，<mark>利用发送窗口来限制发送方可连续发送数据分组的个数</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012190632086.png" alt="image-20201012190632086"></p>
<h5 id="无差错情况流程"><a href="#无差错情况流程" class="headerlink" title="无差错情况流程"></a>无差错情况<mark>流程</mark></h5><blockquote>
<p>一句话总结流程：类似于<mark>滑动窗口</mark>，发送方只能在发送窗口内发送分组，接收方的窗口大小只能为1，接受到一个完整的无受损的分组，接收方的窗口就可以后移以匹配下一个序号上的分组，同时接收方还要发送确认分组，发送方收到确认分组也要将窗口右移，比如返回AK<del>3</del>就代表序号3（包括3）的位置的分组都已经成功接收了，此时可以右移到序号3后的位置。</p>
</blockquote>
<p>发送方将序号落在发送窗口内的0~4号数据分组，依次连续发送出去</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012191936466.png" alt="image-20201012191936466"></p>
<p>他们经过互联网传输正确到达接收方，就是没有乱序和误码，接收方按序接收它们，每接收一个，接收窗口就向前滑动一个位置，并给发送方发送针对所接收分组的确认分组，在通过互联网的传输正确到达了发送方</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012192932035.png" alt="image-20201012192932035"></p>
<p>发送方每接收一个、发送窗口就向前滑动一个位置，这样就有新的序号落入发送窗口，发送方可以将收到确认的数据分组从缓存中删除了，而接收方可以择机将已接收的数据分组交付上层处理</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012193212419.png" alt="image-20201012193212419"></p>
<h5 id="累积确认"><a href="#累积确认" class="headerlink" title="累积确认"></a>累积确认</h5><ol>
<li>概念：</li>
</ol>
<p>接收方不一定要对收到的数据分组逐个发送确认，而是可以在收到几个数据分组后 （由具体实现决定）对按序到达的最后一个数据分组发送确认。ACK<del>n</del>表示序号为n及以前的所有数据分组都已正确接收。</p>
<ol start="2">
<li>优缺点</li>
</ol>
<ul>
<li><p>优点:</p>
<ul>
<li>即使确认分组丢失，发送方也可能不必重传</li>
<li>减小接收方的开销</li>
<li>减小对网络资源的占用</li>
</ul>
</li>
<li><p>缺点：</p>
<ul>
<li>不能向发送方及时反映出接收方已经正确接收的数据分组信息</li>
</ul>
</li>
</ul>
<h5 id="有差错情况"><a href="#有差错情况" class="headerlink" title="有差错情况"></a>有差错情况</h5><ol>
<li><strong>传输过程中出现误码</strong></li>
</ol>
<p>在传输数据分组时，5号数据分组出现误码，接收方通过数据分组中的检错码发现了错误</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012195440780.png" alt="image-20201012195440780"></p>
<p>于是<mark>丢弃该分组</mark>，而后续到达的这剩下四个分组与接收窗口的序号不匹配</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012195629368.png" alt="image-20201012195629368"></p>
<p>接收方同样也不能接收它们，将它们<mark>丢弃</mark>，并对之前按序接收的最后一个数据分组进行确认，发送ACK4，<mark><strong>每丢弃一个数据分组，就发送一个ACK4</strong></mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012195836902.png" alt="image-20201012195836902"></p>
<p><mark>当收到重复的ACK4时，就知道之前所发送的数据分组出现了差错</mark>，于是可以不等超时计时器超时就立刻开始重传，具体收到几个重复确认就立刻重传，根据具体实现决定</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012200120166.png" alt="image-20201012200120166"></p>
<p> 如果收到这4个重复的确认并不会触发发送立刻重传，一段时间后。超时计时器超时，也会将发送窗口内以发送过的这些数据分组全部重传</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012200454557.png" alt="image-20201012200454557"></p>
<p>例题：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231121201715658.png" alt="image-20231121201715658"></p>
<ol start="2">
<li><strong>若W<del>T</del>或者W<del>R</del>超过取值范围，会出现什么情况？（包含回退N帧和选择重传）</strong></li>
</ol>
<p><mark><strong>接收方无法分辨新、旧数据分组</strong></mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231121204447408.png" alt="image-20231121204447408"></p>
<p>这里<mark><strong>拿后面的选择重传的例子举例说明</strong></mark>：</p>
<p>⭐⭐⭐<strong>回答：</strong></p>
<blockquote>
<p>当发送方发送了0到4序号的分组给接收方，接收方都正确地接收了，并把滑动窗口右移了，但是在确认分组返回给发送方的时候序号为0的分组丢失了，那么此时会记录1到4是正确接收了的，那么等重传计时器超时了，就会重新发送0位置的分组，但是接收方处已经后移，因为W<del>R</del>的选择超过了取值范围，所以在新的接收窗口中又找到了序号0的位置，那么此时接收方就分不清前面的序号0和此时的序号0，即接收方无法分辨新、旧数据分组</p>
</blockquote>
<p>🔴🟡🟢<strong>总结：</strong></p>
<ul>
<li>回退N顿协议在<mark>流水线传输的基础</mark>上<mark>利用发送窗口来限制发送方连续发送数据分组的数量</mark>，是一种连续ARQ协议</li>
<li>在协议的工作过程中发送窗口和接收窗口不断向前滑动，因此这类协议又称为<mark><strong>滑动窗口协议</strong></mark></li>
<li>由于回退N顿协议的特性，当通信线路质量不好时，其信道利用率并不比停止-等待协议高</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231121201901475.png" alt="image-20231121201901475"></p>
<h4 id="选择重传协议SR"><a href="#选择重传协议SR" class="headerlink" title="选择重传协议SR"></a>选择重传协议SR</h4><p>🔴🟡🟢<strong>一句话总结：</strong></p>
<blockquote>
<p>具体流程与回退N帧协议类似，只是选择重传协议中，在接收时不需要按序接收了，<mark>只要落在窗口内就能接收</mark>，<mark>依次逐个</mark>返回相应序号的确认分组，且发送方只重传没有被正确接收的分组。</p>
</blockquote>
<hr>
<ul>
<li><strong>回退N帧协议</strong>的接收窗口尺寸<strong>W<del>r</del>只能等于1</strong>，<strong>因此接收方只能按序接收正确到达的数据分组</strong>。</li>
<li>一个数据分组的误码就会导致其后续多个数据分组不能被接收方按序接收而丢弃 (尽管它们无乱序和误码)。这必然会造成发送方对这些数据分组的超时重传，显然这是对通信<mark>资源的极大浪费</mark>。</li>
<li>为了进一步提高性能，可设法只重传出现误码的数据分组。因此，接收窗口的尺寸<mark>W<del>R</del>不应再等于1 (而应大于1)</mark>，以便<mark>接收方先收下失序到达但无误码并且序号落在接收窗口内的那些数据分组</mark>，等到所缺分组收齐后再一并送交上层。这就是<mark>选择重传协议</mark>。</li>
<li>注意:<ul>
<li><strong>选择重传协议</strong>为了使发送方仅重传出现差错的分组，接收方<mark>不能再采用累积确认</mark>，而需要对每个正确接收到的数据分组进行<mark>逐一确认!</mark></li>
</ul>
</li>
</ul>
<p>例题：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231121205516313.png" alt="image-20231121205516313"></p>
<h2 id="点对点协议PPP"><a href="#点对点协议PPP" class="headerlink" title="点对点协议PPP"></a>点对点协议PPP</h2><ul>
<li>点对点协议PPP（Point-to-Point Protocol）是目前<mark>使用最广泛的点对点数据链路层协议</mark></li>
<li>PPP协议是因特网工程任务组IEIF在1992年制定的。经过1993年和1994年的修订，现在的PPP协议已成为<mark>因特网的正式标准</mark>[RFC1661，RFC1662]</li>
<li>数据链路层使用的一种协议，它的特点是：简单；<mark>只检测差错，而不是纠正差错</mark>；不使用序号，也不进行流量控制；可同时支持多种网络层协议</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012210844629.png" alt="image-20201012210844629"></p>
<ul>
<li>PPPoE 是为宽带上网的主机使用的链路层协议</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012211423528.png" alt="image-20201012211423528"></p>
<blockquote>
<p>承上启下的作用</p>
</blockquote>
<h3 id="帧格式"><a href="#帧格式" class="headerlink" title="帧格式"></a>帧格式</h3><p>必须规定特殊的字符作为帧定界符</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012211826281.png" alt="image-20201012211826281"></p>
<h3 id="透明传输-1"><a href="#透明传输-1" class="headerlink" title="透明传输"></a>透明传输</h3><p>必须保证数据传输的透明性</p>
<p>实现透明传输的方法：</p>
<ul>
<li><strong>面向字节的异步链路</strong>：字节填充法（插入“转义字符”）</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012212148803.png" alt="image-20201012212148803"></p>
<ul>
<li><strong>面向比特的同步链路</strong>：比特填充法（插入“比特0”）</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012212255550.png" alt="image-20201012212255550"></p>
<h3 id="差错检测-1"><a href="#差错检测-1" class="headerlink" title="差错检测"></a>差错检测</h3><p>能够对接收端收到的帧进行检测，并<mark>立即丢弃</mark>有差错的帧。<mark>向上层提供的是不可靠的服务</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012212558654.png" alt="image-20201012212558654"></p>
<h3 id="工作状态"><a href="#工作状态" class="headerlink" title="工作状态"></a>工作状态</h3><ul>
<li>当用户拨号接入 ISP 时，路由器的调制解调器对拨号做出确认，并建立一条物理连接。</li>
<li>PC 机向路由器发送一系列的 LCP 分组（封装成多个 PPP 帧）。</li>
<li>这些分组及其响应选择一些 PPP 参数，并进行网络层配置，NCP 给新接入的 PC 机</li>
<li>分配一个临时的 IP 地址，使 PC 机成为因特网上的一个主机。</li>
<li>通信完毕时，NCP 释放网络层连接，收回原来分配出去的 IP 地址。接着，LCP 释放数据链路层连接。最后释放的是物理层的连接。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201012213021860.png" alt="image-20201012213021860"></p>
<blockquote>
<p>可见，PPP 协议已不是纯粹的数据链路层的协议，它还包含了物理层和网络层的内容。</p>
</blockquote>
<h2 id="媒体接入控制（介质访问控制）MAC—广播信道"><a href="#媒体接入控制（介质访问控制）MAC—广播信道" class="headerlink" title="媒体接入控制（介质访问控制）MAC—广播信道"></a>媒体接入控制（介质访问控制）MAC—广播信道</h2><h3 id="媒体接入控制的基本概念"><a href="#媒体接入控制的基本概念" class="headerlink" title="媒体接入控制的基本概念"></a>媒体接入控制的基本概念</h3><ul>
<li><strong>共享信道</strong>着重考虑一个问题：<mark>如何协调媒体接入控制MAC</mark>(Medium Access Control)。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.2mhukq83oiq0.webp" alt="image"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.280s01udv51c.webp" alt="image"></p>
<blockquote>
<p>随着技术的发展，交换技术的成熟和成本的降低，具有更高性能的使用点对点链路和链路层交换机的交换式局域网在有线领域已完全取代了共享式局域网，但由于无线信道的广播天性，无线局域网仍然使用的是共享媒体技术</p>
</blockquote>
<h3 id="静态划分信道"><a href="#静态划分信道" class="headerlink" title="静态划分信道"></a>静态划分信道</h3><ol>
<li>信道复用</li>
</ol>
<p><strong>复用(Multiplexing)是通信技术中的一个重要概念</strong>。<mark>复用</mark>就是通过**一条物理线路同时传输多路用户的<mark>**信号</mark>。</p>
<p>当网络中传输媒体的传输容量大于多条单一信道传输的总通信量时,可利用复用技术在一条物理线路上建立多条通信信道来充分利用传输媒体的带宽。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4pu8jh6zvgy0.webp" alt="image"></p>
<ol start="2">
<li>频分复用FM</li>
</ol>
<ul>
<li><p>将整个带宽分为多份，用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带。</p>
</li>
<li><p><strong>频分复用</strong>的所有用户在同样的时间<strong>占用不同的带宽资源</strong>（请注意，这里的“带宽”是频率带宽而不是数据的发送速率）。</p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4clh309v96y0.webp" alt="image"></p>
<blockquote>
<p>频分复用的所有用户同时占用不同的频带资源并行通信。</p>
</blockquote>
<ol start="3">
<li>时分复用TDM</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4hv0n06v2360.webp" alt="image"></p>
<blockquote>
<p>时分复用的所有用户在不同的时间占用同样的频带宽度。</p>
</blockquote>
<ol start="4">
<li>波分复用WDM</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.2zy3fibqo2u0.webp" alt="image"></p>
<blockquote>
<p>波分复用就是光的频分复用，使用一根光纤来同时传输多个光载波信号</p>
<p>光信号传输一段距离后悔衰减，所以要用<strong>掺铒光纤放大器</strong>放大光信号</p>
</blockquote>
<ol start="5">
<li>码分复用CDM  (Code Division Multiplexing)</li>
</ol>
<p><strong>基本概念：</strong></p>
<ul>
<li>与FDM和TDM不同，CDM的每一个用户可以<mark>在同样的时间使用同样的频带进行通信</mark>。</li>
<li>由于各用户使用经过特殊挑选的不同码型，因此<mark>各用户之间不会造成干扰</mark>。</li>
</ul>
<p>⭐⭐⭐<strong>关于计算：</strong></p>
<p>在CDMA中，每一个比特时间再划分为m个短的间隔，称为<mark>码片</mark> (Chip)。通常m的值是64或128。为了简单起见，在后续的举例中，我们假设m为8。</p>
<p>使用CDMA的每一个站被指派一个唯一的<mark>m bit码片序列</mark> (Chip Sequence)</p>
<ul>
<li>一个站如果<mark>要发送比特1</mark>，则<mark>发送它自己的m bit码片序列</mark>;</li>
<li>一个站如果<mark>要发送比特0</mark>，则<mark>发送它自己的m bit码片序列的二进制反码</mark></li>
</ul>
<p><strong>举例：</strong></p>
<p>指派给CDMA系统中某个站点的码片序列为<mark>00011011</mark><br>发送比特1：发送自己的码片序列<mark>00011011</mark></p>
<p>发送比特0：发送自己的码片序列的二进制反码<mark>11100100</mark></p>
<p>为了方便，我们按惯例将码片序列中的0写为-1，将1写为+1，则该站点的码片序列是<mark>(-1 -1-1 +1 +1-1 +1 +1)</mark>。</p>
<p><strong>码片序列的挑选原则如下:</strong></p>
<ol>
<li>分配给每个站的<mark>码片序列必须各不相同</mark>，实际常采用伪随机码序列</li>
<li>分配给每个站的<mark>码片序列必须相互正交</mark> (规格化内积为0)。<br>令向量S表示站S的码片序列，令向量T表示其他任何站的码片序列。<br>两个不同站S和T的码片序列正交，就是向量S和T的规格化内积为0：</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122153656906.png" alt="image-20231122153656906"></p>
<p><strong>例题：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013203459640.png" alt="image-20201013203459640"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013203819578.png" alt="image-20201013203819578"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122154047803.png" alt="image-20231122154047803"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122154252843.png" alt="image-20231122154252843"></p>
<h3 id="动态接入控制"><a href="#动态接入控制" class="headerlink" title="动态接入控制"></a>动态接入控制</h3><h4 id="随机接入（CSMA-CD协议）"><a href="#随机接入（CSMA-CD协议）" class="headerlink" title="随机接入（CSMA&#x2F;CD协议）"></a>随机接入（CSMA&#x2F;CD协议）</h4><h5 id="多址接入MA"><a href="#多址接入MA" class="headerlink" title="多址接入MA"></a>多址接入MA</h5><p>表示许多主机以多点接入的方式连接在一根总线上。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013215400688.png" alt="image-20201013215400688"></p>
<h5 id="载波监听CS"><a href="#载波监听CS" class="headerlink" title="载波监听CS"></a>载波监听CS</h5><p>是指每一个站在<mark>发送数据之前</mark>先要<mark>检测一下总线上是否有其他计算机在发送数据</mark>，如果有，则暂时不要发送数据，以免发生碰撞。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013215530979.png" alt="image-20201013215530979"></p>
<p>总线上并没有什么“载波”。因此， <strong>“载波监听”就是用电子技术检测总线上有没有其他计算机发送的数据信号。</strong></p>
<h5 id="碰撞检测CD"><a href="#碰撞检测CD" class="headerlink" title="碰撞检测CD"></a>碰撞检测CD</h5><ul>
<li><strong>“碰撞检测”</strong>就是计算机<strong>边发送数据边检测</strong>信道上的信号电压大小。</li>
<li><strong>所谓“碰撞”就是发生了冲突。因此“<mark>碰撞检测”也称为“冲突检测</mark>”。</strong></li>
<li>在发生碰撞时，总线上传输的信号产生了严重的失真，无法从中恢复出有用的信息来。</li>
<li><strong>每一个正在发送数据的站，一旦发现总线上出现了碰撞，就要立即停止发送，免得继续浪费网络资源，然后等待一段随机时间后再次发送。</strong></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013221240514.png" alt="image-20201013221240514"></p>
<blockquote>
<p>为什么要进行碰撞检测？ 因为信号传播时延对载波监听产生了影响</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013221834942.png" alt="image-20201013221834942"></p>
<p>A 需要单程传播时延的 2 倍的时间，才能检测到与 B 的发送产生了冲突</p>
</blockquote>
<h5 id="CSMA-CD-协议工作流程"><a href="#CSMA-CD-协议工作流程" class="headerlink" title="CSMA&#x2F;CD 协议工作流程"></a>CSMA&#x2F;CD 协议工作流程</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013221705893.png" alt="image-20201013221705893"></p>
<h5 id="争用期（碰撞窗口）"><a href="#争用期（碰撞窗口）" class="headerlink" title="争用期（碰撞窗口）"></a>争用期（碰撞窗口）</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122180352561.png" alt="image-20231122180352561"></p>
<ul>
<li>主机<mark>最多经过2τ的时长</mark>就可检测到本次发送是否遭受了碰撞</li>
<li>因此，<mark>以太网的端到端往返传播时延2τ称为争用期或碰撞窗口</mark>。</li>
<li>经过争用期这段时间还没有检测到碰撞，才能肯定这次发送不会发生碰撞。</li>
<li>显然，在以太网中发送顿的主机越多，端到端往返传播时延越大，发生碰撞的概率就越大。因此，<mark>共享式以太网不能连接太多的主机，使用的总线也不能太长</mark>。</li>
</ul>
<blockquote>
<p><mark><strong>争用期</strong> &#x3D; 2 * 端到端距离 &#x2F; 电磁波信号速率 &#x3D; 2τ</mark></p>
</blockquote>
<h5 id="最小帧长"><a href="#最小帧长" class="headerlink" title="最小帧长"></a>最小帧长</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122180741742.png" alt="image-20231122180741742"></p>
<ul>
<li><p><mark>以太网规定最小帧长为64字节</mark>，即512比特 (512比特时间即为争用期);</p>
<ul>
<li>如果要发送的数据非常少，那么必须加入一些填充字节，使帧长不小于64字节。</li>
</ul>
</li>
<li><p>以太网的<mark>最小帧长确保了主机可在帧发送完成之前就检测到该顿的发送过程中是否遭遇了碰撞</mark></p>
</li>
</ul>
<blockquote>
<p><mark><strong>最小帧长</strong> &#x3D; 争用期 × 数据传输速率</mark></p>
</blockquote>
<h5 id="最大帧长"><a href="#最大帧长" class="headerlink" title="最大帧长"></a>最大帧长</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013225400777.png" alt="image-20201013225400777"></p>
<h5 id="截断二进制指数退避算法"><a href="#截断二进制指数退避算法" class="headerlink" title="截断二进制指数退避算法"></a>截断二进制指数退避算法</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013230717856.png" alt="image-20201013230717856"></p>
<h5 id="信道利用率"><a href="#信道利用率" class="headerlink" title="信道利用率"></a>信道利用率</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201013231430295.png" alt="image-20201013231430295"></p>
<h5 id="帧发送流程"><a href="#帧发送流程" class="headerlink" title="帧发送流程"></a>帧发送流程</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122181358004.png" alt="image-20231122181358004"></p>
<h5 id="帧接收流程"><a href="#帧接收流程" class="headerlink" title="帧接收流程"></a>帧接收流程</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122181434076.png" alt="image-20231122181434076"></p>
<h5 id="重要特性"><a href="#重要特性" class="headerlink" title="重要特性"></a>重要特性</h5><ul>
<li>使用 CSMA&#x2F;CD 协议的以太网不能进行全双工通信而<strong>只能进行双向交替通信（半双工通信）。</strong></li>
<li>每个站在发送数据之后的一小段时间内，存在着遭遇碰撞的可能性。 </li>
<li>这种<strong>发送的不确定性</strong>使整个以太网的平均通信量远小于以太网的最高数据率。</li>
</ul>
<blockquote>
<p>CSMA&#x2F;CD协议曾经用于各种总线结构以太网和双绞线以太网的早期版本中。</p>
<p><strong>现在的以太网基于交换机和全双工连接，不会有碰撞，因此没有必要使用CSMA&#x2F;CS协议</strong></p>
</blockquote>
<h5 id="⭐⭐⭐例题"><a href="#⭐⭐⭐例题" class="headerlink" title="⭐⭐⭐例题"></a>⭐⭐⭐<strong>例题</strong></h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122181741690.png" alt="image-20231122181741690"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122174456671.png" alt="image-20231122174456671"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122181843695.png" alt="image-20231122181843695"></p>
<p>解析：<strong>最短需要经过的时间</strong>是主机甲和主机乙同时发送数据，到达中间时刻后发生碰撞，那么就会返回碰撞信号回去，那么时间就为花费端到端距离的一半的时间加上返回碰撞信号的时间（同样为端到端距离的一半的时间），加起来一共就是花费端到端距离的时间。</p>
<p><strong>最长需要经过的时间</strong>：假设主机甲发送数据后，已经无限接近于主机乙了，此时主机乙才发送数据，在无限趋近于主机乙的地点发生了碰撞，那么时间花费就为主机甲发送数据到主机乙的时间（即端到端距离的的时间）加上碰撞信号返回给主机甲的时间（也即端到端距离的时间）&#x3D;两倍的端到端的距离所花费的时间。</p>
<h4 id="随机接入（CSMA-CA协议）"><a href="#随机接入（CSMA-CA协议）" class="headerlink" title="随机接入（CSMA&#x2F;CA协议）"></a>随机接入（CSMA&#x2F;CA协议）</h4><h5 id="为什么无线局域网要使用CSMA-CA协议"><a href="#为什么无线局域网要使用CSMA-CA协议" class="headerlink" title="为什么无线局域网要使用CSMA&#x2F;CA协议"></a>为什么无线局域网要使用CSMA&#x2F;CA协议</h5><blockquote>
<p>问：既然CSMA&#x2F;CD协议已经成功地应用于使用广播信道的有线局域网，那么同样使用广播信道的无线局域网能不能也使用CSMA&#x2F;CD协议呢?</p>
</blockquote>
<ul>
<li><mark>在无线局域网中，仍然可以使用载波监听多址接入CSMA</mark>，即在发送顿之前先对传输媒体进行载波监听。若发现有其他站在发送帧，就推迟发送以免发生碰撞。</li>
<li><mark>在无线局域网中，不能使用碰撞检测CD</mark>，原因如下:<ul>
<li>由于无线信道的传输条件特殊，其信号强度的动态范围非常大，无线网卡上接收到的信号强度往往会远远小于发送信号的强度 (可能相差百万倍)。<mark>如果要在无线网卡上实现碰撞检测CD，对硬件的要求非常高</mark>。</li>
<li>即使能够在硬件上实现无线局域网的碰撞检测功能，但由于无线电波传播的特殊性（<mark>存在<strong>隐蔽站问题</strong></mark>），<mark>进行碰撞检测的意义也不大</mark>。</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122220836351.png" alt="隐蔽站问题"></p>
<ul>
<li><mark>802.11无线局域网</mark>使用CSMA&#x2F;CA协议，在CSMA的基础上增加了一个<mark><strong>碰撞避免CA功能</strong></mark>，而不再实现碰撞检测功能。</li>
<li>由于不可能避免所有的碰撞，并且<mark>无线信道误码率较高</mark>，802.11标准还使用了数据链路层<mark><strong>确认机制（停止-等待协议）</strong></mark>来保证数据被正确接收。</li>
<li>802.11的MAC层标准定义了两种不同的媒体接入控制方式：<ul>
<li><strong>分布式协调功能DCF</strong>(Distributed Coordination Function)。在DCF方式下，没有中心控制站点，每个站点使用CSMA&#x2F;CA协议通过争用信道来获取发送权，这是802.11定义的默认方式。</li>
<li><strong>点协调功能PCF</strong>(Point Coordination Function)。PCF方式使用集中控制的接入算法(一般在接入点AP实现集中控制)，是802.11定义的可选方式，在实际中较少使用。</li>
</ul>
</li>
</ul>
<h5 id="帧间间隔IFS（InterFrame-Space）"><a href="#帧间间隔IFS（InterFrame-Space）" class="headerlink" title="帧间间隔IFS（InterFrame Space）"></a>帧间间隔IFS（InterFrame Space）</h5><ul>
<li>802.11标准规定，所有的<mark>站点必须在持续检测到信道空闲一段指定时间后才能发送帧</mark>，这段时间称为帧间间隔IFS。</li>
<li>帧间间隔的长短取决于该站点要发送的帧的类型：<ul>
<li>高优先级需要等待的时间较短，因此可优先获得发送权；</li>
<li>低优先级帧需要等待的时间较长。若某个站的低优先级帧还没来得及发送，而其他站的高优先级帧已发送到信道上，则信道变为忙态，因而低优先级帧就只能再推迟发送了。这样就<strong>减少了发生碰撞的机会</strong>。</li>
</ul>
</li>
<li>常用的两种帧间间隔如下：<ul>
<li>**短帧间间隔SIFS(28us)**，是最短的顿间间隔，用来分隔开属于一次对话的各。一个站点应当能够在这<br>段时间内从发送方式切换到接收方式。使用SIFS的帧类型有ACK帧、CTS、由过长的MAC分片后的数据帧、以及所有回答AP探询的帧和在PCF方式中接入点AP发送出的任何帧。</li>
<li>**DCF帧间间隔DIFS(128us)**，它比短间间隔SIFS要长得多，在DCF方式中用来发送数据顿和管理帧。</li>
</ul>
</li>
</ul>
<h5 id="CSMA-CA协议的工作原理"><a href="#CSMA-CA协议的工作原理" class="headerlink" title="CSMA&#x2F;CA协议的工作原理"></a>CSMA&#x2F;CA协议的工作原理</h5><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014200833233.png" alt="image-20201014200833233"></p>
<blockquote>
<p><strong>问：源站为什么在检测到信道空闲后还要再等待一段时间DIFS？</strong></p>
<ul>
<li>考虑到可能有其他的站有高优先级的帧要发送。若有，就要让高优先级帧先发送</li>
</ul>
<p><strong>问：目的站为什么正确接收数据帧后还要等待一段时间SIFS才能发送ACK帧？</strong></p>
<ul>
<li>SIFS是最短的帧间间隔，用来分隔开属于一次对话的各帧，在这段时间内，一个站点应当能够从发送方式切换到接收方式</li>
</ul>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014201511741.png" alt="image-20201014201511741"></p>
<blockquote>
<p><strong>问：信道由忙转为空闲且经过DIFS时间后，还要退避一段随机时间才能使用信道？</strong></p>
<p>防止多个站点同时发送数据而产生碰撞</p>
</blockquote>
<h5 id="CSMA-CA协议的退避算法"><a href="#CSMA-CA协议的退避算法" class="headerlink" title="CSMA&#x2F;CA协议的退避算法"></a>CSMA&#x2F;CA协议的退避算法</h5><p><strong>使用退避算法的原因：</strong></p>
<blockquote>
<p>防止多个站点同时发送数据而产生碰撞</p>
</blockquote>
<p><strong>使用退避算法的时机：</strong></p>
<ul>
<li><p>以下情况必须使用退避算法:</p>
<ul>
<li>在发送数据帧之前检测到信道处于忙状态时；</li>
<li>在每一次重传一个数据帧时；</li>
<li>在每一次成功发送后要连续发送下一个时(这是为了避免一个站点长时间占用信道)。</li>
</ul>
</li>
<li><p>在执行退避算法时，站点为退避计时器设置一个<mark>随机的退避时间</mark>:</p>
<ul>
<li>当退避计时器的时间减小到零时，就开始发送数据:</li>
<li>当退避计时器的时间还未减小到零时而信道又转变为忙状态，这时就<mark>冻结</mark>退避计时器的数值，重新等待信道变为空闲，再经过时间DIFS后，继续启动退避计时器.</li>
</ul>
</li>
<li><p>在进行第i次退避时，退避时间在时隙编号{0，1，…，2?1中随机选择一个，然后乘以基本退避时间(也就是一个时隙的长度)就可以得到随机的退避时间。这样做是为了使不同站点选择相同退避时间的概率减少。当时隙编号达到255时(对应于第6次退避)就不再增加了。</p>
</li>
</ul>
<p><strong>退避算法的示例：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014202819851.png" alt="image-20201014202819851"></p>
<h5 id="CSMA-CA协议的信道预约和虚拟载波监听"><a href="#CSMA-CA协议的信道预约和虚拟载波监听" class="headerlink" title="CSMA&#x2F;CA协议的信道预约和虚拟载波监听"></a>CSMA&#x2F;CA协议的信道预约和虚拟载波监听</h5><p>为了<mark>尽可能减少碰撞的概率</mark>和降低碰撞的影响，802.11标准允许要发送数据的站点<mark>对信道进行预约</mark>。</p>
<p>流程如下：</p>
<ol>
<li>源站在发送数据顿之前先发送一个短的控制，称为<mark>请求发送RTS</mark>(Request To Snd)，它包括源地址目的地址以及这次通信(包括相应的确认帧) 所需的持续时间。</li>
<li>若目的站正确收到源站发来的RTS，且媒体空闲，就发送一个响应控制帧，称为<mark>允许发送CTS</mark>(Clear To Send)，它也包括这次通信所需的持续时间 (从RTS帧中将此持续时间复制到CTS中)。</li>
<li>源站收到CTS顿后，再等待一段时间SIFS后，就可发送其数据帧。</li>
<li>若目的站正确收到了源站发来的数据帧，在等待时间SIFS后，就向源站发送确认帧ACK。</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122222251840.png" alt="image-20231122222251840"></p>
<ul>
<li>除源站和目的站以外的<strong>其他各站</strong>，在<strong>收到CTS帧(或数据)后就<mark>推迟接入</mark>到无线局域网中</strong>。这样就保证了源站和目的站之间的通信不会受到其他站的干扰。</li>
<li>如果RTS帧发生碰撞，源站就收不到CTS顿，需执行退避算法重传RTS帧。</li>
<li>由于<mark>RTS帧和CTS帧很短，发送碰撞的概率、碰撞产生的开销及本身的开销都很小</mark>。而对于一般的数据顿，其发送时延往往大于传播时延(因为是局域网)，碰撞的概率很大，且一旦发生碰撞而导致数据帧重发，则浪费的时间就很多，因此<mark>用很小的代价对信道进行预约往往是值得的</mark>。</li>
<li>802.11标准规定了3种情况供用户选择：<ul>
<li>使用RTS帧和CTS帧</li>
<li>不使用RTS帧和CTS帧</li>
<li>只有当数据帧的长度超过某一数值时才使用RTS帧和CTS帧</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122222731704.png" alt="image-20231122222731704"></p>
<ul>
<li>由于利用虚拟载波监听机制，<mark>站点只要监听到RTS帧、CTS或数据帧中的任何一个，就能知道信道被占用的持续时间</mark>，而不需要真正监听到信道上的信号，因此虚拟载波监听机制能减少隐蔽站带来的碰撞问题。</li>
</ul>
<p><strong>虚拟载波监听机制能减少隐蔽站带来的碰撞问题的示例</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231122222958453.png" alt="image-20231122222958453"></p>
<blockquote>
<p>C从B发送的CTS知道了其占用信道的时间，则该时间段内C是不会向B发送数据的，这样就能减少隐蔽站带来的碰撞问题</p>
</blockquote>
<h2 id="MAC地址、IP地址以及ARP协议"><a href="#MAC地址、IP地址以及ARP协议" class="headerlink" title="MAC地址、IP地址以及ARP协议"></a>MAC地址、IP地址以及ARP协议</h2><ul>
<li>MAC地址是以太网的MAC子层所使用的地址；（属于数据链路层）</li>
<li>IP地址是TCP&#x2F;IP体系结构网际层所使用的地址；（属于网际层）</li>
<li>ARP协议属于TCP&#x2F;IP体系结构的网际层，其作用是已知设备所分配到的IP地址，<mark>使用ARP协议可以通过该IP地址获取到设备的MAC地址</mark>；（属于网际层）</li>
<li>尽管IP地址和ARP协议属于TCP&#x2F;IP体系结构的网际层(而不属于数据链路层)，但是它们与MAC地址存在一定的关系，并且我们日常的网络应用都离不开MAC地址、IP地址以及ARP协议。因此，我们将这三者放在一起讨论。</li>
</ul>
<h3 id="MAC地址"><a href="#MAC地址" class="headerlink" title="MAC地址"></a>MAC地址</h3><blockquote>
<ul>
<li>使用点对点信道的数据链路层不需要使用地址</li>
<li>使用广播信道的数据链路层必须使用地址来区分各主机</li>
</ul>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014223659993.png" alt="image-20201014223659993"></p>
<h4 id="广播信道的数据链路层必须使用地址（MAC）"><a href="#广播信道的数据链路层必须使用地址（MAC）" class="headerlink" title="广播信道的数据链路层必须使用地址（MAC）"></a>广播信道的数据链路层必须使用地址（MAC）</h4><ul>
<li>当多个主机连接在同一个广播信道上，要想实现两个主机之间的通信，则每个主机都必须有一个唯一的标识，即一个数据链路层地址;</li>
<li>在每个主机发送的<mark>帧中必须携带标识发送主机和接收主机的地址</mark>。由于这类地址是用于媒体接入控制<br>MAC(Media Access Control)，因此这类地址被称为<mark>MAC地址</mark>；</li>
<li>MAC地址又称作硬件地址或物理地址。（<mark>注意：这并不意味着MAC地址属于网络体系结构中的物理层</mark>）</li>
<li>一般情况下，用户主机会包含两个网络适配器: 有线局域网适配器(有网卡)和无线局域网适配器(无线网卡)。每个网络适配器都有一个全球唯一的MAC地址。而交换机和路由器往往拥有更多的网络接口，所以会拥有更多的MAC地址。综上所述，<mark>严格来说，MAC地址是对网络上各接口的唯一标识，而不是对网络上各设备的唯一标识</mark>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123152543906.png" alt="image-20231123152543906"></p>
<h4 id="IEEE-802局域网的MAC地址格式"><a href="#IEEE-802局域网的MAC地址格式" class="headerlink" title="IEEE 802局域网的MAC地址格式"></a>IEEE 802局域网的MAC地址格式</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014225358570.png" alt="image-20201014225358570"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014230248959.png" alt="image-20201014230248959"></p>
<blockquote>
<p><strong>对于检查出的无效</strong> <strong>MAC</strong> <strong>帧就简单地丢弃。以太网不负责重传丢弃的帧。</strong> </p>
</blockquote>
<h4 id="IEEE-802局域网的MAC地址发送顺序"><a href="#IEEE-802局域网的MAC地址发送顺序" class="headerlink" title="IEEE 802局域网的MAC地址发送顺序"></a>IEEE 802局域网的MAC地址发送顺序</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014230625182.png" alt="image-20201014230625182"></p>
<h4 id="单播MAC地址举例"><a href="#单播MAC地址举例" class="headerlink" title="单播MAC地址举例"></a>单播MAC地址举例</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014230822305.png" alt="image-20201014230822305"></p>
<blockquote>
<p>主机B给主机C发送<strong>单播帧</strong>，主机B首先要构建该<strong>单播帧</strong>，<strong>在帧首部中的目的地址字段填入主机C的MAC地址</strong>，源地址字段填入自己的MAC地址，再加上帧首部的其他字段、数据载荷以及帧尾部，就构成了该<strong>单播帧</strong></p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014231244655.png" alt="image-20201014231244655"></p>
<blockquote>
<p>主机B将该<strong>单播帧</strong>发送出去，主机A和C都会收到该<strong>单播帧</strong></p>
<p>主机A的网卡发现该<strong>单播帧</strong>的目的MAC地址与自己的MAC地址不匹配，丢弃该帧</p>
<p>主机C的网卡发现该<strong>单播帧</strong>的目的MAC地址与自己的MAC地址匹配，接受该帧，并将该帧交给其上层处理</p>
</blockquote>
<h4 id="广播MAC地址举例"><a href="#广播MAC地址举例" class="headerlink" title="广播MAC地址举例"></a>广播MAC地址举例</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014231754669.png" alt="image-20201014231754669"></p>
<blockquote>
<p>假设主机B要发送一个<strong>广播帧</strong>，主机B首先要构建该<strong>广播帧</strong>，<strong>在帧首部中的目的地址字段填入广播地址</strong>，也就是十六进制的全F，源地址字段填入自己的MAC地址，再加上帧首部中的其他字段、数据载荷以及帧尾部，就构成了该<strong>广播帧</strong></p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014232132424.png" alt="image-20201014232132424"></p>
<blockquote>
<p>主机B讲该<strong>广播帧</strong>发送出去，主机A和C都会收到该<strong>广播帧</strong>，<strong>发现该帧首部中的目的地址字段的内容是广播地址</strong>，就知道该帧是<strong>广播帧</strong>，主机A和主机C都接受该帧，并将该帧交给上层处理</p>
</blockquote>
<h4 id="多播MAC地址举例"><a href="#多播MAC地址举例" class="headerlink" title="多播MAC地址举例"></a>多播MAC地址举例</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201014232714791.png" alt="image-20201014232714791"></p>
<blockquote>
<p>假设主机A要发送<strong>多播帧</strong>给该<strong>多播地址</strong>。将该<strong>多播地址</strong>的左起第一个字节写成8个比特，第一个字节的最低比特位是1，这就表明该地址是<strong>多播地址</strong>。</p>
<p>快速判断地址是不是<strong>多播地址</strong>，就是上图所示箭头所指的第十六进制数不能整除2（1,3,5,7,9,B,D,F），则该地址是<strong>多播地址</strong></p>
<p>假设主机B，C和D支持多播，各用户给自己的主机配置多播组列表<strong>如下所示</strong></p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015001243584.png" alt="image-20201015001243584"></p>
<blockquote>
<p>主机B属于两个多播组，主机C也属于两个多播组，而主机D不属于任何多播组</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015001535528.png" alt="image-20201015001535528"></p>
<blockquote>
<p>主机A首先要构建该<strong>多播帧</strong>，<strong>在帧首部中的目的地址字段填入该多播地址</strong>，源地址点填入自己的MAC地址，再加上帧首部中的其他字段、数据载荷以及帧尾部，就构成了该<strong>多播帧</strong></p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015002054876.png" alt="image-20201015002054876"></p>
<blockquote>
<p>主机A将该<strong>多播帧</strong>发送出去，主机B、C、D都会收到该<strong>多播帧</strong></p>
<p><strong>主机B和C发现该多播帧的目的MAC地址在自己的多播组列表中</strong>，主机B和C都会接受该帧</p>
<p>主机D发现该<strong>多播帧</strong>的目的MAC地址不在自己得多播组列表中，则丢弃该<strong>多播帧</strong></p>
</blockquote>
<h3 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h3><p><mark><strong>IP地址和MAC地址的区别：</strong></mark></p>
<ol>
<li><strong>作用层次不同：</strong><ul>
<li><strong>MAC地址：</strong> 作用于数据链路层（第二层）上，用于在局域网内唯一<strong>标识网络设备的物理网络接口</strong>，例如以太网卡。</li>
<li><strong>IP地址：</strong> 作用于网络层（第三层）上，用于在全球范围内唯一<strong>标识网络上的设备</strong>，并支持设备之间的逻辑通信。</li>
</ul>
</li>
<li><strong>唯一性范围不同：</strong><ul>
<li><strong>MAC地址：</strong> 在一个局域网内是唯一的，由网络设备的制造商分配。当数据包在局域网内传输时，路由器通常不修改MAC地址。</li>
<li><strong>IP地址：</strong> 在全球范围内是唯一的，由互联网注册机构（如ICANN）分配。IP地址用于在不同网络之间进行通信，路由器在转发数据包时通常会修改源和目标的IP地址。</li>
</ul>
</li>
<li><strong>层次关系：</strong><ul>
<li><strong>MAC地址：</strong> 位于数据链路层，用于在同一局域网内直接通信，是数据链路层的地址。</li>
<li><strong>IP地址：</strong> 位于网络层，用于在不同网络之间进行通信，是网络层的地址。</li>
</ul>
</li>
</ol>
<blockquote>
<p>IP地址属于网络层的范畴，不属于数据链路层的范畴</p>
</blockquote>
<p>下面内容讲的是IP地址的使用，详细的IP地址内容在网络层中介绍</p>
<h4 id="基本概念-5"><a href="#基本概念-5" class="headerlink" title="基本概念"></a>基本概念</h4><ul>
<li><p>IP地址是因特网(Internet) 上的主机和路由器所使用的地址，用于标识两部分信息:</p>
<ul>
<li><strong>网络编号</strong>: 标识因特网上数以百万计的网络</li>
<li><strong>主机编号</strong>: 标识同一网络上不同主机(或路由器各接口)</li>
</ul>
</li>
<li><p>很显然，之前介绍的MAC地址不具备区分不同网络的功能。</p>
<ul>
<li>如果只是一个单独的网络，不接入因特网，可以只使用MAC地址 (这不是一般用户的应用方式)</li>
<li>如果主机所在的网络要接入因特网，则IP地址和MAC地址都需要使用。</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123161030825.png" alt="image-20231123161030825"></p>
<h4 id="从网络体系结构看IP地址与MAC地址"><a href="#从网络体系结构看IP地址与MAC地址" class="headerlink" title="从网络体系结构看IP地址与MAC地址"></a>从网络体系结构看IP地址与MAC地址</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123161405686.png" alt="image-20231123161405686"></p>
<h4 id="数据包转发过程中IP地址与MAC地址的变化情况"><a href="#数据包转发过程中IP地址与MAC地址的变化情况" class="headerlink" title="数据包转发过程中IP地址与MAC地址的变化情况"></a>数据包转发过程中IP地址与MAC地址的变化情况</h4><ul>
<li>数据包转发过程中<mark>源IP地址和目的IP地址保持不变</mark></li>
<li>数据包转发过程中<mark>源MAC地址和目的MAC地址逐个链路 (或逐个网络)改变</mark></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123161720608.png" alt="image-20231123161720608"></p>
<blockquote>
<p>如何从IP地址找出其对应的MAC地址？</p>
<p>ARP协议</p>
</blockquote>
<h3 id="ARP协议"><a href="#ARP协议" class="headerlink" title="ARP协议"></a>ARP协议</h3><p>如何从IP地址找出其对应的MAC地址？</p>
<p>ARP（地址解析协议）</p>
<h4 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015113826197.png" alt="image-20201015113826197"></p>
<p>ARP高速缓存表</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015114052206.png" alt="image-20201015114052206"></p>
<blockquote>
<p>当主机B要给主机C发送数据包时，会首先在自己的ARP高速缓存表中查找主机C的IP地址所对应的MAC地址，但未找到，因此，主机B需要发送ARP请求报文，来获取主机C的MAC地址</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015114444263.png" alt="image-20201015114444263"></p>
<blockquote>
<p>ARP请求报文有具体的格式，上图的只是简单描述</p>
<p>ARP请求报文被封装在MAC帧中发送，目的地址为广播地址</p>
<p>主机B发送封装有ARP请求报文的广播帧，总线上的其他主机都能收到该广播帧</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015114811501.png" alt="image-20201015114811501"></p>
<blockquote>
<p>收到ARP请求报文的主机A和主机C会把ARP请求报文交给上层的ARP进程</p>
<p>主机A发现所询问的IP地址不是自己的IP地址，因此不用理会</p>
<p>主机C的发现所询问的IP地址是自己的IP地址，需要进行相应</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015115212170.png" alt="image-20201015115212170"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015115236673.png" alt="image-20201015115236673"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015115252972.png" alt="image-20201015115252972"></p>
<p>动态与静态的区别</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015115831543.png" alt="image-20201015115831543"></p>
<p><strong>ARP协议只能在一段链路或一个网络上使用，而不能跨网络使用</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201015120108028.png" alt="image-20201015120108028"></p>
<blockquote>
<p>ARP协议的使用是逐段链路进行的</p>
</blockquote>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><ul>
<li><p>源主机在自己的<mark>ARP高速缓存表</mark>中查找目的主机的IP地址所对应的MAC地址，若找到了，则可以封装MAC帧进行发送;若找不到，则发送<mark>ARP请求(封装在<strong>广播MAC</strong>中)</mark> ；</p>
</li>
<li><p>目的主机收到ARP请求后，将源主机的IP地址与MAC地址记录到自己的ARP高速缓存表中，然后给源主机发送<mark>ARP响应 (封装在<strong>单播MAC帧</strong>中)</mark>，ARP响应中包含有目的主机的IP地址和MAC地址；</p>
</li>
<li><p>源主机收到ARP响应后，将目的主机的IP地址与MAC地址记录到自己的ARP高速缓存表中，然后就可以封装之前想发送的MAC帧并发送给目的主机；</p>
</li>
<li><p><mark>ARP的作用范围: 逐段链路或逐个网络使用</mark></p>
</li>
<li><p><strong>除ARP请求和响应外，ARP还有其他类型的报文</strong>(例如用于检查IP地址冲突的“无故ARP、免费ARP(Gratuitous ARP)”);</p>
</li>
<li><p>ARP没有安全验证机制，<strong>存在ARP欺骗(攻击)问题</strong></p>
</li>
<li><p>ARP表中的IP地址与MAC地址的对应关系记录，是<strong>会定期自动删除的</strong>，<strong>因为IP地址与MAC地址的对应关系不是永久性的</strong></p>
</li>
</ul>
<h2 id="集线器与交换机的区别"><a href="#集线器与交换机的区别" class="headerlink" title="集线器与交换机的区别"></a>集线器与交换机的区别</h2><h3 id="⭐⭐⭐总结"><a href="#⭐⭐⭐总结" class="headerlink" title="⭐⭐⭐总结"></a>⭐⭐⭐总结</h3><p>🔴🟢🟡<strong>GPT总结：集线器，交换机，路由器的区别：</strong></p>
<ol>
<li><strong>功能：</strong><ul>
<li><strong>集线器（Hub）：</strong> 是一个简单的网络设备，它将收到的数据包广播到所有连接的设备，而无论这些设备是否是目标设备。</li>
<li><strong>交换机（Switch）：</strong> 是一个更智能的设备，能够根据MAC地址学习和过滤数据包，只将数据包发送到目标设备，提高网络效率。</li>
<li><strong>路由器（Router）：</strong> 是用于连接不同网络的设备，能够理解网络层（IP层）的地址，并根据这些地址转发数据包，实现不同网络之间的通信。</li>
</ul>
</li>
<li><strong>工作层次：</strong><ul>
<li><strong>集线器：</strong> 工作在物理层，主要是通过电缆传输比特。</li>
<li><strong>交换机：</strong> 工作在数据链路层，使用MAC地址进行数据包的转发。</li>
<li><strong>路由器：</strong> 工作在网络层，使用IP地址进行数据包的转发。</li>
</ul>
</li>
<li><strong>地址学习和转发：</strong><ul>
<li><strong>集线器：</strong> 不具备地址学习功能，简单地广播所有接收到的数据包。</li>
<li><strong>交换机：</strong> 通过学习MAC地址，只将数据包发送到目标设备，<mark>提高网络效率</mark>。</li>
<li><strong>路由器：</strong> 通过学习IP地址，能够识别不同网络之间的数据包，实现跨网络的通信。</li>
</ul>
</li>
<li><strong>网络层次：</strong><ul>
<li><strong>集线器和交换机：</strong> 主要在局域网内工作，连接同一网络的设备。</li>
<li><strong>路由器：</strong> 主要用于连接不同网络，实现跨网络通信。</li>
</ul>
</li>
<li><strong>广播和碰撞：</strong><ul>
<li><strong>集线器：</strong> 会导致网络中的广播风暴和碰撞，影响性能。</li>
<li><strong>交换机：</strong> 通过划分冲突域（collision domain）和广播域（broadcast domain），减少了广播和碰撞。</li>
<li><strong>路由器：</strong> 将不同网络隔离，减少了广播域。</li>
</ul>
</li>
</ol>
<p>总的来说，集线器主要是物理层设备，交换机是数据链路层设备，而路由器则工作在网络层。它们各自在网络中发挥不同的作用，有助于构建灵活且高效的计算机网络。</p>
<h3 id="集线器"><a href="#集线器" class="headerlink" title="集线器"></a>集线器</h3><p><strong>集线器</strong>的以太网在逻辑上仍是个总线网，需要使用CSMA&#x2F;CD协议来协调各主机争用总线，只能工作在半双工模式，收发帧不能同时进行</p>
<p><strong>使用集线器扩展</strong>：将多个以太网段连成更大的、多级星形结构的以太网：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123205018297.png" alt="image-20231123205018297"></p>
<ul>
<li><strong>优点</strong><ol>
<li>使原来属于不同碰撞域的以太网上的计算机能够进行跨碰撞域的通信。</li>
<li>扩大了以太网覆盖的地理范围。</li>
</ol>
</li>
<li><strong>缺点</strong><ol>
<li><mark><strong>碰撞域</strong>增大了</mark>，但总的吞吐量并未提高。</li>
</ol>
</li>
</ul>
<h3 id="交换机"><a href="#交换机" class="headerlink" title="交换机"></a>交换机</h3><p><img src="file://G:/BaiduNetdiskDownload/1.%E8%B5%84%E6%96%99/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%88%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%89.assets/image-20201015152232158.png?lastModify=1700702613" alt="image-20201015152232158"></p>
<blockquote>
<p>使用<strong>集线器</strong>互连而成的共享总线式以太网上的某个主机，要给另一个主机发送单播帧，该单播帧会通过共享总线传输到<strong>总线上的其他各个主机</strong></p>
<p>使用交换机互连而成的交换式以太网上的某个主机，要给另一个主机发送单播帧，<mark>该单播帧进入交换机后，交换机会将该单播帧转发给目的主机，<strong>而不是网络中的其他各个主机</strong></mark>。</p>
<p><strong>这个例子的前提条件是忽略ARP过程，并假设交换机的帧交换表已经学习或配置好了</strong></p>
</blockquote>
<p><strong>基本特点：</strong></p>
<ul>
<li>以太网交换机通常都有<mark>多个接口</mark>。每个接口都可以直接与一台主机或另一个以太网交换机相连。一般都工作在<mark>全双工方式</mark>。</li>
<li>以太网交换机具有并行性，能<mark>同时连通多对接口</mark>，使多对主机能同时通信，<mark>无碰撞</mark> (不使用CSMA&#x2F;CD协议)</li>
<li>以太网交换机一般都具有多种速率的接口，例如:10Mb&#x2F;s、100Mb&#x2F;s、1Gb&#x2F;s、10Gb&#x2F;s接口的多种组合</li>
<li>以太网交换机<mark>工作在数据链路层</mark> (也包括物理层)，它收到帧后，在帧交换表中<mark>查找帧的目的MAC地址所对应的接口号</mark>，然后通过该接口转发帧。</li>
<li>以太网交换机是一种即插即用设备，其内部的恢交换表是通过<mark>自学习算法</mark>自动地逐渐建立起来的。</li>
<li>帧的两种转发方式：<ol>
<li><strong>存储转发</strong></li>
<li><strong>直通交换</strong>：采用基于硬件的交叉矩阵 (交换时延非常小，但不检查帧是否右差错)</li>
</ol>
</li>
</ul>
<p><strong>多台主机同时给另一台主机发送单播帧：</strong></p>
<ul>
<li><p>集线器以太网：会产生碰撞，遭遇碰撞的帧会传播到总线上的各主机</p>
</li>
<li><p>交换机以太网：会将它们缓存起来，然后逐个转发给目的主机，不会产生碰撞</p>
</li>
</ul>
<h2 id="以太网交换机自学习和转发帧的流程"><a href="#以太网交换机自学习和转发帧的流程" class="headerlink" title="以太网交换机自学习和转发帧的流程"></a>以太网交换机自学习和转发帧的流程</h2><h3 id="基本概念-6"><a href="#基本概念-6" class="headerlink" title="基本概念"></a>基本概念</h3><ul>
<li>以太网交换机工作在<strong>数据链路层</strong> （也包括物理层）</li>
<li>以太网交换机收到帧后，在帧交换表中<strong>查找帧的目的MAC地址所对应的接口号</strong>，然后通过该接口转发帧.</li>
<li>以太网交换机是一种即插即用设备，刚上电启动时其内部的顿交换表是空的。随着网络中各主机间的通信，以太网交换机通过<mark>自学习算法</mark>自动<mark>逐渐建立起帧交换表</mark></li>
</ul>
<blockquote>
<p>🔴🟢🟡<strong>一句话总结：</strong></p>
<p>一开始以太网交换机是空的，那么当主机B去发送帧给主机C时，会先去帧交换表中查询目的MAC地址，如果存在该地址，那么就能明确地从该地址所对应的接口处转发该帧；</p>
<p>如果不存在该地址，那么就会进行盲目转发，给除了发送该帧进来的接口外的其他接口全部发送该帧，这些帧转发出去如果发现目的MAC地址与本地的MAC地址不一致就会丢弃该帧；</p>
<p>如果与本地的MAC地址一致就会接收该帧，返回确认帧的情况就跟上面类似了，也是先查表，查到就精确发送，查不到就盲目发送</p>
</blockquote>
<hr>
<p><strong>以下例子假设各主机知道网络中其他各主机的MAC地址（无需进行ARP）</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123211851067.png" alt="image-20231123211851067"></p>
<ul>
<li>帧交换表中的每条记录都有自己的<strong>有效时间</strong>，到期删除。原因如下：<ul>
<li>交换机的接口改接了另一台主机；</li>
<li>主机更换了网卡</li>
</ul>
</li>
</ul>
<p><strong>补充：</strong></p>
<p>如图的G-&gt;A的过程，G发送的帧在总线型以太网上会分别发送给A（<mark>发送成功并接收成功</mark>）和交换机1，但是交换机收到后，进行记录表后，<mark>发送目标接口与进来时的接口一致就不会再发送了，因为无意义。</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123213135319.png" alt="image-20231123213135319"></p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123211800769.png" alt="image-20231123211800769"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123211545673.png" alt="image-20231123211545673"></p>
<h2 id="以太网交换机的生成树协议STP"><a href="#以太网交换机的生成树协议STP" class="headerlink" title="以太网交换机的生成树协议STP"></a>以太网交换机的生成树协议STP</h2><h3 id="如何提高以太网的可靠性"><a href="#如何提高以太网的可靠性" class="headerlink" title="如何提高以太网的可靠性"></a>如何提高以太网的可靠性</h3><ul>
<li>添加<mark>冗余链路</mark>可以提高以太网的可靠性</li>
<li>但是，冗余链路也会带来负面效应——形成网络环路</li>
<li>网络环路会带来以下问题<ul>
<li><mark>广播风暴</mark><br>大量消耗网络资源，使得网络无法正常转发其他数据帧</li>
<li><mark>主机收到重复的广播顿</mark><br>大量消耗主机资源</li>
<li><mark>交换机的帧交换表震荡(漂移)</mark></li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123214653212.png" alt="image-20231123214653212"></p>
<h3 id="生成树协议STP"><a href="#生成树协议STP" class="headerlink" title="生成树协议STP"></a>生成树协议STP</h3><ul>
<li>以太网交换机使用<mark>生成树协议STP</mark>(Spanning Tree Protocol)可以在增加元余链路来提高网络可靠性的同时又<mark>避免网络环路带来的各种问题</mark>；</li>
<li>不论交换机之间采用怎样的物理连接，交换机都能够<mark>自动计算并构建一个逻辑上<strong>没有环路的网络</strong></mark>，其逻辑拓扑结构必须是树型的(无逻辑环路) ；</li>
<li>最终生成的树型逻辑拓扑<strong>要确保连通整个网络</strong>；</li>
<li>当首次连接交换机或网络物理拓扑发生变化时(有可能是人为改变或故障)，交换机都将进行<mark>生成树的重新计算</mark>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123214956562.png" alt="image-20231123214956562"></p>
<hr>
<h2 id="虚拟局域网VLAN"><a href="#虚拟局域网VLAN" class="headerlink" title="虚拟局域网VLAN"></a>虚拟局域网VLAN</h2><h3 id="为什么要虚拟局域网VLAN"><a href="#为什么要虚拟局域网VLAN" class="headerlink" title="为什么要虚拟局域网VLAN"></a>为什么要虚拟局域网VLAN</h3><p>巨大广播域的弊端：</p>
<ul>
<li>使用一个或多个以太网交换机互连起来的交换式以太网，其所有站点都属于同一个广播域</li>
<li>随着交换式以太网规模的扩大，广播域相应扩大</li>
<li>巨大的广播域会带来很多弊端<ul>
<li>广播风暴</li>
<li>难以管理和维护</li>
<li>潜在的安全问题</li>
</ul>
</li>
</ul>
<p><mark><strong>广播风暴会浪费网络资源和各主机的CPU资源!</strong></mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123220509612.png" alt="image-20231123220509612"></p>
<p><strong>分割广播域的方法：</strong></p>
<ul>
<li><p>使用路由器可以隔离广播域，但路由器的成本较高</p>
</li>
<li><p><mark>使用VLAN技术</mark></p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123220624181.png" alt="image-20231123220624181"></p>
<h3 id="VLAN基本概念"><a href="#VLAN基本概念" class="headerlink" title="VLAN基本概念"></a>VLAN基本概念</h3><p>如下图所示：用不同的VLAN分割开之后，就只能收到同一个VLAN组中的广播信号了。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123220755458.png" alt="image-20231123220755458"></p>
<ul>
<li><p>同一个VLAN内部可以广播通信，不同VLAN不可以广播通信</p>
</li>
<li><p><strong>虚拟局域网其实<mark>仅仅只是</mark>局域网给用户提供的<mark>一种服务</mark>，而并不是一种新型局域网。</strong></p>
</li>
</ul>
<h3 id="虚拟局域网VLAN的实现机制"><a href="#虚拟局域网VLAN的实现机制" class="headerlink" title="虚拟局域网VLAN的实现机制"></a>虚拟局域网VLAN的实现机制</h3><p>虚拟局域网VLAN技术是在交换机上实现的，需要交换机能够实现以下功能：</p>
<ol>
<li>能够处理带有VLAN标记的帧——IEEE 802.1 Q帧</li>
<li>交换机的各端口可以支持不同的端口类型，不同端口类型的端口对帧的处理方式有所不同</li>
</ol>
<p><strong>①对于第一点：</strong></p>
<ul>
<li>IEEE 802.1Q帧对以太网的MAC格式进行了扩展，<mark>插入了4字节的VLAN标记</mark></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123223855342.png" alt="image-20231123223855342"></p>
<ul>
<li><p>VLAN标记的最后12比特称为<mark>VLAN标识符VID</mark>，它唯一地标志了以太网帧属于哪一个VLAN。</p>
<ul>
<li>表示VLAN的VID的有效取值范围是 1~4094.</li>
</ul>
</li>
<li><p>802.1Q帧是由交换机来处理的，而不是用户主机来处理的（<mark><strong>即用户主机处理不了802.1Q帧，只能丢弃</strong></mark>）</p>
<ul>
<li>当交换机<mark>收到普通的以太网帧时</mark>，会将其插入4字节的VLAN标记转变为802.1Q，简称<mark>“打标签”</mark></li>
<li>当交换机<mark>转发802.1Q顿时</mark>，可能会删除其4字节VLAN标记转变为普通以太网帧，简称<mark>“去标签”</mark></li>
</ul>
</li>
</ul>
<p><strong>②对于第二点：</strong></p>
<p>交换机的端口类型有以下三种:</p>
<ol>
<li>Access</li>
<li>Trunk</li>
<li>Hybrid</li>
</ol>
<h4 id="Access端口"><a href="#Access端口" class="headerlink" title="Access端口"></a>Access端口</h4><p><mark><strong>交换机与用户计算机之间的互连</strong></mark></p>
<ul>
<li>Access端口一般用于连接用户计算机</li>
<li>Access端口只能属于一个VLAN</li>
<li>Access端口的PVID值与端口所属VLAN的ID相同(默认为1)</li>
<li>Access端口接收处理方法:<ul>
<li>一般只接受“未打标签”的普通以太网MAC帧。根据接收帧的端口的PVID给帧“<mark>打标签</mark>”，即插入4字节VLAN标记字段，字段中的VID取值与端口的PVID取值相等。</li>
</ul>
</li>
<li>Access端口发送处理方法<ul>
<li>若帧中的VID与端口的PVID相等，则“<mark>去标签</mark>”并转发该帧；否则不转发。</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123225022476.png" alt="image-20231123225022476"></p>
<h4 id="Trunk端口"><a href="#Trunk端口" class="headerlink" title="Trunk端口"></a>Trunk端口</h4><p><mark><strong>交换机之间或交换机与路由器之间的互连</strong></mark></p>
<ul>
<li>Trunk端口一般用于交换机之间或交换机与路由器之间的互连</li>
<li>Trunk端口可以属于多个VLAN</li>
<li>用户可以设置Trunk端口的PVID值。默认情况下，Trunk端口的PVID值为1。</li>
<li>Trunk端口发送处理方法<ul>
<li>对VID等于PVID的帧<mark>“去标签”再转发</mark></li>
<li>对VID不等于PVID的帧，<mark>直接转发</mark></li>
</ul>
</li>
<li>Trunk端口接收处理方法<ul>
<li>接收“未打标签”的帧，根据接收帧的端口的PVID给帧<mark>“打标签”</mark>，即插入4字节VLAN标记字段，字段中的VID取值与端口的PVID取值相等</li>
<li>接收“已打标签的帧”。</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123225429714.png" alt="image-20231123225429714"></p>
<p><strong>例题：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123225513451.png" alt="image-20231123225513451"></p>
<p><strong>结论：</strong></p>
<blockquote>
<p><strong>互连的Trunk端口的PVID值不等，可能会造成转发错误!</strong></p>
</blockquote>
<h4 id="Hybrid端口"><a href="#Hybrid端口" class="headerlink" title="Hybrid端口"></a>Hybrid端口</h4><p>华为交换机私有的Hybrid端口类型</p>
<p>基本特征上与Trunk端口类似，区别如下：</p>
<p>Hybrid端口发送处理方法 (与Trunk端口不同)：</p>
<ul>
<li>查看帧的VID是否在端口的“去标签”列表中:<ul>
<li>若存在，则“去标签”后再转发</li>
<li>若不存在，则直接转发</li>
</ul>
</li>
</ul>
<p>举例说明：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231123225702709.png" alt="image-20231123225702709"></p>
<h1 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h1><h2 id="网络层概述"><a href="#网络层概述" class="headerlink" title="网络层概述"></a>网络层概述</h2><p><strong>网络层要解决的问题：</strong></p>
<ul>
<li><p>标识各个网络以及各个网络中的各主机</p>
</li>
<li><p>路由器如何转发分组，路由器如何进行路由选择</p>
</li>
<li><p><strong>网络层的主要任务</strong>是<mark>实现网络互连</mark>，进而实现<strong>数据包在各网络之间的传输</strong>。</p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.3fzdhk9z0yg.webp" alt="image"></p>
<p><strong>实现网络层要解决的主要问题</strong></p>
<ol>
<li>网络层向运输层提供怎样的服务（“可靠传输”还是“不可靠传输”）</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/00ce2a4ae2e24bd697b3e993cb071a4a.1kcv7yn0vb8g.gif" alt="00ce2a4ae2e24bd697b3e993cb071a4a"></p>
<ol start="2">
<li>网络层寻址问题</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.3nlwnzrjep40.webp" alt="image"></p>
<blockquote>
<p>路由器收到数据后，是依据什么来决定将数据包从自己的哪个接口转发出去？</p>
<p><strong>依据数据包的目的地址和路由器中的路由表</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017135914985.png" alt="image-20201017135914985"></p>
<p>但在实际当中，路由器是怎样知道这些路由记录？</p>
<ul>
<li>由用户或网络管理员进行<mark>人工配置</mark>，这种方法只适用于规模较小且网络拓扑不改变的小型互联网</li>
<li><strong>另一种是实现各种路由选择协议，由路由器执行路由选择协议中所规定的<mark>路由选择算法</mark>，而<mark>自动得出路由表中的路由记录</mark>，这种方法更适合规模较大且网络拓扑经常改变的大型互联网</strong></li>
</ul>
</blockquote>
<ol start="3">
<li>路由选择问题</li>
</ol>
<h2 id="网络层提供的两种服务"><a href="#网络层提供的两种服务" class="headerlink" title="网络层提供的两种服务"></a>网络层提供的两种服务</h2><ul>
<li>在计算机网络领域，网络层应该向运输层提供怎样的服务（“<strong>面向连接</strong>”还是“<strong>无连接</strong>”）曾引起了长期的争论。</li>
<li>争论焦点的实质就是：<strong>在计算机通信中，可靠交付应当由谁来负责</strong>？是<strong>网络</strong>还是<strong>端系统</strong>？</li>
</ul>
<h3 id="面向连接的虚电路服务"><a href="#面向连接的虚电路服务" class="headerlink" title="面向连接的虚电路服务"></a>面向连接的虚电路服务</h3><p><strong>一种观点：让网络负责可靠交付</strong></p>
<ul>
<li>这种观点认为，应借助于电信网的成功经验，让网络负责可靠交付，计算机网络应模仿电信网络，使用<strong>面向连接</strong>的通信方式。</li>
<li>通信之前先建立<strong>虚电路</strong> (Virtual Circuit)，以保证双方通信所需的一切网络资源。 </li>
<li>如果再使用可靠传输的网络协议，就可使所发送的分组无差错按序到达终点，不丢失、不重复。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017141425892.png" alt="image-20201017141425892"></p>
<p><strong>发送方</strong> 发送给 <strong>接收方</strong> 的所有分组都沿着同一条虚电路传送</p>
<blockquote>
<ul>
<li>虚电路表示这只是一条<strong>逻辑上的连接</strong>，分组都沿着这条逻辑连接按照存储转发方式传送，而并不是真正建立了一条物理连接。</li>
<li>请注意，电路交换的电话通信是先建立了一条真正的连接。</li>
<li>因此分组交换的虚连接和电路交换的连接只是类似，但并不完全一样</li>
</ul>
</blockquote>
<h3 id="无连接的数据报服务"><a href="#无连接的数据报服务" class="headerlink" title="无连接的数据报服务"></a>无连接的数据报服务</h3><p><strong>另一种观点：网络提供数据报服务</strong></p>
<ul>
<li>互联网的先驱者提出了一种崭新的网络设计思路。</li>
<li>网络层向上只提供简单灵活的、<strong>无连接的</strong>、<strong>尽最大努力交付</strong>的<strong>数据报服务</strong>。</li>
<li>网络在发送分组时不需要先建立连接。每一个分组（即 IP 数据报）独立发送，与其前后的分组无关（不进行编号）。</li>
<li><strong>网络层不提供服务质量的承诺</strong>。即所传送的分组可能出错、丢失、重复和失序（不按序到达终点），当然也不保证分组传送的时限。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017141851030.png" alt="image-20201017141851030"></p>
<p><strong>发送方</strong> 发送给 <strong>接收方</strong> 的分组可能沿着不同路径传送</p>
<blockquote>
<p><strong>尽最大努力交付</strong></p>
<ul>
<li>如果主机（即端系统）中的进程之间的通信需要是可靠的，那么就由网络的<strong>主机中的运输层负责可靠交付（包括差错处理、流量控制等）</strong> 。</li>
<li><strong>采用这种设计思路的好处是</strong>：网络的造价大大降低，运行方式灵活，能够适应多种应用。</li>
<li>互连网能够发展到今日的规模，充分证明了当初采用这种设计思路的正确性。</li>
</ul>
</blockquote>
<h3 id="虚电路服务与数据报服务的对比"><a href="#虚电路服务与数据报服务的对比" class="headerlink" title="虚电路服务与数据报服务的对比"></a>虚电路服务与数据报服务的对比</h3><table>
<thead>
<tr>
<th><strong>对比的方面</strong></th>
<th><strong>虚电路服务</strong></th>
<th><strong>数据报服务</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>思路</strong></td>
<td><strong>可靠通信应当由网络来保证</strong></td>
<td><strong>可靠通信应当由用户主机来保证</strong></td>
</tr>
<tr>
<td><strong>连接的建立</strong></td>
<td><strong>必须有</strong></td>
<td><strong>不需要</strong></td>
</tr>
<tr>
<td><strong>终点地址</strong></td>
<td><strong>仅在连接建立阶段使用，每个分组使用短的虚电路号</strong></td>
<td><strong>每个分组都有终点的完整地址</strong></td>
</tr>
<tr>
<td><strong>分组的转发</strong></td>
<td><strong>属于同一条虚电路的分组均按照同一路由进行转发</strong></td>
<td><strong>每个分组独立选择路由进行转发</strong></td>
</tr>
<tr>
<td><strong>当结点出故障时</strong></td>
<td><strong>所有通过出故障的结点的虚电路均不能工作</strong></td>
<td><strong>出故障的结点可能会丢失分组，一些路由可能会发生变化</strong></td>
</tr>
<tr>
<td><strong>分组的顺序</strong></td>
<td><strong>总是按发送顺序到达终点</strong></td>
<td><strong>到达终点时不一定按发送顺序</strong></td>
</tr>
<tr>
<td><strong>端到端的差错处理和流量控制</strong></td>
<td><strong>可以由网络负责，也可以由用户主机负责</strong></td>
<td><strong>由用户主机负责</strong></td>
</tr>
</tbody></table>
<h2 id="IPv4"><a href="#IPv4" class="headerlink" title="IPv4"></a>IPv4</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><ul>
<li><p><mark>IPv4地址</mark>就是给因特网（Internet）上的<mark>每一台主机 (或路由器)的每一个接口</mark>分配一个在全世界范围内是<mark>唯一的32比特的标识符</mark>。</p>
</li>
<li><p>IPv4地址的编址方法经历了如下三个历史阶段：</p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124154837302.png" alt="image-20231124154837302"></p>
<ul>
<li>32比特的IPv4地址不方便阅读、记录以及输入等，因此IPv4地址采用<mark>点分十进制表示方法</mark>以方便用户使用。</li>
</ul>
<h3 id="分类编制的IPv4地址"><a href="#分类编制的IPv4地址" class="headerlink" title="分类编制的IPv4地址"></a>分类编制的IPv4地址</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017144317166.png" alt="image-20201017144317166"></p>
<ul>
<li>每一类地址都由两个固定长度的字段组成，其中一个字段是<strong>网络号 net-id</strong>，它标志主机（或路由器）所连接到的网络，而另一个字段则是<strong>主机号 host-id</strong>，它标志该主机（或路由器）。</li>
<li>主机号在它前面的网络号所指明的网络范围内必须是唯一的。</li>
<li>由此可见，<strong>一个 IP 地址在整个互联网范围内是唯一的</strong>。</li>
</ul>
<p><strong>A类地址</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017145210533.png" alt="image-20201017145210533"></p>
<p><strong>B类地址</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017145508001.png" alt="image-20201017145508001"></p>
<p><strong>C类地址</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017150204774.png" alt="image-20201017150204774"></p>
<p><strong>练习</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017150543386.png" alt="image-20201017150543386"></p>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><p><strong>IP 地址的指派范围</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124163033439.png" alt="image-20231124163033439"></p>
<p><strong>一般不使用的特殊的 IP 地址</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017152959586.png" alt="image-20201017152959586"></p>
<p><strong>IP 地址的一些重要特点</strong></p>
<ol>
<li><strong>IP 地址是一种分等级的地址结构</strong>。分两个等级的好处是：</li>
</ol>
<ul>
<li><strong>第一</strong>，IP 地址管理机构在分配 IP 地址时只分配网络号，而剩下的主机号则由得到该网络号的单位自行分配。这样就方便了 IP 地址的管理。</li>
<li><strong>第二</strong>，路由器仅根据目的主机所连接的网络号来转发分组（而不考虑目的主机号），这样就可以使路由表中的项目数大幅度减少，从而减小了路由表所占的存储空间。</li>
</ul>
<ol start="2">
<li><strong>实际上 IP 地址是标志一个主机（或路由器）和一条链路的接口</strong>。</li>
</ol>
<ul>
<li>当一个主机同时连接到两个网络上时，该主机就必须同时具有两个相应的 IP 地址，其网络号 net-id 必须是不同的。这种主机称为<strong>多归属主机</strong> (multihomed host)。</li>
<li>由于一个路由器至少应当连接到两个网络（这样它才能将 IP 数据报从一个网络转发到另一个网络），因此<strong>一个路由器至少应当有两个不同的 IP 地址</strong>。</li>
</ul>
<ol start="3">
<li><p><strong>用转发器或网桥连接起来的若干个局域网仍为一个网络</strong>，因此这些局域网都具有同样的网络号 net-id。</p>
</li>
<li><p><strong>所有分配到网络号 net-id 的网络，无论是范围很小的局域网，还是可能覆盖很大地理范围的广域网，都是平等的。</strong></p>
</li>
</ol>
<h3 id="划分子网的IPv4地址"><a href="#划分子网的IPv4地址" class="headerlink" title="划分子网的IPv4地址"></a>划分子网的IPv4地址</h3><h4 id="为什么要划分子网"><a href="#为什么要划分子网" class="headerlink" title="为什么要划分子网"></a>为什么要划分子网</h4><p>在 ARPANET 的早期，IP 地址的设计确实不够合理：</p>
<ul>
<li>IP 地址空间的<mark>利用率有时很低</mark>。 </li>
<li>给每一个物理网络分配一个网络号会使<strong>路由表变得太大</strong>因而使<mark>网络性能变坏</mark>。 </li>
<li>两级的 IP 地址<mark>不够灵活</mark>。</li>
</ul>
<p>如果想要将原来的网络划分成三个独立的网路：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017154852896.png" alt="image-20201017154852896"></p>
<p>所以是否可以<mark><strong>从主机号部分借用一部分作为子网号</strong></mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017155026814.png" alt="image-20201017155026814"></p>
<blockquote>
<p>但是如果未在图中标记子网号部分，那么我们和计算机又如何知道分类地址中主机号有多少比特被用作子网号了呢？</p>
<p>所以就有了划分子网的工具：<strong>子网掩码</strong></p>
<ul>
<li>从 1985 年起在 IP 地址中又增加了一个“<strong>子网号字段</strong>”，使两级的 IP 地址变成为<strong>三级的 IP 地址</strong>。</li>
<li>这种做法叫做<strong>划分子网</strong> (subnetting) 。</li>
<li>划分子网已成为互联网的正式标准协议。</li>
</ul>
</blockquote>
<h4 id="如何划分子网"><a href="#如何划分子网" class="headerlink" title="如何划分子网"></a>如何划分子网</h4><p>基本思路</p>
<ul>
<li>划分子网纯属一个<strong>单位内部的事情</strong>。单位对外仍然表现为没有划分子网的网络。</li>
<li>从主机号<strong>借用</strong>若干个位作为<strong>子网号</strong> subnet-id，而主机号 host-id 也就相应减少了若干个位。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017155930011.png" alt="image-20201017155930011"></p>
<ul>
<li>凡是从其他网络发送给本单位某个主机的 IP 数据报，仍然是根据 IP 数据报的<strong>目的网络号</strong> net-id，先找到连接在本单位网络上的路由器。</li>
<li>然后<strong>此路由器</strong>在收到 IP 数据报后，再按<strong>目的网络号</strong> net-id 和<strong>子网号</strong> subnet-id 找到目的子网。</li>
<li>最后就将 IP 数据报直接交付目的主机。</li>
</ul>
<p>划分为三个子网后对外仍是一个网络</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017160116239.png" alt="image-20201017160116239"></p>
<blockquote>
<ul>
<li><strong>优点</strong><ol>
<li>减少了 IP 地址的浪费</li>
<li>使网络的组织更加灵活</li>
<li>更便于维护和管理</li>
</ol>
</li>
<li><strong>划分子网纯属一个单位内部的事情，对外部网络透明</strong>，对外仍然表现为没有划分子网的一个网络。</li>
</ul>
</blockquote>
<h4 id="子网掩码"><a href="#子网掩码" class="headerlink" title="子网掩码"></a>子网掩码</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017160252066.png" alt="image-20201017160252066"></p>
<blockquote>
<p><strong>(IP 地址) AND (子网掩码) &#x3D; 网络地址</strong> 重要，下面很多相关知识都会用到</p>
</blockquote>
<p>举例：</p>
<p>例子1：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017161651058.png" alt="image-20201017161651058"></p>
<p>例子2</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017161719339.png" alt="image-20201017161719339"></p>
<p><strong>例题：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124175138343.png" alt="image-20231124175138343"></p>
<p><strong>默认子网掩码：</strong></p>
<p><mark>默认的子网掩码是指在<strong>未划分子网的情况下</strong>使用的子网掩码。</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124175338752.png" alt="image-20231124175338752"></p>
<h4 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017162938612.png" alt="image-20201017162938612"></p>
<blockquote>
<ul>
<li>子网掩码是一个网络或一个子网的重要属性。</li>
<li>路由器在和相邻路由器交换路由信息时，必须把自己所在网络（或子网）的子网掩码告诉相邻路由器。</li>
<li>路由器的路由表中的每一个项目，除了要给出目的网络地址外，还必须同时给出该网络的子网掩码。</li>
<li>若一个路由器连接在两个子网上，就拥有两个网络地址和两个子网掩码。</li>
</ul>
</blockquote>
<h3 id="无分类编址的IPv4地址"><a href="#无分类编址的IPv4地址" class="headerlink" title="无分类编址的IPv4地址"></a>无分类编址的IPv4地址</h3><h4 id="为什么使用无分类编址"><a href="#为什么使用无分类编址" class="headerlink" title="为什么使用无分类编址"></a>为什么使用无分类编址</h4><ul>
<li><p>划分子网在一定程度上缓解了因特网在发展中遇到的困难，但是<strong>数量巨大的C类网因为其地址空间太小并没有得到充分使用</strong>，而因特网的IP地址仍在加速消耗，整个<mark>IPv4地址空间面临全部耗尽的威胁</mark>。</p>
</li>
<li><p><mark>CIDR消除了传统的A类、B类和C类地址，以及划分子网的概念</mark></p>
</li>
<li><p><mark>CIDR可以更加有效地分配IPv4的地址空间</mark>，并且可以在新的IPv6使用之前允许因特网的规模继续增长。</p>
</li>
</ul>
<blockquote>
<p><strong>CIDR 最主要的特点</strong></p>
<ul>
<li>CIDR使用各种长度的“<strong>网络前缀</strong>”(network-prefix)来代替分类地址中的网络号和子网号。</li>
<li><strong>IP 地址从三级编址（使用子网掩码）又回到了两级编址</strong>。</li>
</ul>
</blockquote>
<h4 id="如何使用无分类编址"><a href="#如何使用无分类编址" class="headerlink" title="如何使用无分类编址"></a>如何使用无分类编址</h4><ul>
<li>CIDR使用“<mark>斜线记法</mark>”，或称CIDR记法。即在IPv4地址后面加上斜线“&#x2F;”，<mark>在斜线后面写上网络前缀所占的比特数量</mark>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124200743238.png" alt="image-20231124200743238"></p>
<ul>
<li><p>CIDR实际上是<mark>将网络前缀都相同的连续的IP地址组成一个<strong>CIDR地址块</strong></mark>。</p>
</li>
<li><p>我们只要知道CIDR地址块中的任何一个地址，就可以知道该地址块的全部细节</p>
<ul>
<li>地址块的最小地址</li>
<li>地址块的最大地址</li>
<li>地址块中的地址数量</li>
<li>地址块聚合某类网络(A类、B类或C类)的数量</li>
</ul>
<blockquote>
<p>解释地址块聚合C类网络：CIDR块中的IP地址可以划分为多个C类网，每个C类网包含2^8^个IP地址。所以，我们将主机数量除以2^8^，得到C类网的数量。</p>
</blockquote>
<ul>
<li>地址掩码(也可继续称为子网掩码)</li>
</ul>
</li>
</ul>
<p>举例：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017165113442.png" alt="image-20201017165113442"></p>
<h4 id="路由聚合（构造超网）"><a href="#路由聚合（构造超网）" class="headerlink" title="路由聚合（构造超网）"></a>路由聚合（构造超网）</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124201322773.png" alt="image-20231124201322773"></p>
<ul>
<li><mark>网络前缀越长，地址块越小，路由越具体；</mark></li>
<li>若路由器查表转发分组时发现有多条路由可选，则选择网络前缀最长的那条，这称为<mark>最长前缀匹配</mark><br>因为这样的路由更具体。</li>
</ul>
<p><strong>例题：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124201141275.png" alt="image-20231124201141275"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124200032872.png" alt="image-20231124200032872"></p>
<h4 id="总结-4"><a href="#总结-4" class="headerlink" title="总结"></a>总结</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201017170552495.png" alt="image-20201017170552495"></p>
<h3 id="IPv4地址的应用规划"><a href="#IPv4地址的应用规划" class="headerlink" title="IPv4地址的应用规划"></a>IPv4地址的应用规划</h3><p>给定一个IPv4地址快，如何将其划分成几个更小的地址块，并将这些地址块分配给互联网中不同网络，进而可以给各网络中的主机和路由器接口分配IPv4地址</p>
<h4 id="定长的子网掩码FLSM（Fixed-Length-Subnet-Mask）"><a href="#定长的子网掩码FLSM（Fixed-Length-Subnet-Mask）" class="headerlink" title="定长的子网掩码FLSM（Fixed Length Subnet Mask）"></a>定长的子网掩码FLSM（Fixed Length Subnet Mask）</h4><ul>
<li>使用<strong>同一个子网掩码</strong>来划分子网</li>
<li>子网划分方式不灵活：只能划分出2^n^个子网（n是从主机号部分借用的用来作为子网号的比特数量）</li>
<li>每个子网所分配的IP地址数量相同，容易造成IP地址浪费</li>
</ul>
<p><mark><strong>划分子网的IPv4就是定长的子网掩码</strong></mark></p>
<p>举例：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018140809079.png" alt="image-20201018140809079"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018140916631.png" alt="image-20201018140916631"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018141132446.png" alt="image-20201018141132446"></p>
<blockquote>
<p>通过上面步骤分析，就可以从子网1到8中任选5个分配给左图中的N1到N5</p>
<p><strong>采用定长的子网掩码划分，只能划分出2^n^个子网，其中n是从主机号部分借用的用来作为子网号的比特数量，每个子网所分配的IP地址数量相同</strong></p>
<p><strong>但是也因为每个子网所分配的IP地址数量相同，不够灵活，容易造成IP地址的浪费</strong></p>
</blockquote>
<h4 id="变长的子网掩码VLSM（Variable-Length-Subnet-Mask）"><a href="#变长的子网掩码VLSM（Variable-Length-Subnet-Mask）" class="headerlink" title="变长的子网掩码VLSM（Variable Length Subnet Mask）"></a>变长的子网掩码VLSM（Variable Length Subnet Mask）</h4><ul>
<li>使用<strong>不同的子网掩码</strong>来划分子网</li>
<li>子网划分方式灵活：可以按需分配</li>
<li>每个子网所分配的IP地址数量可以不同，尽可能减少对IP地址的浪费</li>
</ul>
<p><mark><strong>无分类编址的IPv4就是变长的子网掩码</strong></mark></p>
<p>举例：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018142333145.png" alt="image-20201018142333145"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018143344440.png" alt="image-20201018143344440"></p>
<h2 id="IP数据报的发送和转发过程⭐"><a href="#IP数据报的发送和转发过程⭐" class="headerlink" title="IP数据报的发送和转发过程⭐"></a>IP数据报的发送和转发过程⭐</h2><p>IP数据报的发送和转发过程包含以下两部分：</p>
<ul>
<li>主机发送IP数据报</li>
<li>路由器转发IP数据报</li>
</ul>
<blockquote>
<p>为了将重点放在TCP&#x2F;IP协议栈的网际层发送和转发IP数据报的过程上，在之后的举例中，我们<mark>忽略使用ARP协议来获取目的主机或路由器接口的MAC地址的过程以及以太网交换机自学习和转发帧的过程</mark>。</p>
</blockquote>
<h3 id="发送"><a href="#发送" class="headerlink" title="发送"></a>发送</h3><p>举例</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018151314019.png" alt="image-20201018151314019"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018150151171.png" alt="image-20201018150151171"></p>
<p>源主机如何知道目的主机是否与自己在同一个网络中，是直接交付，还是间接交付？</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018150223497.png" alt="image-20201018150223497"></p>
<blockquote>
<p>可以通过<strong>目的地址IP</strong>和<strong>源地址的子网掩码</strong>进行<strong>逻辑与运算</strong>得到<strong>目的网络地址</strong></p>
<ul>
<li>如果<strong>目的网络地址</strong>和<strong>源网络地址</strong> <strong>相同</strong>，就是<strong>在同一个网络</strong>中，属于<strong>直接交付</strong></li>
<li>如果<strong>目的网络地址</strong>和<strong>源网络地址</strong> <strong>不相同</strong>，就<strong>不在同一个网络</strong>中，属于<strong>间接交付</strong>，传输给主机所在网络的<strong>默认网关</strong>（路由器——下图会讲解）,由默认网关帮忙转发</li>
</ul>
</blockquote>
<p>主机C如何知道路由器R的存在？</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018145501063.png" alt="image-20201018145501063"></p>
<blockquote>
<p>用户为了让本网络中的主机能和其他网络中的主机进行通信，就必须给其指定本网络的一个路由器的接口，由该路由器帮忙进行转发，<strong>所指定的路由器</strong>，也被称为<strong>默认网关</strong></p>
<p>例如。路由器的接口0的IP地址192.168.0.128做为左边网络的默认网关</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018150029179.png" alt="image-20201018150029179"></p>
<blockquote>
<p>主机A会将该IP数据报传输给自己的默认网关，也就是图中所示的路由器接口0</p>
</blockquote>
<h3 id="转发"><a href="#转发" class="headerlink" title="转发"></a>转发</h3><p>路由器收到IP数据报后如何转发？</p>
<ul>
<li>检查IP数据报首部是否出错：<ul>
<li><mark>若出错，则直接丢弃</mark>该IP数据报并通告源主机</li>
<li>若没有出错，则进行转发</li>
</ul>
</li>
<li>根据IP数据报的目的地址在路由表中查找匹配的条目：<ul>
<li>若找到匹配的条目，则转发给条目中指示的吓一跳</li>
<li><mark>若找不到，则丢弃</mark>该数据报并通告源主机</li>
</ul>
</li>
</ul>
<p>假设IP数据报首部没有出错，路由器取出IP数据报首部各地址字段的值</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018151108989.png" alt="image-20201018151108989"></p>
<p>接下来路由器对该IP数据报进行查表转发</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018151528027.png" alt="image-20201018151528027"></p>
<blockquote>
<p>逐条检查路由条目，将目的地址与路由条目中的地址掩码进行逻辑与运算得到目的网络地址，然后与路由条目中的目的网络进行比较，如果相同，则这条路由条目就是匹配的路由条目，按照它的下一条指示，图中所示的也就是接口1转发该IP数据报</p>
</blockquote>
<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124214709877.png" alt="image-20231124214709877"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124214641496.png" alt="image-20231124214641496"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231124214527162.png" alt="image-20231124214527162"></p>
<h2 id="静态路由配置及其可能产生的路由环路问题"><a href="#静态路由配置及其可能产生的路由环路问题" class="headerlink" title="静态路由配置及其可能产生的路由环路问题"></a>静态路由配置及其可能产生的路由环路问题</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ul>
<li>静态路由配置是指用户或网络管理员使用路由器的相关命令给路由器<mark>人工配置路由表</mark><ul>
<li>这种人工配置方式简单、开销小。但<mark>不能及时适应网络状态 (流量、拓扑等)的变化</mark></li>
<li>一般只在小规模网络中采用。</li>
</ul>
</li>
<li>使用静态路由配置可能出现以下<mark>导致产生路由环路</mark>的错误<ul>
<li>配置错误</li>
<li>聚合了不存在的网络</li>
<li>网络故障</li>
</ul>
</li>
</ul>
<h3 id="路由相关配置"><a href="#路由相关配置" class="headerlink" title="路由相关配置"></a>路由相关配置</h3><h4 id="静态路由配置"><a href="#静态路由配置" class="headerlink" title="静态路由配置"></a>静态路由配置</h4><p>举例：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018160349375.png" alt="image-20201018160349375"></p>
<h4 id="默认路由"><a href="#默认路由" class="headerlink" title="默认路由"></a>默认路由</h4><p>举例：</p>
<p>默认路由可以被所有网络匹配，但路由匹配有优先级，<mark>默认路由是优先级最低的</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018160906284.png" alt="image-20201018160906284"></p>
<h4 id="特定主机路由"><a href="#特定主机路由" class="headerlink" title="特定主机路由"></a>特定主机路由</h4><p>举例：</p>
<p>有时候，我们可以给路由器添加针对某个主机的特定主机路由条目</p>
<p>一般用于网络管理人员对网络的管理和测试</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018161440257.png" alt="image-20201018161440257"></p>
<blockquote>
<p><strong>多条路由可选，匹配路由最具体的</strong></p>
</blockquote>
<h3 id="导致路由环路的原因"><a href="#导致路由环路的原因" class="headerlink" title="导致路由环路的原因"></a>导致路由环路的原因</h3><h4 id="静态路由配置错误"><a href="#静态路由配置错误" class="headerlink" title="静态路由配置错误"></a>静态路由配置错误</h4><p>举例：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018161542579.png" alt="image-20201018161542579"></p>
<p>假设将R2的路由表中第三条目录配置错了下一跳</p>
<p>这导致R2和R3之间产生了路由环路</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018162041966.png" alt="image-20201018162041966"></p>
<blockquote>
<p>解决办法：设置过期时间TTL</p>
</blockquote>
<h4 id="聚合了不存在的网络"><a href="#聚合了不存在的网络" class="headerlink" title="聚合了不存在的网络"></a>聚合了不存在的网络</h4><p>举例：</p>
<p>正常情况：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018162333671.png" alt="image-20201018162333671"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018162759562.png" alt="image-20201018162759562"></p>
<p>错误情况：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018163323343.png" alt="image-20201018163323343"></p>
<p>解决方法：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018163933715.png" alt="image-20201018163933715"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018164453398.png" alt="image-20201018164453398"></p>
<blockquote>
<p>解决办法：设置黑洞路由的下一跳为null0，这是路由器内部的虚拟接口，IP数据报进入它后就被丢弃</p>
</blockquote>
<h4 id="网络故障而导致路由环路"><a href="#网络故障而导致路由环路" class="headerlink" title="网络故障而导致路由环路"></a>网络故障而导致路由环路</h4><p>举例：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018164811811.png" alt="image-20201018164811811"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018164913684.png" alt="image-20201018164913684"></p>
<p>解决方法：</p>
<p><strong>添加故障的网络为黑洞路由</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018165122023.png" alt="image-20201018165122023"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201018165153517.png" alt="image-20201018165153517"></p>
<ul>
<li><p>假设一段时间后故障网络恢复了，R1又自动地得出了其接口0的直连网络的路由条目，针对该网络的黑洞网络会<strong>自动失效</strong></p>
</li>
<li><p>如果又故障，则<strong>生效</strong>该网络的黑洞网络</p>
</li>
</ul>
<h2 id="路由选择协议"><a href="#路由选择协议" class="headerlink" title="路由选择协议"></a>路由选择协议</h2><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><p><strong>两类路由选择：</strong></p>
<ol>
<li><p>静态路由选择</p>
<ul>
<li>由<mark>人工配置</mark>的网络路由、默认路由、特定主机路由，黑洞路由等都属于静态路由；</li>
<li>这种人工配置方式简单、开销小，但<mark>不能及时适应网络状态 (流量、拓扑等)的变化</mark>；</li>
<li>一般只在<mark>小规模网络</mark>中采用。</li>
</ul>
</li>
<li><p>动态路由选择</p>
<ul>
<li>路由器通过路由选择协议<mark>自动获取路由信息</mark></li>
<li>比较复杂、开销比较大。<mark>能较好地适应网络状态的变化</mark></li>
<li>适用于<mark>大规模网络</mark></li>
</ul>
</li>
</ol>
<p><strong>因特网所采用的路由选择协议的主要特点：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019134946971.png" alt="image-20201019134946971"></p>
<p><strong>因特网采用分层次的路由选择协议：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019135122326.png" alt="image-20201019135122326"></p>
<blockquote>
<p>自治系统之间的路由选择简称为<mark>域间路由选择</mark>，自治系统内部的路由选择简称为<mark>域内路由选择</mark></p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019135328925.png" alt="image-20201019135328925"></p>
<blockquote>
<p>域间路由选择使用外部网关协议EGP这个类别的路由选择协议</p>
<p>域内路由选择使用内部网关协议IGP这个类别的路由选择协议</p>
<p><strong>网关协议</strong>的名称可称为<strong>路由协议</strong></p>
</blockquote>
<p><strong>常见的路由选择协议：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019140009740.png" alt="image-20201019140009740"></p>
<p><strong>路由器的基本结构：</strong></p>
<p>路由器是一种具有多个输入端口，和输出端口的专用计算机，其任务是转发分组</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019140234652.png" alt="image-20201019140234652"></p>
<ul>
<li><p>路由选择处理机除了处理收到的路由报文外，还会<strong>周期性的给其他路由器发送自己所知道的路由信息</strong>。</p>
</li>
<li><p>路由器的各端口还应具有<strong>输入缓冲区和输出缓冲区</strong></p>
<ul>
<li>输入缓冲区用来暂存，新进入路由器，但还来不及处理的分组</li>
<li>输出缓冲区用来暂存，已经处理完毕，但还来不及发送的分组</li>
</ul>
</li>
<li><p>需要说明的是<mark>路由器的端口一般<strong>都</strong>具有输入和输出的功能</mark>。</p>
</li>
</ul>
<p>🌈<strong>补充：（关于路由表和转发表）</strong></p>
<blockquote>
<ul>
<li>路由表一般仅包含从目的网络到下一跳的映</li>
<li>路由表需要对网络拓扑变化的计算最优化</li>
<li><strong>转发表是从路由表得出的</strong></li>
<li>转发表的结构应当使查找过程最优化</li>
<li>本文不对路由表和转发表做详细的区分</li>
</ul>
</blockquote>
<h3 id="路由信息协议RIP"><a href="#路由信息协议RIP" class="headerlink" title="路由信息协议RIP"></a>路由信息协议RIP</h3><h4 id="基本概念-7"><a href="#基本概念-7" class="headerlink" title="基本概念"></a>基本概念</h4><ul>
<li>RIP使用<mark>跳数</mark>(Hop Count)作为度量(Metric)来<mark>衡量到达目的网络的距离</mark>。<ul>
<li>路由器到直连网络的距离定义为1。</li>
<li>路由器到非直连网络的距离定义为所经过的路由器数加1</li>
<li>允许一条路径最多只能包含15个路由器。<mark>“距离”等于16时相当于不可达</mark>，因此，RIP只适用于<mark>小型互联网</mark></li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125180054408.png" alt="image-20231125180054408"></p>
<ul>
<li>RIP认为<mark>好的路由</mark>就是“距离短”的路由，也就是<mark>所通过路由器数量最少的路由</mark></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125180146423.png" alt="image-20231125180146423"></p>
<ul>
<li>当到达同一目的网络有多条“距离相等”的路由时，可以进行<mark>等价负载均衡</mark></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125180243578.png" alt="image-20231125180243578"></p>
<p>RIP包含以下三个要点:</p>
<ol>
<li>和谁交换信息：仅和相邻路由器交换信息</li>
<li>交换什么信息：自己的路由表</li>
<li>何时交换信息：周期性交换(例如每30秒)</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125180409226.png" alt="image-20231125180409226"></p>
<h4 id="RIP的基本工作过程"><a href="#RIP的基本工作过程" class="headerlink" title="RIP的基本工作过程"></a>RIP的基本工作过程</h4><ol>
<li>路由器刚开始工作时，<strong>只知道自己到直连网络的距离为1</strong></li>
<li>每个路由器仅<strong>和<mark>相邻路由器周期性</mark>地交换并更新路由信息</strong></li>
<li>若干次交换和更新后，<strong>每个路由器都知道到达本AS内各网络的最短距离和下一跳地址</strong>，称为<mark>收敛</mark>。</li>
</ol>
<h4 id="RIP的路由条目的更新规则"><a href="#RIP的路由条目的更新规则" class="headerlink" title="RIP的路由条目的更新规则"></a>RIP的路由条目的更新规则</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019150412666-17009068811776.png" alt="image-20201019150412666"></p>
<p><strong>⭐⭐重点：</strong></p>
<ul>
<li>到达目的网络，相同下一跳，最新消息，更新</li>
<li>发现了新的网络，添加</li>
<li>到达目的网络，不同下一跳，新路由优势，更新</li>
<li>到达目的网络，不同下一跳，等价负载均衡</li>
<li>到达目的网络，不同下一跳，新路由劣势，不更新</li>
</ul>
<h4 id="路由环路问题"><a href="#路由环路问题" class="headerlink" title="路由环路问题"></a>路由环路问题</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019151332767.png" alt="image-20201019151332767"></p>
<p>解决办法：</p>
<ol>
<li>限制最大路径距离为15(16表示不可达)</li>
<li>当路由表发生变化时就立即发送更新报文 (即“触发更新”)，而不仅是周期性发送</li>
<li>让路由器记录收到某特定路由信息的接口，而不让同一路由信息再通过此接口向反方向传送 (即“水平分割”</li>
</ol>
<blockquote>
<p>但是，这些方法也不能完全解决“坏消息传播得慢”的问题，这是距离向量的本质决定</p>
</blockquote>
<h4 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h4><p>优点：</p>
<ol>
<li>实现简单，开销较小。</li>
</ol>
<p>缺点：</p>
<ol>
<li><p>RIP 限制了网络的规模，它能使用的最大距离为 15（16 表示不可达）。</p>
</li>
<li><p>路由器之间交换的路由信息是路由器中的完整路由表，因而随着网络规模的扩大，开销也就增加。</p>
</li>
<li><p>“坏消息传播得慢”，使更新过程的收敛时间过长。</p>
</li>
</ol>
<h4 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125181829111.png" alt="image-20231125181829111"></p>
<blockquote>
<p>本题中R3先通告完R2后，R2进行了修改为16，但是等R1定时发送周期报文后，因为R3没有发送给R1，所以R1认为可以通过R3访问网络，然后R1给R2发送报文后，因为<strong>到达目的网络，不同下一跳，新路由优势，更新</strong>的原则，那么R2就会认为可以从R1去访问到该网络，又R1到该网络的距离为2，则R2到该网络的距离为2+1&#x3D;3</p>
</blockquote>
<h3 id="开放最短路径优先OSPF"><a href="#开放最短路径优先OSPF" class="headerlink" title="开放最短路径优先OSPF"></a>开放最短路径优先OSPF</h3><blockquote>
<p><strong>注意</strong>：OSPF 只是一个协议的名字，它并不表示其他的路由选择协议不是“最短路径优先”。</p>
</blockquote>
<h4 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h4><ul>
<li>“最短路径优先”是因为使用了Dijkstra提出的<mark>最短路径算法</mark>SPF。</li>
<li>OSPF是<mark>基于链路状态</mark>的，而不像RIP那样是基于距离向量的。</li>
<li>OSPF采用SPF算法计算路由，从算法上保证了<mark>不会产生路由环路</mark></li>
<li>OSPF<strong>不限制网络规模</strong>，更新效率高，<mark>收敛速度快</mark></li>
<li>链路状态是指本路由器都<strong>和哪些路由器相邻</strong>，以及相应<strong>链路的“代价”</strong>(cost)<ul>
<li>“代价”用来表示费用、距离、时延、带宽，等等。这些都由网络管理人员来决定</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125211510009.png" alt="image-20231125211510009"></p>
<h4 id="问候（Hello）分组"><a href="#问候（Hello）分组" class="headerlink" title="问候（Hello）分组"></a>问候（Hello）分组</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019161653875.png" alt="image-20201019161653875"></p>
<blockquote>
<p>IP数据报首部中协议号字段的取值应为89，来表明IP数据报的数据载荷为OSPF分组</p>
</blockquote>
<h4 id="发送链路状态通告LSA"><a href="#发送链路状态通告LSA" class="headerlink" title="发送链路状态通告LSA"></a>发送链路状态通告LSA</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019162341151.png" alt="image-20201019162341151"></p>
<blockquote>
<p>洪泛法有点<strong>类似于广播</strong>，就是从一个接口进来，从其他剩余所有接口出去</p>
</blockquote>
<h4 id="链路状态数据库同步"><a href="#链路状态数据库同步" class="headerlink" title="链路状态数据库同步"></a>链路状态数据库同步</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019162933483.png" alt="image-20201019162933483"></p>
<p><strong>使用<mark>SPF算法</mark>计算出各自路由器到达其他路由器的最短路径</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019163148068.png" alt="image-20201019163148068"></p>
<h4 id="OSPF五种分组类型"><a href="#OSPF五种分组类型" class="headerlink" title="OSPF五种分组类型"></a>OSPF五种分组类型</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019163250129.png" alt="image-20201019163250129"></p>
<h4 id="OSPF的基本工作过程"><a href="#OSPF的基本工作过程" class="headerlink" title="OSPF的基本工作过程"></a>OSPF的基本工作过程</h4><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019163746254.png" alt="image-20201019163746254"></p>
<h4 id="邻居关系"><a href="#邻居关系" class="headerlink" title="邻居关系"></a>邻居关系</h4><p><strong>OSPF在多点接入网络中的路由器邻居关系建立</strong></p>
<p>如果不采用其他机制，将会产生大量的多播分组</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019164657606.png" alt="image-20201019164657606"></p>
<blockquote>
<p>若DR出现问题，则由BDR顶替DR</p>
</blockquote>
<h4 id="区域"><a href="#区域" class="headerlink" title="区域"></a>区域</h4><p><strong>为了使OSPF能够用于规模很大的网络，OSPF把一个自治系统再划分为若干个更小的范围，叫做区域（Area）</strong></p>
<ul>
<li><p>在该自治系统内，所有路由器都使用OSPF协议，OSPF将该自治系统再划分成4个更小的区域</p>
</li>
<li><p>每个区域都有一个32比特的区域标识符</p>
</li>
<li><p>主干区域的区域标识符必须为0，主干区域用于连通其他区域</p>
</li>
<li><p>其他区域的区域标识符不能为0且不相同</p>
</li>
<li><p>每个区域一般不应包含路由器超过200个</p>
</li>
<li><p>划分区域的好处就是，利用洪泛法交换链路状态信息局限于每一个区域而不是自治系统，这样减少整个网络上的通信量</p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019170100568.png" alt="image-20201019170100568"></p>
<h3 id="边界网关协议BGP"><a href="#边界网关协议BGP" class="headerlink" title="边界网关协议BGP"></a>边界网关协议BGP</h3><p>BGP（Border Gateway Protocol） 是<mark><strong>不同自治系统的路由器之间</strong>交换路由信息的协议</mark></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019191438399.png" alt="image-20201019191438399"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019191718506.png" alt="image-20201019191718506"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019191836397.png" alt="image-20201019191836397"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019192031087.png" alt="image-20201019192031087"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201019192059962.png" alt="image-20201019192059962"></p>
<p><strong>例题：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125213234464.png" alt="image-20231125213234464"></p>
<h2 id="IPv4数据报的首部格式⭐⭐"><a href="#IPv4数据报的首部格式⭐⭐" class="headerlink" title="IPv4数据报的首部格式⭐⭐"></a>IPv4数据报的首部格式⭐⭐</h2><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4qv9clittsi0.webp" alt="image"></p>
<p><strong>1.首部长度</strong></p>
<blockquote>
<p><strong>占4比特，表示IP数据报首部的长度</strong>。该字段的取值以<code>4字节</code>为单位。最小十进制取值为5，表示IP数据报首部只有20字节固定部分;最大十进制取值为15，表示IP数据报首部包含20字节固定部分和最大40字节可变部分。</p>
</blockquote>
<p><strong>2.可选字段</strong></p>
<blockquote>
<p><strong>长度从1个字节到40个字节不等</strong>。<code>用来支持排错、测量及安全等措施</code>。可选字段增加了IP数据报的功能,但这同时也使得IP数据报的首部长度成为可变的。这就增加了每一个路由器处理IP数据报的开销。实际上可选字段很少被使用。</p>
</blockquote>
<p><strong>3.填充字段</strong></p>
<blockquote>
<p><strong>确保首部长度为4字节的整数倍</strong>。使用<code>全0</code>进行填充。</p>
</blockquote>
<p><strong>4.区分服务</strong></p>
<blockquote>
<p><strong>占8比特，用来获得更好的服务。</strong></p>
</blockquote>
<p><strong>5.总长度</strong></p>
<blockquote>
<p><strong>占16比特</strong>，表示<code>IP数据报的总长度</code>(首部+数据载荷)。</p>
<p>最大取值为十进制的65535，以字节为单位。</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.ptm56r0ehn4.webp" alt="image"></p>
<p><strong>6.标识</strong></p>
<blockquote>
<p><strong>占16比特</strong>，属于同一个数据报的各分片数据报应该具有相同的标识。</p>
<p>IP软件维持一个计数器，每产生一个数据报，计数器值加1，并将此值赋给标识字段。</p>
</blockquote>
<p><strong>7.标志</strong></p>
<blockquote>
<p><strong>占3比特</strong>，<code>各比特含义如下</code>：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.1xqgdajia7c0.webp" alt="image"></p>
</blockquote>
<p><strong>8.片偏移</strong></p>
<blockquote>
<p><strong>占13比特</strong>，指出分片数据报的<code>数据载荷部分偏移</code>其在原数据报的位置<strong>有多少个单位</strong>。</p>
<p>片偏移以8个字节为单位。</p>
</blockquote>
<p><strong>9.生存时间TTL</strong></p>
<blockquote>
<p><strong>占8比特</strong>，最初<code>以秒为单位</code>，<strong>最大生存周期</strong>为<code>255秒</code>；</p>
</blockquote>
<p><strong>10.协议</strong></p>
<blockquote>
<p><strong>占8比特</strong>，指明IPv4数据报的数据部分是<code>何种协议数据单元</code>。</p>
<p>常用的一些协议和相应的协议字段值如下。</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.3rs9fh0g6xm0.webp" alt="image"></p>
</blockquote>
<p><strong>11.首部检验和</strong></p>
<blockquote>
<p><strong>占16比特</strong>，用来<code>检测首部</code>在传输过程中是否出现差错。比CRC检验码简单，称为<strong>因特网检验和</strong>。</p>
</blockquote>
<p><strong>12.源IP地址和目的IP地址</strong></p>
<blockquote>
<p><strong>各占32比特</strong>，用来填写发送该IP数据报的源主机的IP地址和接收该IP数据报的目的主机的IP地址。</p>
</blockquote>
<p>⭐⭐⭐⭐⭐<strong>例题：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125222036580.png" alt="image-20231125222036580"></p>
<hr>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125223015654.png" alt="image-20231125223015654"></p>
<p>第二小问：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125223134911.png" alt="image-20231125223134911"></p>
<p>第四小问：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231125223211334.png" alt="image-20231125223211334"></p>
<h2 id="网际控制报文协议ICMP"><a href="#网际控制报文协议ICMP" class="headerlink" title="网际控制报文协议ICMP"></a>网际控制报文协议ICMP</h2><h3 id="ICMP的作用"><a href="#ICMP的作用" class="headerlink" title="ICMP的作用"></a>ICMP的作用</h3><ul>
<li><mark>为了更有效地转发IP数据报和提高交付成功的机会</mark>，在网际层使用了<strong>网际控制报文协议ICMP。</strong></li>
<li>主机或路由器使用ICMP来发送差错报告报文和询问报文。</li>
<li>ICMP报文被封装在IP数据报中发送。</li>
</ul>
<h3 id="ICMP差错报告报文的种类"><a href="#ICMP差错报告报文的种类" class="headerlink" title="ICMP差错报告报文的种类"></a>ICMP差错报告报文的种类</h3><ol>
<li>终点不可达</li>
</ol>
<ul>
<li><mark><strong>当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。</strong></mark>具体可再根据ICMP的代码字段细分为目的网络不可达、目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种错误。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231126152729662.png" alt="image-20231126152729662"></p>
<ol start="2">
<li>源点抑制</li>
</ol>
<ul>
<li>当路由器或主机<mark><strong>由于拥塞而丢弃数据报时，就向源点发送源点抑制报文</strong></mark>，使源点知道应当把数据报的发送速率放慢。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231126152814243.png" alt="image-20231126152814243"></p>
<ol start="3">
<li>时间超过</li>
</ol>
<ul>
<li>当路由器收到一个目的IP地址不是自己的IP数据报，会将其生存时间TTL字段的值减1。</li>
<li>若结果不为0，则将该IP数据报转发出去，若结果为0，除丢弃该IP数据报外，还要<mark><strong>向源点发送时间超过报文</strong></mark></li>
<li>另外，当<strong>终点在预先规定的时间内不能收到一个数据报的全部数据报片时</strong>就把已收到的数据报片<strong>都丢弃</strong>，也会向源点发送时间超过报文。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231126152913751.png" alt="image-20231126152913751"></p>
<ol start="4">
<li>参数问题</li>
</ol>
<ul>
<li>当路由器或目的主机收到IP数据报后，根据其<mark><strong>首部中的检验和字段</strong></mark>发现首部在传输过程中出现了<strong>误码</strong>，就丢弃该数据报，并向源点发送参数问题报文。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20231126153116397.png" alt="image-20231126153116397"></p>
<ol start="5">
<li>改变路由（重定向）</li>
</ol>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.3nnaaiytnac0.webp" alt="image"></p>
<ul>
<li>以下情况<strong>不应发送ICMP差错报告报文：</strong><ul>
<li>对ICMP差错报告报文不再发送ICMP差错报告报文</li>
<li>对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文</li>
<li>对具有多播地址的数据报都不发送ICMP差错报告报文</li>
<li>对具有特殊地址(如127.0.0.0或0.0.0.0)的数据报不发送ICMP差错报告报文</li>
</ul>
</li>
</ul>
<h3 id="常用的ICMP询问报文"><a href="#常用的ICMP询问报文" class="headerlink" title="常用的ICMP询问报文"></a>常用的ICMP询问报文</h3><ol>
<li><strong>回送请求和回答</strong><ul>
<li>ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问。</li>
<li>收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文</li>
<li>这种询问报文用来<mark><strong>测试目的站是否可达</strong></mark>及了解其有关状态</li>
</ul>
</li>
<li><strong>时间戳请求和回答</strong><ul>
<li>ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间</li>
<li>在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从</li>
<li>1900年1月1日起到当前时刻一共有多少秒</li>
<li>这种询问报文<mark><strong>用来进行时钟同步和测量时间</strong></mark></li>
</ul>
</li>
</ol>
<h3 id="ICMP应用举例"><a href="#ICMP应用举例" class="headerlink" title="ICMP应用举例"></a>ICMP应用举例</h3><ol>
<li>分组网间探测PING</li>
</ol>
<p><strong>用来测试主机或路由器间的连通性</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.1ihbjy8iknr4.webp" alt="image"></p>
<ol start="2">
<li>跟踪路由traceroute</li>
</ol>
<p><strong>用来测试IP数据报从源主机到达目的主机主要经过哪些路由器</strong></p>
<blockquote>
<p>使用的是询问报文中的<strong>回送请求和回答</strong>和差错报文中的<strong>时间超过</strong></p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.5c7o7ylenas0.webp" alt="image"></p>
<h2 id="虚拟专用网VPN与网络地址转换NAT"><a href="#虚拟专用网VPN与网络地址转换NAT" class="headerlink" title="虚拟专用网VPN与网络地址转换NAT"></a>虚拟专用网VPN与网络地址转换NAT</h2><h3 id="虚拟专用网VPN"><a href="#虚拟专用网VPN" class="headerlink" title="虚拟专用网VPN"></a>虚拟专用网VPN</h3><ul>
<li>由于 <strong>IP 地址的紧缺</strong>，一个机构能够申请到的IP地址数往往远小于本机构所拥有的主机数。</li>
<li>考虑到<strong>互联网并不很安全</strong>，一个机构内也并不需要把所有的主机接入到外部的互联网。</li>
<li>假定在一个机构内部的计算机通信也是采用 TCP&#x2F;IP 协议，那么从原则上讲，对于这些仅在<strong>机构内部使用</strong>的计算机就可以由本机构<strong>自行分配其 IP 地址</strong>。</li>
</ul>
<ul>
<li>利用公用的因特网作为本机构各专用网之间的通信载体，这样的专用网又称为<mark>虚拟专用网</mark>。</li>
<li>使用私有地址。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.77f88i6a8780.webp" alt="image"></p>
<ul>
<li><strong>根据具体用途有所不同</strong>，可分为：<mark>内联网VPN、外联网VPN、远程接入VPN</mark>。</li>
</ul>
<ol>
<li>内联网VPN</li>
</ol>
<p>同一机构内不同部门的内部网络所构成的虚拟专用网VPN又称为内联网VPN。</p>
<ol start="2">
<li>外联网VPN</li>
</ol>
<p>有时一个机构的VPN需要有某些外部机构(通常就是合作伙伴)参加进来。这样的VPN就称为外联网VPN。</p>
<ol start="3">
<li>远程接入VPN</li>
</ol>
<p>在外地工作的员工需要访问公司内部的专用网络时,只要在任何地点接入到因特网,运行驻留在员工PC中的VPN软件，在员工的PC和公司的主机之间建立VPN隧道,即可访问专用网络中的资源。这种VPN称为远程接入VPN。</p>
<blockquote>
<p>私有地址只能用于一个机构的内部通信，而不能用于和因特网上的主机通信</p>
<p>私有地址只能用作本地地址而不能用作全球地址</p>
<p>因特网中所有路由器对目的地址是私有地址的IP数据报一律不进行转发</p>
<p><strong>本地地址与全球地址</strong></p>
<ul>
<li><strong>本地地址</strong>——仅在机构内部使用的 IP 地址，可以由本机构自行分配，而不需要向互联网的管理机构申请。</li>
<li><strong>全球地址</strong>——全球唯一的 IP 地址，必须向互联网的管理机构申请。 </li>
<li><strong>问题</strong>：在内部使用的本地地址就有可能和互联网中某个 IP 地址重合，这样就会出现地址的二义性问题。</li>
</ul>
</blockquote>
<p>所以部门A和部门B至少需要一个 路由器具有合法的全球IP地址，这样各自的专用网才能利用公用的因特网进行通信</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201020000618797.png" alt="image-20201020000618797"></p>
<p>部门A向部门B发送数据流程</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201020001107425.png" alt="image-20201020001107425"></p>
<blockquote>
<p>两个专用网内的主机间发送的数据报是通过了公用的因特网，但在效果上就好像是在本机构的专用网上传送一样</p>
<p>数据报在因特网中可能要经过多个网络和路由器，但从逻辑上看，R1和R2之间好像是一条直通的点对点链路</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201020001528569.png" alt="image-20201020001528569"></p>
<p>因此也被称为IP隧道技术</p>
</blockquote>
<h3 id="网络地址转换NAT"><a href="#网络地址转换NAT" class="headerlink" title="网络地址转换NAT"></a>网络地址转换NAT</h3><ul>
<li><p>虽然因特网采用了无分类编址方式来减缓IPv4地址空间耗尽的速度，但<strong>由于因特网用户数目的激增</strong>，特别是大量小型办公室网络和家庭网络接入因特网的需求不断增加，<strong>IPv4地址空间</strong>即将面临耗尽的危险仍然没有被解除。</p>
</li>
<li><p>1994年提出了一种<strong>网络地址转换NAT的方法</strong>再次缓解了IPv4地址空间即将耗尽的问题。</p>
<p>NAT能使大量使用<strong>内部专用地址</strong>的<strong>专用网络</strong>用户共享少量外部全球地址来访问因特网上的主机和资源。</p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.18qzhvvvlxvk.webp" alt="image"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.1r0bxwhrjrgg.webp" alt="image"></p>
<ul>
<li>用一个全球IP地址就可以使多个拥有本地地址的主机同时和因特网上的主机进行通信。这种将端口号和IP地址一起进行转换的技术叫作<code>网络地址与端口号转换NAPT</code>(Network Address and Port Translation)。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.5g0c9qkgacg0.webp" alt="image"></p>
<p><strong>⭐注意：对于一些P2P网络应用，需要外网主机主动与内网主机进行通信</strong>，在通过NAT时会遇到问题，需要网络应用自己使用一些特殊的<code>NAT穿越技术</code>来解决问题。</p>
<p>另外，由于<strong>NAT</strong>对外网屏蔽了内网主机的<strong>网络地址</strong>，能为内网的主机提供一定的<code>安全保护</code>。</p>
<h1 id="运输层"><a href="#运输层" class="headerlink" title="运输层"></a>运输层</h1><h2 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h2><p>要解决的问题：</p>
<ul>
<li>解决进程之间基于网络的通信功能</li>
<li>传输出现错误的时候，如何处理</li>
</ul>
<hr>
<ul>
<li>之前所了解到的<strong>物理层、数据链路层以及网络层</strong>，它们共同解决了<strong>将主机通过异构网络互联起来</strong>所面临的问题，实现了<mark>主机到主机的通信</mark>。</li>
</ul>
<ul>
<li><p>但实际上在计算机网络中进行通信的<mark>真正实体</mark>是位于<strong>通信两端主机中的进程</strong>。</p>
</li>
<li><p>如何为运行在不同主机上的应用进程提供直接的通信服务是<strong>运输层的任务</strong>，运输层协议又称为<mark>端到端协议</mark>。</p>
</li>
</ul>
<h2 id="运输层端口号、复用与分用的概念"><a href="#运输层端口号、复用与分用的概念" class="headerlink" title="运输层端口号、复用与分用的概念"></a>运输层端口号、复用与分用的概念</h2><ul>
<li>运行在计算机上的进程使用<strong>进程标识符</strong><code>PID</code>来标志。</li>
<li>因特网上的计算机并不是使用统一的操作系统，不同的操作系统(windows, Linux, Mac OS)又使用不同格式的进程标识符。</li>
<li>为了使运行<strong>不同操作系统的计算机的应用进程之间</strong>能够进行网络通信，就必须使用<strong>统一的方法对TCP&#x2F;IP体系的应用进程进行标识</strong>。</li>
</ul>
<hr>
<ul>
<li><p><strong>TCP&#x2F;IP体系的运输层</strong>使用<mark>端口号</mark>来区分应用层的不同应用进程。</p>
</li>
<li><p>端口号使用16比特表示, 取值范围0~65535;</p>
<ul>
<li><p>端口号只具有本地意义，即端口号只是为了标识本计算机应用层中的各进程，在因特网中，不同计算机中的相同端口号是没有联系的。</p>
<ul>
<li><strong>熟知端口号</strong>:0~1023，IANA把这些端口号指派给了TCP&#x2F;IP体系中最重要的一些应用协议，例如:FTP使用21&#x2F;20，HTTP使用80，DNS使用53。</li>
<li><strong>登记端口号</strong>:1024~49151，为没有熟知端口号的应用程序使用。使用这类端口号必须在IANA按照规定的手续登记，以防止重复。例如: Microsoft RDP微软远程桌面使用的端口是3389。</li>
<li><strong>短暂端口号</strong>:49152~65535，留给客户进程选择暂时使用。当服务器进程收到客户进程的报文时，就知道了客户进程所使用的动态端。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>发送方</strong>的<mark>复用</mark>和<strong>接收方</strong>的<mark>分用</mark></p>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.3kewg9zvtcq0.webp" alt="image"></p>
<blockquote>
<p><strong>多个进程（这里一个端口表示一个进程）</strong> 利用一个运输层协议（或者称为运输层接口）<strong>发送</strong>数据称为 <strong>复用</strong></p>
<p><strong>多个进程（这里一个端口表示一个进程）</strong> 利用一个运输层协议（或者称为运输层接口）<strong>接收</strong>时叫做  <strong>分用</strong>。</p>
</blockquote>
<ul>
<li><strong>TCP&#x2F;IP体系的应用层常用协议</strong>所使用的<mark>运输层熟知端口号</mark></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.4r06l2f4lyg0.webp" alt="image"></p>
<h2 id="UDP和TCP的对比"><a href="#UDP和TCP的对比" class="headerlink" title="UDP和TCP的对比"></a>UDP和TCP的对比</h2><ul>
<li><mark>UDP和TCP</mark>是<strong>TCP&#x2F;IP体系结构运输层中</strong>的<strong>两个重要协议</strong></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.1aja6sjf1wsg.webp" alt="image"></p>
<ul>
<li>当运输层采用面向连接的 <strong>TCP</strong> 协议时，尽管下面的网络是不可靠的（只提供尽最大努力服务），但这种逻辑通信信道就相当于一条<strong>全双工的可靠信道</strong>。</li>
<li>当运输层采用无连接的 <strong>UDP</strong> 协议时，这种逻辑通信信道是一条<strong>不可靠信道</strong>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.1mc21iy1ld4w.webp" alt="image"></p>
<h2 id="TCP的流量控制"><a href="#TCP的流量控制" class="headerlink" title="TCP的流量控制"></a>TCP的流量控制</h2><ul>
<li>一般来说，我们总是希望<code>数据传输</code>得更快一些。</li>
<li>但如果发送方把数据发送得过快，接收方就可能来不及接收，这就会造成数据的丢失。</li>
<li>所谓<code>流量控制(flow control)</code>就是<strong>让发送方的发送速率不要太快，要让接收方来得及接收</strong>。</li>
<li>流量控制怎么更好地实现？<ul>
<li>利用<code>滑动窗口机制</code>可以很方便地在TCP连接上实现对发送方的流量控制。</li>
<li>TCP接收方利用自己的接收窗口的大小来限制发送方发送窗口的大小。</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.2data3orpc2s.webp" alt="image"></p>
<ul>
<li>TCP发送方收到接收方的零窗口通知后，应启动<mark>持续计时器</mark>。持续计时器超时后，向接收方发送<mark>零窗口探测报文</mark>。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.1383702862lc.webp" alt="image"></p>
<blockquote>
<p>上图如果零窗口探测报文在发送过程中如果丢失，还是能打破死锁局面</p>
<p>因为零窗口探测报文段也有重传计时器，重传计时器超时后，零窗口探测报文段会被重传</p>
</blockquote>
<h2 id="TCP的拥塞控制"><a href="#TCP的拥塞控制" class="headerlink" title="TCP的拥塞控制"></a>TCP的拥塞控制</h2><ul>
<li>在某段时间,若对<strong>网络中某一资源的需求超过了该资源所能提供的可用部分网络性能就要变坏</strong>。这种情况就叫做<strong>拥塞</strong>(congestion)。</li>
<li>在计算机网络中的链路容量(即带宽)、交换结点中的缓存和处理机等，都是网络的资源。</li>
<li>若出现拥塞而不进行控制，整个网络的吞吐量将随输入负荷的增大而下降。</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.2rhjnsq8mt20.webp" alt="image"></p>
<h3 id="拥塞窗口与状态变量"><a href="#拥塞窗口与状态变量" class="headerlink" title="拥塞窗口与状态变量"></a>拥塞窗口与状态变量</h3><ul>
<li>发送方维护一个叫做拥塞窗口cwnd的状态变量，其值取决于网络的拥塞程度，并且动态变化。<ul>
<li>拥塞窗口cwnd的维护原则：只要网络没有出现拥塞，拥塞窗口就再增大一些;但只要网络出现拥塞，拥塞窗口就减少一些。</li>
<li>判断出现网络拥塞的依据：没有按时收到应当到达的确认报文(即发生超时重传)。</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.295xorkv93i8.webp" alt="image"></p>
<ul>
<li>发送方将<code>拥塞窗口</code>作为发送窗口swnd，即<strong>swnd&#x3D; cwnd</strong>。</li>
<li>维护一个慢开始门限<code>ssthresh状态变量</code>:<ul>
<li>当<code>cwnd &lt; ssthresh</code>时，使用<strong>慢开始算法</strong>:</li>
<li>当<code>cwnd &gt; ssthresh</code>时，停止使用慢开始算法而<strong>改用拥塞避免算法</strong>;</li>
<li>当<code>cwnd = ssthresh</code>时，既<strong>可使用慢开始算法，也可使用拥塞避免算法</strong>。</li>
</ul>
</li>
</ul>
<blockquote>
<p>慢开始算法指的是每经过一个传输轮次，拥塞窗口就加倍，窗口大小按<strong>指数增加</strong>，2的n-1次方</p>
</blockquote>
<blockquote>
<p>拥塞避免算法每经过一个传输轮次，拥塞窗口 <strong>cwnd &#x3D; cwnd + 1</strong>。使拥塞窗口 cwnd 按线性规律缓慢增长。</p>
</blockquote>
<hr>
<blockquote>
<p>慢开始是指一开始向网络注入的报文段少，并不是指拥塞窗口cwnd增长速度慢;</p>
<p>拥塞避免并非指完全能够避免拥塞，而是指在拥塞避免阶段将拥塞窗口控制为按线性规律增长，使网络比较不容易出现拥塞.</p>
</blockquote>
<ul>
<li>所谓快重传，就是使发送方<strong>尽快进行重传</strong>，而<strong>不是等超时重传计时器超时</strong>再重传。<ul>
<li>要求接收方不要等待自己发送数据时才进行捎带确认，而是要<strong>立即发送确认</strong>;</li>
<li>即使收到了失序的报文段也要立即发出对已收到的报文段的<strong>重复确认</strong>。</li>
<li>发送方一旦<strong>收到3个连续的重复确认</strong>，就将相应的报文段<strong>立即重传</strong>，而不是等该报文段的超时重传计时器超时再重传。</li>
<li>对于个别丢失的报文段，发送方不会出现超时重传，也就不会误认为出现了拥塞（进而降低拥塞窗口cwnd为1)。使用快重传可以使整个网络的吞吐量提高约20%。</li>
</ul>
</li>
<li>发送方一旦<strong>收到3个重复确认</strong>，就知道现在只是丢失了个别的报文段。于是不启动慢开始算法，而执行快恢复算法;<ul>
<li><strong>发送方将慢开始门限ssthresh值和拥塞窗口cwnd值调整为当前窗口的一半;开始执行拥塞避免算法</strong>。</li>
<li>也有的快恢复实现是把快恢复开始时的拥塞窗口cwnd值再增大一些，即等于新的ssthresh + 3。<ul>
<li>既然发送方收到3个重复的确认，就表明有3个数据报文段已经离开了网络;</li>
<li>这3个报文段不再消耗网络资源而是停留在接收方的接收缓存中;</li>
<li>可见现在网络中不是堆积了报文段而是减少了3个报文段。因此可以适当把拥塞窗口扩大些。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.5ftqrwvw4n80.webp" alt="image"></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.434aom9plea0.webp" alt="image"></p>
<h2 id="TCP超时重传时间的选择"><a href="#TCP超时重传时间的选择" class="headerlink" title="TCP超时重传时间的选择"></a>TCP超时重传时间的选择</h2><p>存在的问题：</p>
<ul>
<li><p>如果超时重传时间RTO的值设置得比RTT0的值小很多，这会引起报文段不必要的重传，使网络负荷增大</p>
</li>
<li><p>如果超时重传时间RTO的值设置得远大于RTT0的值，这会使重传时间推迟的太长，使网络的空闲时间增大，降低传输效率</p>
</li>
</ul>
<p><strong>举例：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022154350745-170124572999443.png" alt="image-20201022154350745"></p>
<p><strong>总结：</strong></p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022154418863-170124572999444.png" alt="image-20201022154418863"></p>
<h2 id="TCP可靠传输的实现"><a href="#TCP可靠传输的实现" class="headerlink" title="TCP可靠传输的实现"></a>TCP可靠传输的实现</h2><ul>
<li><strong>TCP</strong>基于以<code>字节</code>为单位的<mark><strong>滑动窗口</strong></mark>来实现<code>可靠传输</code></li>
</ul>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image.58li4eiigd80.webp" alt="image"></p>
<ul>
<li>虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收方的接收窗口<code>一样大</code>。<mark>因为发送窗口是从接收方的接收窗口和拥塞窗口中取最小值。</mark></li>
</ul>
<p>🌈补充：</p>
<ol>
<li>对于不按序到达的数据应如何处理，TCP并无明确规定。</li>
<li>TCP要求接收方必须有<code>累积确认和捎带确认</code>机制</li>
<li>TCP的通信是<strong>全双工通信</strong>。通信中的每一方都在发送和接收报文段。因此，每一方都有自己的发送窗口和接收窗口。在谈到这些窗口时，一定要弄清楚是哪一方的窗口。</li>
</ol>
<h2 id="TCP的运输连接管理⭐⭐⭐"><a href="#TCP的运输连接管理⭐⭐⭐" class="headerlink" title="TCP的运输连接管理⭐⭐⭐"></a>TCP的运输连接管理⭐⭐⭐</h2><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022193215183-170124013647719.png" alt="image-20201022193215183"></p>
<h3 id="TCP的连接建立"><a href="#TCP的连接建立" class="headerlink" title="TCP的连接建立"></a>TCP的连接建立</h3><ul>
<li>TCP 连接的建立<strong>采用客户服务器方式</strong>。</li>
<li>主动发起连接建立的应用进程叫做<strong>TCP客户</strong> (client)。</li>
<li>被动等待连接建立的应用进程叫做<strong>TCP服务器</strong> (server)。</li>
</ul>
<p>“握手”需要在TCP客户端和服务器之间交换三个TCP报文段</p>
<p>过程</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022194219693.png" alt="image-20201022194219693"></p>
<blockquote>
<p>最初两端的TCP进程都处于关闭状态</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022194350899.png" alt="image-20201022194350899"></p>
<blockquote>
<p>一开始，TCP服务器进程首先创建传输控制块，用来存储TCP连接中的一些重要信息。例如TCP连接表、指向发送和接收缓存的指针、指向重传队列的指针，当前的发送和接收序号等</p>
<p>之后，就准备接受TCP客户端进程的连接请求</p>
<p>此时，TCP服务器进程就进入监听状态，等待TCP客户端进程的连接请求</p>
</blockquote>
<p>TCP服务器进程是被动等待来自TCP客户端进程的连接请求，因此成为<strong>被动打开</strong>连接</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022194926877.png" alt="image-20201022194926877"></p>
<blockquote>
<p>TCP客户进程也是首先创建传输控制块</p>
</blockquote>
<p>由于TCP连接建立是由TCP客户端主动发起的，因此称为<strong>主动打开</strong>连接</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022195108616.png" alt="image-20201022195108616"></p>
<blockquote>
<p>然后，在打算建立TCP连接时，向TCP服务器进程发送TCP连接请求报文段，并进入同步已发送状态</p>
<p>TCP连接请求报文段首部中</p>
<ul>
<li>同步位SYN被设置为1，表明这是一个TCP连接请求报文段</li>
<li>序号字段seq被设置了一个初始值x，作为TCP客户端进程所选择的初始序号</li>
</ul>
<p>请注意：TCP规定SYN被设置为1的报文段不能携带数据，但要消耗掉一个序号</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022195847144.png" alt="image-20201022195847144"></p>
<blockquote>
<p>TCP服务器进程收到TCP连接请求报文段后，如果同意建立连接，则向TCP客户进程发送TCP连接请求确认报文段，并进入同步已接收状态</p>
<p>TCP连接请求确认报文段首部中</p>
<ul>
<li>同步位SYN和确认为ACK都设置为1，表明这是一个TCP连接请求确认报文段</li>
<li>序号字段seq被设置了一个初始值y，作为TCP服务器进程所选择的初始序号，</li>
<li>确认号字段ack的值被设置成了x+1，这是对TCP客户进程所选择的初始序号（seq）的确认</li>
</ul>
<p>请注意：这个报文段也不能携带数据，因为它是SYN被设置为1的报文段，但同样要消耗掉一个序号</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022202010182.png" alt="image-20201022202010182"></p>
<blockquote>
<p>TCP客户进程收到TCP连接请求确认报文段后，还要向TCP服务器进程发送一个普通的TCP确认报文段，并进入连接已连接状态</p>
<p>普通的TCP确认报文段首部中</p>
<ul>
<li>确认位ACK被设置为1，表明这是一个普通的TCP确认报文段</li>
<li>序号字段seq被设置为x+1，这是因为TCP客户进程发送的第一个TCP报文段的序号为x，所以TCP客户进程发送的第二个报文段的序号为x+1</li>
<li>确认号字段ack被设置为y+1，这是对TCP服务器进程所选择的初始序号的确认</li>
</ul>
<p>请注意：TCP规定普通的TCP确认报文段可以携带数据，但如果不携带数据，则不消耗序号</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022202932905.png" alt="image-20201022202932905"></p>
<blockquote>
<p>TCP服务器进程收到该确认报文段后也进入连接已建立状态</p>
<p>现在，TCP双方都进入了连接已建立状态，它们可以基于已建立好的TCP连接，进行可靠的数据传输</p>
</blockquote>
<p>为什么TCP客户进程最后还要发送一个普通的TCP确认报文段？能否使用“两报文握手”建立连接？</p>
<p>下图实例是“两报文握手”</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022203744174.png" alt="image-20201022203744174"></p>
<blockquote>
<p>为了防止已经失效的连接请求报文段突然又传到服务端，因而产生错误”，这种情况是：一端(client)A发出去的第一个连接请求报文并没有&gt; 丢失，而是因为某些未知的原因在某个网络节点上发生滞留，导致延迟到连接释放以后的某个时间才到达另一端(server)B。本来这是一个早已失效的报文段，但是B收到此失效的报文之后，会误认为是A再次发出的一个新的连接请求，于是B端就向A又发出确认报文，表示同意建立连接。如果不采用“三次握手”，那么只要B端发出确认报文就会认为新的连接已经建立了，但是A端并没有发出建立连接的请求，因此不会去向B端发送数据，B端没有收到数据就会一直等待，这样B端就会白白浪费掉很多资源。</p>
<p><mark>所以并不<strong>多余</strong>，这是为了防止已失效的连接请求报文段突然又传送到了TCP服务器，因而导致错误</mark></p>
</blockquote>
<h3 id="TCP的连接释放"><a href="#TCP的连接释放" class="headerlink" title="TCP的连接释放"></a>TCP的连接释放</h3><ul>
<li>TCP 连接的建立<strong>采用客户服务器方式</strong>。</li>
<li>主动发起连接建立的应用进程叫做<strong>TCP客户</strong> (client)。</li>
<li>被动等待连接建立的应用进程叫做<strong>TCP服务器</strong> (server)。</li>
<li><strong>任何一方都可以在数据传送结束后发出连接释放的通知</strong></li>
</ul>
<p>过程</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022205124204.png" alt="image-20201022205124204"></p>
<blockquote>
<p>现在TCP客户进程和TCP服务器进程都处于连接已建立状态</p>
<p>TCP客户进程的应用进程通知其主动关闭TCP连接</p>
<p>TCP客户进程会发送TCP连接释放报文段，并进入终止等待1状态</p>
<p>TCP连接释放报文段首部中</p>
<ul>
<li>终止位FIN和确认为ACK的值都被设置为1，表明这是一个TCP连接释放报文段，同时也对之前收到的报文段进行确认</li>
<li>序号seq字段的值设置为u，它等于TCP客户进程之前已传送过的数据的最后一个字节的序号加1</li>
<li>确认号ack字段的值设置为v，它等于TCP客户进程之前已收到的、数据的最后一个字节的序号加1</li>
</ul>
<p>请注意：TCP规定终止位FIN等于1的报文段即使不携带数据，也要消耗掉一个序号</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022210030419.png" alt="image-20201022210030419"></p>
<blockquote>
<p>TCP服务器进程收到TCP连接释放报文段后，会发送一个普通的TCP确认报文段并进入关闭等待状态</p>
<p>普通的TCP确认报文段首部中</p>
<ul>
<li>确认位ACK的值被设置为1，表明这是一个普通的TCP确认报文段</li>
<li>序号seq字段的值设置为v，它等于TCP服务器进程之前已传送过的数据的最后一个字节的序号加1，这也与之前收到的TCP连接释放报文段中的确认号匹配</li>
<li>确认号ack字段的值设置为u+1，这是对TCP连接释放报文段的确认</li>
</ul>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022232158631.png" alt="image-20201022232158631"></p>
<blockquote>
<p>TCP服务器进程应该通知高层应用进程，TCP客户进程要断开与自己的TCP连接</p>
<p>此时，从TCP客户进程到TCP服务器进程这个方向的连接就释放了</p>
<p>这时的TCP连接属于半关闭状态，也就是TCP客户进程已经没有数据要发送了</p>
<p>但如果TCP服务器进程还有数据要发送，TCP客户进程仍要接收，也就是说从TCP服务器进程到TCP客户进程这个方向的连接并未关闭</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022233050922.png" alt="image-20201022233050922"></p>
<blockquote>
<p>TCP客户进程收到TCP确认报文段后就进入终止等待2状态，等待TCP服务器进程发出的TCP连接释放报文段</p>
<p>若使用TCP服务器进程的应用进程已经没有数据要发送了，应用进程就通知其TCP服务器进程释放连接</p>
<p>由于TCP连接释放是由TCP客户进程主动发起的，因此TCP服务器进程对TCP连接的释放称为被动关闭连接</p>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022233941557.png" alt="image-20201022233941557"></p>
<blockquote>
<p>TCP服务器进程发送TCP连接释放报文段并进入最后确认状态</p>
<p>该报文段首部中</p>
<ul>
<li>终止位FIN和确认位ACK的值都被设置为1，表明这是一个TCP连接释放报文段，同时也对之前收到的报文段进行确认</li>
<li>序号seq字段的值为w，这是因为在半关闭状态下，TCP服务器进程可能又发送</li>
<li>确认号ack字段的值为u+1，这是对之前收到的TCP连接释放报文段的重复确认</li>
</ul>
</blockquote>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022234741310.png" alt="image-20201022234741310"></p>
<blockquote>
<p>TCP客户进程收到TCP连接释放报文段后，必须针对该报文段发送普通的TCP确认报文段，之后进入时间等待状态</p>
<p>该报文段首部中</p>
<ul>
<li>确认为ACK的值被设置为1，表明这是一个普通的TCP确认报文段</li>
<li>序号seq字段的值设置为u+1，这是因为TCP客户进程之前发送的TCP连接释放报文段虽然不携带数据，但要消耗掉一个序号</li>
<li>确认号ack字段的值设置为w+1，这是对所收到的TCP连接释放报文段的确认</li>
</ul>
<p>TCP服务器进程收到该报文段后就进入关闭状态，而TCP客户进程还要进过2MSL后才能进入关闭状态</p>
</blockquote>
<p>TCP客户进程在发送完最后一个确认报文后，为什么不直接进入关闭状态？而是要进入时间等待状态？</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022234942562.png" alt="image-20201022234942562"></p>
<blockquote>
<p>因为时间等待状态以及处于该状态2MSL时长，可以确保TCP服务器进程可以收到最后一个TCP确认报文段而进入关闭状态</p>
<p>另外，TCP客户进程在发送完最后一个TCP确认报文段后，在经过2MSL时长，就可以使本次连接持续时间内所产生的所有报文段都从网络中消失，这样就可以使下一个新的TCP连接中，不会出现旧连接中的报文段</p>
</blockquote>
<h3 id="TCP保活计时器的作用"><a href="#TCP保活计时器的作用" class="headerlink" title="TCP保活计时器的作用"></a>TCP保活计时器的作用</h3><p>TCP双方已经建立了连接，后来，TCP客户进程所在的主机突然出现了故障</p>
<p>TCP服务器进程以后就不能再收到TCP客户进程发来的数据</p>
<p>因此，应当有措施使TCP服务器进程不要再白白等待下去</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201022235800155.png" alt="image-20201022235800155"></p>
<h2 id="首部格式"><a href="#首部格式" class="headerlink" title="首部格式"></a>首部格式</h2><h3 id="UDP用户数据报的首部格式"><a href="#UDP用户数据报的首部格式" class="headerlink" title="UDP用户数据报的首部格式"></a>UDP用户数据报的首部格式</h3><p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201021205214512-170124400660329.png" alt="image-20201021205214512"></p>
<h3 id="TCP报文段的首部格式"><a href="#TCP报文段的首部格式" class="headerlink" title="TCP报文段的首部格式"></a>TCP报文段的首部格式</h3><p>源端口和目的端口：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201023005210010.png" alt="image-20201023005210010"></p>
<p>序号、确认号和确认标志位：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201023003826059.png" alt="image-20201023003826059"></p>
<p>数据偏移（<mark><strong>首部长度</strong></mark>）、保留、窗口和校验和：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201023004227265.png" alt="image-20201023004227265"></p>
<p>同步标志位、终止标志位、复位标志位、推送标志位、紧急标志位和紧急指针：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201023005001450.png" alt="image-20201023005001450"></p>
<p>选项和填充：</p>
<p><img src="/../assets/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/image-20201023005132426.png" alt="image-20201023005132426"></p>
<h1 id="应用层✏️"><a href="#应用层✏️" class="headerlink" title="应用层✏️"></a>应用层✏️</h1><h2 id="概述-4"><a href="#概述-4" class="headerlink" title="概述"></a>概述</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://PlanBBBBB.github.io">PlanB</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://planbbbbb.github.io/2023/10/03/Study-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">https://planbbbbb.github.io/2023/10/03/Study-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://PlanBBBBB.github.io" target="_blank">PlanB's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/408/">408</a></div><div class="post_share"><div class="social-share" data-image="/../img/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/03/%E9%9D%A2%E8%AF%95-SpringBoot/"><img class="prev-cover" src="/../img/springboot.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SpringBoot面试题</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/03/Study-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><img class="next-cover" src="/../img/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">操作系统</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/10/03/Study-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><img class="cover" src="/../img/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-03</div><div class="title">操作系统</div></div></a></div><div><a href="/2023/10/03/Study-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="数据结构与算法"><img class="cover" src="/../img/structure.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-03</div><div class="title">数据结构与算法</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">PlanB</div><div class="author-info__description">欢迎来到PlanB的博客</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/PlanBBBBB"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/PlanBBBBB" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2741718884@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到PlanB的博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">写在前面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E4%BA%A4%E6%8D%A2%E6%96%B9%E5%BC%8F"><span class="toc-number">2.2.</span> <span class="toc-text">三种交换方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.2.1.</span> <span class="toc-text">电路交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E2%AD%90%E2%AD%90%E2%AD%90"><span class="toc-number">2.2.2.</span> <span class="toc-text">分组交换⭐⭐⭐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E6%96%87%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.2.3.</span> <span class="toc-text">报文交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">2.2.4.</span> <span class="toc-text">对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E4%B8%AA%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87"><span class="toc-number">2.3.</span> <span class="toc-text">八个性能指标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9F%E7%8E%87"><span class="toc-number">2.3.1.</span> <span class="toc-text">速率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%AE%BD"><span class="toc-number">2.3.2.</span> <span class="toc-text">带宽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%9E%E5%90%90%E9%87%8F"><span class="toc-number">2.3.3.</span> <span class="toc-text">吞吐量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E5%BB%B6"><span class="toc-number">2.3.4.</span> <span class="toc-text">时延</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E5%BB%B6%E5%B8%A6%E5%AE%BD%E7%A7%AF"><span class="toc-number">2.3.5.</span> <span class="toc-text">时延带宽积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%80%E8%BF%94%E6%97%B6%E9%97%B4"><span class="toc-number">2.3.6.</span> <span class="toc-text">往返时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E7%8E%87"><span class="toc-number">2.3.7.</span> <span class="toc-text">利用率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A2%E5%8C%85%E7%8E%87"><span class="toc-number">2.3.8.</span> <span class="toc-text">丢包率</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.4.</span> <span class="toc-text">计算机网络体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%8F%E4%B8%80%E5%B1%82%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">2.4.1.</span> <span class="toc-text">每一层解决的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%BF%9B%E7%A8%8B%E9%97%B4%E5%9F%BA%E4%BA%8E%E7%BD%91%E7%BB%9C%E7%9A%84%E9%80%9A%E4%BF%A1%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">2.4.2.</span> <span class="toc-text">应用进程间基于网络的通信的流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%AD%E7%9A%84%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="toc-number">2.4.3.</span> <span class="toc-text">计算机网络中的相关术语</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%E2%9C%8F%EF%B8%8F"><span class="toc-number">3.</span> <span class="toc-text">物理层✏️</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">3.1.</span> <span class="toc-text">物理层的基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BC%A0%E8%BE%93%E5%AA%92%E4%BD%93"><span class="toc-number">3.2.</span> <span class="toc-text">物理层下面的传输媒体</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%BC%95%E5%9E%8B%E4%BC%A0%E8%BE%93%E5%AA%92%E4%BD%93"><span class="toc-number">3.2.1.</span> <span class="toc-text">导引型传输媒体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%BC%95%E5%AF%BC%E5%9E%8B%E4%BC%A0%E8%BE%93%E5%AA%92%E4%BD%93"><span class="toc-number">3.2.2.</span> <span class="toc-text">非引导型传输媒体</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E6%96%B9%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text">传输方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B2%E8%A1%8C%E4%B8%8E%E5%B9%B6%E8%A1%8C"><span class="toc-number">3.3.1.</span> <span class="toc-text">串行与并行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%BC%82%E6%AD%A5"><span class="toc-number">3.3.2.</span> <span class="toc-text">同步与异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%90%91%E9%80%9A%E4%BF%A1-%E5%8F%8C%E5%90%91%E4%BA%A4%E6%9B%BF%E9%80%9A%E4%BF%A1-%E5%8F%8C%E6%96%B9%E5%90%8C%E6%97%B6%E9%80%9A%E4%BF%A1-%E5%8D%95%E5%B7%A5-%E5%8D%8A%E5%8F%8C%E5%B7%A5-%E5%85%A8%E5%8F%8C%E5%B7%A5"><span class="toc-number">3.3.3.</span> <span class="toc-text">单向通信&#x2F;双向交替通信&#x2F;双方同时通信(单工&#x2F;半双工&#x2F;全双工)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E4%B8%8E%E8%B0%83%E5%88%B6%E2%9C%8F%EF%B8%8F"><span class="toc-number">3.4.</span> <span class="toc-text">编码与调制✏️</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F"><span class="toc-number">3.4.1.</span> <span class="toc-text">常见编码方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%B0%83%E5%88%B6%E6%96%B9%E5%BC%8F%E2%9C%8F%EF%B8%8F"><span class="toc-number">3.4.2.</span> <span class="toc-text">常见调制方式✏️</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E9%81%93%E7%9A%84%E6%9E%81%E9%99%90%E5%AE%B9%E9%87%8F%E2%9C%8F%EF%B8%8F"><span class="toc-number">3.5.</span> <span class="toc-text">信道的极限容量✏️</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%A0%E6%88%90%E4%BF%A1%E5%8F%B7%E5%A4%B1%E7%9C%9F%E7%9A%84%E5%9B%A0%E7%B4%A0"><span class="toc-number">3.5.1.</span> <span class="toc-text">造成信号失真的因素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%88%E6%B0%8F%E5%87%86%E5%88%99%E5%92%8C%E9%A6%99%E5%86%9C%E5%85%AC%E5%BC%8F"><span class="toc-number">3.5.2.</span> <span class="toc-text">奈氏准则和香农公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%88%E6%B0%8F%E5%87%86%E5%88%99%E5%92%8C%E9%A6%99%E5%86%9C%E5%85%AC%E5%BC%8F%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">3.5.3.</span> <span class="toc-text">奈氏准则和香农公式的意义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9A%E4%BF%A1%E9%81%93%E5%A4%8D%E7%94%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">3.6.</span> <span class="toc-text">补充：信道复用技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%91%E5%88%86%E5%A4%8D%E7%94%A8%E3%80%81%E6%97%B6%E5%88%86%E5%A4%8D%E7%94%A8%E5%92%8C%E7%BB%9F%E8%AE%A1%E6%97%B6%E5%88%86%E5%A4%8D%E7%94%A8"><span class="toc-number">3.6.1.</span> <span class="toc-text">频分复用、时分复用和统计时分复用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A2%E5%88%86%E5%A4%8D%E7%94%A8-WDM"><span class="toc-number">3.6.2.</span> <span class="toc-text">波分复用(WDM)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%81%E5%88%86%E5%A4%8D%E7%94%A8-CDMA"><span class="toc-number">3.6.3.</span> <span class="toc-text">码分复用(CDMA)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text">数据链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="toc-number">4.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E4%B8%AA%E9%87%8D%E8%A6%81%E9%97%AE%E9%A2%98"><span class="toc-number">4.2.</span> <span class="toc-text">三个重要问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%81%E8%A3%85%E6%88%90%E5%B8%A7"><span class="toc-number">4.3.</span> <span class="toc-text">封装成帧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E4%BC%A0%E8%BE%93"><span class="toc-number">4.3.2.</span> <span class="toc-text">透明传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A7%E7%9A%84%E6%95%B0%E6%8D%AE%E9%83%A8%E5%88%86%E9%95%BF%E5%BA%A6"><span class="toc-number">4.3.3.</span> <span class="toc-text">帧的数据部分长度</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B"><span class="toc-number">4.4.</span> <span class="toc-text">差错检测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-3"><span class="toc-number">4.4.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E6%A0%A1%E9%AA%8C%E6%96%B9%E5%BC%8F"><span class="toc-number">4.4.2.</span> <span class="toc-text">两种校验方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A5%87%E5%81%B6%E6%A0%A1%E9%AA%8C"><span class="toc-number">4.4.2.1.</span> <span class="toc-text">奇偶校验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A0%A1%E9%AA%8CCRC-Cyclic-Redundancy-Check-%E2%AD%90%E2%AD%90%E2%AD%90"><span class="toc-number">4.4.2.2.</span> <span class="toc-text">循环冗余校验CRC(Cyclic Redundancy Check)⭐⭐⭐</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.4.3.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93"><span class="toc-number">4.5.</span> <span class="toc-text">可靠传输</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-4"><span class="toc-number">4.5.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E5%8F%AF%E9%9D%A0%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.5.2.</span> <span class="toc-text">三种可靠协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2-%E7%AD%89%E5%BE%85%E5%8D%8F%E8%AE%AESW"><span class="toc-number">4.5.2.1.</span> <span class="toc-text">停止-等待协议SW</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2-%E7%AD%89%E5%BE%85%E5%8D%8F%E8%AE%AE%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E5%9B%9B%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="toc-number">4.5.2.1.1.</span> <span class="toc-text">停止-等待协议可能遇到的四个问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2-%E7%AD%89%E5%BE%85%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%BF%A1%E9%81%93%E5%88%A9%E7%94%A8%E7%8E%87"><span class="toc-number">4.5.2.1.2.</span> <span class="toc-text">停止-等待协议的信道利用率</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E9%80%80N%E5%B8%A7%E5%8D%8F%E8%AE%AEGBN"><span class="toc-number">4.5.2.2.</span> <span class="toc-text">回退N帧协议GBN</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8%E5%9B%9E%E9%80%80N%E5%B8%A7%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.5.2.2.1.</span> <span class="toc-text">为什么用回退N帧协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A0%E5%B7%AE%E9%94%99%E6%83%85%E5%86%B5%E6%B5%81%E7%A8%8B"><span class="toc-number">4.5.2.2.2.</span> <span class="toc-text">无差错情况流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B4%AF%E7%A7%AF%E7%A1%AE%E8%AE%A4"><span class="toc-number">4.5.2.2.3.</span> <span class="toc-text">累积确认</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%89%E5%B7%AE%E9%94%99%E6%83%85%E5%86%B5"><span class="toc-number">4.5.2.2.4.</span> <span class="toc-text">有差错情况</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E9%87%8D%E4%BC%A0%E5%8D%8F%E8%AE%AESR"><span class="toc-number">4.5.2.3.</span> <span class="toc-text">选择重传协议SR</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E5%AF%B9%E7%82%B9%E5%8D%8F%E8%AE%AEPPP"><span class="toc-number">4.6.</span> <span class="toc-text">点对点协议PPP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.6.1.</span> <span class="toc-text">帧格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E4%BC%A0%E8%BE%93-1"><span class="toc-number">4.6.2.</span> <span class="toc-text">透明传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B-1"><span class="toc-number">4.6.3.</span> <span class="toc-text">差错检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E7%8A%B6%E6%80%81"><span class="toc-number">4.6.4.</span> <span class="toc-text">工作状态</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AA%92%E4%BD%93%E6%8E%A5%E5%85%A5%E6%8E%A7%E5%88%B6%EF%BC%88%E4%BB%8B%E8%B4%A8%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%EF%BC%89MAC%E2%80%94%E5%B9%BF%E6%92%AD%E4%BF%A1%E9%81%93"><span class="toc-number">4.7.</span> <span class="toc-text">媒体接入控制（介质访问控制）MAC—广播信道</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AA%92%E4%BD%93%E6%8E%A5%E5%85%A5%E6%8E%A7%E5%88%B6%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">4.7.1.</span> <span class="toc-text">媒体接入控制的基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%88%92%E5%88%86%E4%BF%A1%E9%81%93"><span class="toc-number">4.7.2.</span> <span class="toc-text">静态划分信道</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%8E%A5%E5%85%A5%E6%8E%A7%E5%88%B6"><span class="toc-number">4.7.3.</span> <span class="toc-text">动态接入控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%8E%A5%E5%85%A5%EF%BC%88CSMA-CD%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="toc-number">4.7.3.1.</span> <span class="toc-text">随机接入（CSMA&#x2F;CD协议）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E5%9D%80%E6%8E%A5%E5%85%A5MA"><span class="toc-number">4.7.3.1.1.</span> <span class="toc-text">多址接入MA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%BD%E6%B3%A2%E7%9B%91%E5%90%ACCS"><span class="toc-number">4.7.3.1.2.</span> <span class="toc-text">载波监听CS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8BCD"><span class="toc-number">4.7.3.1.3.</span> <span class="toc-text">碰撞检测CD</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CD-%E5%8D%8F%E8%AE%AE%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">4.7.3.1.4.</span> <span class="toc-text">CSMA&#x2F;CD 协议工作流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%89%E7%94%A8%E6%9C%9F%EF%BC%88%E7%A2%B0%E6%92%9E%E7%AA%97%E5%8F%A3%EF%BC%89"><span class="toc-number">4.7.3.1.5.</span> <span class="toc-text">争用期（碰撞窗口）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%B8%A7%E9%95%BF"><span class="toc-number">4.7.3.1.6.</span> <span class="toc-text">最小帧长</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%B8%A7%E9%95%BF"><span class="toc-number">4.7.3.1.7.</span> <span class="toc-text">最大帧长</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%88%AA%E6%96%AD%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%8C%87%E6%95%B0%E9%80%80%E9%81%BF%E7%AE%97%E6%B3%95"><span class="toc-number">4.7.3.1.8.</span> <span class="toc-text">截断二进制指数退避算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%A1%E9%81%93%E5%88%A9%E7%94%A8%E7%8E%87"><span class="toc-number">4.7.3.1.9.</span> <span class="toc-text">信道利用率</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%A7%E5%8F%91%E9%80%81%E6%B5%81%E7%A8%8B"><span class="toc-number">4.7.3.1.10.</span> <span class="toc-text">帧发送流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%A7%E6%8E%A5%E6%94%B6%E6%B5%81%E7%A8%8B"><span class="toc-number">4.7.3.1.11.</span> <span class="toc-text">帧接收流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E7%89%B9%E6%80%A7"><span class="toc-number">4.7.3.1.12.</span> <span class="toc-text">重要特性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%AD%90%E2%AD%90%E2%AD%90%E4%BE%8B%E9%A2%98"><span class="toc-number">4.7.3.1.13.</span> <span class="toc-text">⭐⭐⭐例题</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%8E%A5%E5%85%A5%EF%BC%88CSMA-CA%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="toc-number">4.7.3.2.</span> <span class="toc-text">随机接入（CSMA&#x2F;CA协议）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%E8%A6%81%E4%BD%BF%E7%94%A8CSMA-CA%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.7.3.2.1.</span> <span class="toc-text">为什么无线局域网要使用CSMA&#x2F;CA协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%A7%E9%97%B4%E9%97%B4%E9%9A%94IFS%EF%BC%88InterFrame-Space%EF%BC%89"><span class="toc-number">4.7.3.2.2.</span> <span class="toc-text">帧间间隔IFS（InterFrame Space）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CA%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.7.3.2.3.</span> <span class="toc-text">CSMA&#x2F;CA协议的工作原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CA%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%80%80%E9%81%BF%E7%AE%97%E6%B3%95"><span class="toc-number">4.7.3.2.4.</span> <span class="toc-text">CSMA&#x2F;CA协议的退避算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSMA-CA%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%BF%A1%E9%81%93%E9%A2%84%E7%BA%A6%E5%92%8C%E8%99%9A%E6%8B%9F%E8%BD%BD%E6%B3%A2%E7%9B%91%E5%90%AC"><span class="toc-number">4.7.3.2.5.</span> <span class="toc-text">CSMA&#x2F;CA协议的信道预约和虚拟载波监听</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MAC%E5%9C%B0%E5%9D%80%E3%80%81IP%E5%9C%B0%E5%9D%80%E4%BB%A5%E5%8F%8AARP%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.8.</span> <span class="toc-text">MAC地址、IP地址以及ARP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MAC%E5%9C%B0%E5%9D%80"><span class="toc-number">4.8.1.</span> <span class="toc-text">MAC地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BF%E6%92%AD%E4%BF%A1%E9%81%93%E7%9A%84%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E5%BF%85%E9%A1%BB%E4%BD%BF%E7%94%A8%E5%9C%B0%E5%9D%80%EF%BC%88MAC%EF%BC%89"><span class="toc-number">4.8.1.1.</span> <span class="toc-text">广播信道的数据链路层必须使用地址（MAC）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IEEE-802%E5%B1%80%E5%9F%9F%E7%BD%91%E7%9A%84MAC%E5%9C%B0%E5%9D%80%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.8.1.2.</span> <span class="toc-text">IEEE 802局域网的MAC地址格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IEEE-802%E5%B1%80%E5%9F%9F%E7%BD%91%E7%9A%84MAC%E5%9C%B0%E5%9D%80%E5%8F%91%E9%80%81%E9%A1%BA%E5%BA%8F"><span class="toc-number">4.8.1.3.</span> <span class="toc-text">IEEE 802局域网的MAC地址发送顺序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E6%92%ADMAC%E5%9C%B0%E5%9D%80%E4%B8%BE%E4%BE%8B"><span class="toc-number">4.8.1.4.</span> <span class="toc-text">单播MAC地址举例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%BF%E6%92%ADMAC%E5%9C%B0%E5%9D%80%E4%B8%BE%E4%BE%8B"><span class="toc-number">4.8.1.5.</span> <span class="toc-text">广播MAC地址举例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E6%92%ADMAC%E5%9C%B0%E5%9D%80%E4%B8%BE%E4%BE%8B"><span class="toc-number">4.8.1.6.</span> <span class="toc-text">多播MAC地址举例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E5%9C%B0%E5%9D%80"><span class="toc-number">4.8.2.</span> <span class="toc-text">IP地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-5"><span class="toc-number">4.8.2.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8E%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E7%9C%8BIP%E5%9C%B0%E5%9D%80%E4%B8%8EMAC%E5%9C%B0%E5%9D%80"><span class="toc-number">4.8.2.2.</span> <span class="toc-text">从网络体系结构看IP地址与MAC地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BD%AC%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%ADIP%E5%9C%B0%E5%9D%80%E4%B8%8EMAC%E5%9C%B0%E5%9D%80%E7%9A%84%E5%8F%98%E5%8C%96%E6%83%85%E5%86%B5"><span class="toc-number">4.8.2.3.</span> <span class="toc-text">数据包转发过程中IP地址与MAC地址的变化情况</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARP%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.8.3.</span> <span class="toc-text">ARP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B"><span class="toc-number">4.8.3.1.</span> <span class="toc-text">流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">4.8.3.2.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E7%BA%BF%E5%99%A8%E4%B8%8E%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">4.9.</span> <span class="toc-text">集线器与交换机的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%AD%90%E2%AD%90%E2%AD%90%E6%80%BB%E7%BB%93"><span class="toc-number">4.9.1.</span> <span class="toc-text">⭐⭐⭐总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BA%BF%E5%99%A8"><span class="toc-number">4.9.2.</span> <span class="toc-text">集线器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">4.9.3.</span> <span class="toc-text">交换机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E4%BA%A4%E6%8D%A2%E6%9C%BA%E8%87%AA%E5%AD%A6%E4%B9%A0%E5%92%8C%E8%BD%AC%E5%8F%91%E5%B8%A7%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">4.10.</span> <span class="toc-text">以太网交换机自学习和转发帧的流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-6"><span class="toc-number">4.10.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-number">4.10.2.</span> <span class="toc-text">例题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AESTP"><span class="toc-number">4.11.</span> <span class="toc-text">以太网交换机的生成树协议STP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%8F%90%E9%AB%98%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%9A%84%E5%8F%AF%E9%9D%A0%E6%80%A7"><span class="toc-number">4.11.1.</span> <span class="toc-text">如何提高以太网的可靠性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AESTP"><span class="toc-number">4.11.2.</span> <span class="toc-text">生成树协议STP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91VLAN"><span class="toc-number">4.12.</span> <span class="toc-text">虚拟局域网VLAN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91VLAN"><span class="toc-number">4.12.1.</span> <span class="toc-text">为什么要虚拟局域网VLAN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VLAN%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">4.12.2.</span> <span class="toc-text">VLAN基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91VLAN%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="toc-number">4.12.3.</span> <span class="toc-text">虚拟局域网VLAN的实现机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Access%E7%AB%AF%E5%8F%A3"><span class="toc-number">4.12.3.1.</span> <span class="toc-text">Access端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trunk%E7%AB%AF%E5%8F%A3"><span class="toc-number">4.12.3.2.</span> <span class="toc-text">Trunk端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hybrid%E7%AB%AF%E5%8F%A3"><span class="toc-number">4.12.3.3.</span> <span class="toc-text">Hybrid端口</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">5.</span> <span class="toc-text">网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E6%A6%82%E8%BF%B0"><span class="toc-number">5.1.</span> <span class="toc-text">网络层概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1"><span class="toc-number">5.2.</span> <span class="toc-text">网络层提供的两种服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%99%9A%E7%94%B5%E8%B7%AF%E6%9C%8D%E5%8A%A1"><span class="toc-number">5.2.1.</span> <span class="toc-text">面向连接的虚电路服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1"><span class="toc-number">5.2.2.</span> <span class="toc-text">无连接的数据报服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E7%94%B5%E8%B7%AF%E6%9C%8D%E5%8A%A1%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">5.2.3.</span> <span class="toc-text">虚电路服务与数据报服务的对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4"><span class="toc-number">5.3.</span> <span class="toc-text">IPv4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">5.3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%BC%96%E5%88%B6%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">5.3.2.</span> <span class="toc-text">分类编制的IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">5.3.2.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">5.3.2.2.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">5.3.3.</span> <span class="toc-text">划分子网的IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91"><span class="toc-number">5.3.3.1.</span> <span class="toc-text">为什么要划分子网</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91"><span class="toc-number">5.3.3.2.</span> <span class="toc-text">如何划分子网</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81"><span class="toc-number">5.3.3.3.</span> <span class="toc-text">子网掩码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-3"><span class="toc-number">5.3.3.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">5.3.4.</span> <span class="toc-text">无分类编址的IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80"><span class="toc-number">5.3.4.1.</span> <span class="toc-text">为什么使用无分类编址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80"><span class="toc-number">5.3.4.2.</span> <span class="toc-text">如何使用无分类编址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E8%81%9A%E5%90%88%EF%BC%88%E6%9E%84%E9%80%A0%E8%B6%85%E7%BD%91%EF%BC%89"><span class="toc-number">5.3.4.3.</span> <span class="toc-text">路由聚合（构造超网）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-4"><span class="toc-number">5.3.4.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv4%E5%9C%B0%E5%9D%80%E7%9A%84%E5%BA%94%E7%94%A8%E8%A7%84%E5%88%92"><span class="toc-number">5.3.5.</span> <span class="toc-text">IPv4地址的应用规划</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E9%95%BF%E7%9A%84%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81FLSM%EF%BC%88Fixed-Length-Subnet-Mask%EF%BC%89"><span class="toc-number">5.3.5.1.</span> <span class="toc-text">定长的子网掩码FLSM（Fixed Length Subnet Mask）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%95%BF%E7%9A%84%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81VLSM%EF%BC%88Variable-Length-Subnet-Mask%EF%BC%89"><span class="toc-number">5.3.5.2.</span> <span class="toc-text">变长的子网掩码VLSM（Variable Length Subnet Mask）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%9A%84%E5%8F%91%E9%80%81%E5%92%8C%E8%BD%AC%E5%8F%91%E8%BF%87%E7%A8%8B%E2%AD%90"><span class="toc-number">5.4.</span> <span class="toc-text">IP数据报的发送和转发过程⭐</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E9%80%81"><span class="toc-number">5.4.1.</span> <span class="toc-text">发送</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E5%8F%91"><span class="toc-number">5.4.2.</span> <span class="toc-text">转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98-1"><span class="toc-number">5.4.3.</span> <span class="toc-text">例题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E5%8F%8A%E5%85%B6%E5%8F%AF%E8%83%BD%E4%BA%A7%E7%94%9F%E7%9A%84%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF%E9%97%AE%E9%A2%98"><span class="toc-number">5.5.</span> <span class="toc-text">静态路由配置及其可能产生的路由环路问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">5.5.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-number">5.5.2.</span> <span class="toc-text">路由相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="toc-number">5.5.2.1.</span> <span class="toc-text">静态路由配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1"><span class="toc-number">5.5.2.2.</span> <span class="toc-text">默认路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E4%B8%BB%E6%9C%BA%E8%B7%AF%E7%94%B1"><span class="toc-number">5.5.2.3.</span> <span class="toc-text">特定主机路由</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E8%87%B4%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-number">5.5.3.</span> <span class="toc-text">导致路由环路的原因</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF"><span class="toc-number">5.5.3.1.</span> <span class="toc-text">静态路由配置错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E4%BA%86%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="toc-number">5.5.3.2.</span> <span class="toc-text">聚合了不存在的网络</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%95%85%E9%9A%9C%E8%80%8C%E5%AF%BC%E8%87%B4%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF"><span class="toc-number">5.5.3.3.</span> <span class="toc-text">网络故障而导致路由环路</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.6.</span> <span class="toc-text">路由选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">5.6.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AERIP"><span class="toc-number">5.6.2.</span> <span class="toc-text">路由信息协议RIP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-7"><span class="toc-number">5.6.2.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RIP%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">5.6.2.2.</span> <span class="toc-text">RIP的基本工作过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RIP%E7%9A%84%E8%B7%AF%E7%94%B1%E6%9D%A1%E7%9B%AE%E7%9A%84%E6%9B%B4%E6%96%B0%E8%A7%84%E5%88%99"><span class="toc-number">5.6.2.3.</span> <span class="toc-text">RIP的路由条目的更新规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF%E9%97%AE%E9%A2%98"><span class="toc-number">5.6.2.4.</span> <span class="toc-text">路由环路问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">5.6.2.5.</span> <span class="toc-text">优缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98-2"><span class="toc-number">5.6.2.6.</span> <span class="toc-text">例题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88OSPF"><span class="toc-number">5.6.3.</span> <span class="toc-text">开放最短路径优先OSPF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="toc-number">5.6.3.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E5%80%99%EF%BC%88Hello%EF%BC%89%E5%88%86%E7%BB%84"><span class="toc-number">5.6.3.2.</span> <span class="toc-text">问候（Hello）分组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E9%80%9A%E5%91%8ALSA"><span class="toc-number">5.6.3.3.</span> <span class="toc-text">发送链路状态通告LSA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5"><span class="toc-number">5.6.3.4.</span> <span class="toc-text">链路状态数据库同步</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OSPF%E4%BA%94%E7%A7%8D%E5%88%86%E7%BB%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.6.3.5.</span> <span class="toc-text">OSPF五种分组类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OSPF%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">5.6.3.6.</span> <span class="toc-text">OSPF的基本工作过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%82%BB%E5%B1%85%E5%85%B3%E7%B3%BB"><span class="toc-number">5.6.3.7.</span> <span class="toc-text">邻居关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BA%E5%9F%9F"><span class="toc-number">5.6.3.8.</span> <span class="toc-text">区域</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEBGP"><span class="toc-number">5.6.4.</span> <span class="toc-text">边界网关协议BGP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%9A%84%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F%E2%AD%90%E2%AD%90"><span class="toc-number">5.7.</span> <span class="toc-text">IPv4数据报的首部格式⭐⭐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%99%85%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AEICMP"><span class="toc-number">5.8.</span> <span class="toc-text">网际控制报文协议ICMP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">5.8.1.</span> <span class="toc-text">ICMP的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A%E6%8A%A5%E6%96%87%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">5.8.2.</span> <span class="toc-text">ICMP差错报告报文的种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84ICMP%E8%AF%A2%E9%97%AE%E6%8A%A5%E6%96%87"><span class="toc-number">5.8.3.</span> <span class="toc-text">常用的ICMP询问报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="toc-number">5.8.4.</span> <span class="toc-text">ICMP应用举例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN%E4%B8%8E%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT"><span class="toc-number">5.9.</span> <span class="toc-text">虚拟专用网VPN与网络地址转换NAT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN"><span class="toc-number">5.9.1.</span> <span class="toc-text">虚拟专用网VPN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT"><span class="toc-number">5.9.2.</span> <span class="toc-text">网络地址转换NAT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%90%E8%BE%93%E5%B1%82"><span class="toc-number">6.</span> <span class="toc-text">运输层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-3"><span class="toc-number">6.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%BE%93%E5%B1%82%E7%AB%AF%E5%8F%A3%E5%8F%B7%E3%80%81%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%88%86%E7%94%A8%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">6.2.</span> <span class="toc-text">运输层端口号、复用与分用的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP%E5%92%8CTCP%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">6.3.</span> <span class="toc-text">UDP和TCP的对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E7%9A%84%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">6.4.</span> <span class="toc-text">TCP的流量控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E7%9A%84%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">6.5.</span> <span class="toc-text">TCP的拥塞控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E7%AA%97%E5%8F%A3%E4%B8%8E%E7%8A%B6%E6%80%81%E5%8F%98%E9%87%8F"><span class="toc-number">6.5.1.</span> <span class="toc-text">拥塞窗口与状态变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E8%B6%85%E6%97%B6%E9%87%8D%E4%BC%A0%E6%97%B6%E9%97%B4%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">6.6.</span> <span class="toc-text">TCP超时重传时间的选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">6.7.</span> <span class="toc-text">TCP可靠传输的实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP%E7%9A%84%E8%BF%90%E8%BE%93%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86%E2%AD%90%E2%AD%90%E2%AD%90"><span class="toc-number">6.8.</span> <span class="toc-text">TCP的运输连接管理⭐⭐⭐</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E7%9A%84%E8%BF%9E%E6%8E%A5%E5%BB%BA%E7%AB%8B"><span class="toc-number">6.8.1.</span> <span class="toc-text">TCP的连接建立</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E7%9A%84%E8%BF%9E%E6%8E%A5%E9%87%8A%E6%94%BE"><span class="toc-number">6.8.2.</span> <span class="toc-text">TCP的连接释放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E4%BF%9D%E6%B4%BB%E8%AE%A1%E6%97%B6%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">6.8.3.</span> <span class="toc-text">TCP保活计时器的作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F"><span class="toc-number">6.9.</span> <span class="toc-text">首部格式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UDP%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%9A%84%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F"><span class="toc-number">6.9.1.</span> <span class="toc-text">UDP用户数据报的首部格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E6%8A%A5%E6%96%87%E6%AE%B5%E7%9A%84%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F"><span class="toc-number">6.9.2.</span> <span class="toc-text">TCP报文段的首部格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E2%9C%8F%EF%B8%8F"><span class="toc-number">7.</span> <span class="toc-text">应用层✏️</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-4"><span class="toc-number">7.1.</span> <span class="toc-text">概述</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/01/11/%E9%9D%A2%E8%AF%95-JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="JVM相关面试题"><img src="/../img/jvm.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JVM相关面试题"/></a><div class="content"><a class="title" href="/2024/01/11/%E9%9D%A2%E8%AF%95-JVM%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="JVM相关面试题">JVM相关面试题</a><time datetime="2024-01-11T13:37:19.816Z" title="发表于 2024-01-11 21:37:19">2024-01-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/10/%E9%9D%A2%E7%BB%8F-%E4%BF%9D%E5%88%A9%E5%A8%81%E7%AC%94%E8%AF%95/" title="保利威笔试"><img src="/./img/num3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="保利威笔试"/></a><div class="content"><a class="title" href="/2024/01/10/%E9%9D%A2%E7%BB%8F-%E4%BF%9D%E5%88%A9%E5%A8%81%E7%AC%94%E8%AF%95/" title="保利威笔试">保利威笔试</a><time datetime="2024-01-10T13:22:50.980Z" title="发表于 2024-01-10 21:22:50">2024-01-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/08/%E9%9D%A2%E8%AF%95-MySQL%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="MySQL相关面试题"><img src="/../img/mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL相关面试题"/></a><div class="content"><a class="title" href="/2024/01/08/%E9%9D%A2%E8%AF%95-MySQL%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="MySQL相关面试题">MySQL相关面试题</a><time datetime="2024-01-08T14:29:14.733Z" title="发表于 2024-01-08 22:29:14">2024-01-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/08/%E9%9D%A2%E8%AF%95-Redis%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Redis相关面试题"><img src="/../img/redis.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis相关面试题"/></a><div class="content"><a class="title" href="/2024/01/08/%E9%9D%A2%E8%AF%95-Redis%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Redis相关面试题">Redis相关面试题</a><time datetime="2024-01-08T13:08:15.436Z" title="发表于 2024-01-08 21:08:15">2024-01-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/08/%E9%9D%A2%E8%AF%95-Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Java集合相关面试题"><img src="/../img/java%E9%9B%86%E5%90%88.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java集合相关面试题"/></a><div class="content"><a class="title" href="/2024/01/08/%E9%9D%A2%E8%AF%95-Java%E9%9B%86%E5%90%88%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Java集合相关面试题">Java集合相关面试题</a><time datetime="2024-01-08T09:53:49.916Z" title="发表于 2024-01-08 17:53:49">2024-01-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By PlanB</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://PlanBBBBB.github.io">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async src="/js/title.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="0基础,学IT" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(./img/project.png);"> <a class="categoryBar-list-link" href="categories/Project/">Project</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr">Poject</span></li><li class="categoryBar-list-item" style="background:url(./img/study.png);"> <a class="categoryBar-list-link" href="categories/Study/">Study</a><span class="categoryBar-list-count">12</span><span class="categoryBar-list-descr">Study</span></li><li class="categoryBar-list-item" style="background:url(./img/面试.png);"> <a class="categoryBar-list-link" href="categories/面经/">面经</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">面试</span></li><li class="categoryBar-list-item" style="background:url(./img/面经.png);"> <a class="categoryBar-list-link" href="categories/面试/">面试</a><span class="categoryBar-list-count">12</span><span class="categoryBar-list-descr">面经</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInLeft');
    arr[i].setAttribute('data-wow-duration', '800ms');
    arr[i].setAttribute('data-wow-delay', '0ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInRight');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/08/27/Study-JVM/" alt=""><img width="48" height="48" src="../img/jvm.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-08-27</span><a class="blog-slider__title" href="2023/08/27/Study-JVM/" alt="">JVM</a><div class="blog-slider__text">JVM学习</div><a class="blog-slider__button" href="2023/08/27/Study-JVM/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/01/05/Study-MySQL高级部分学习/" alt=""><img width="48" height="48" src="../img/mysql.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-05</span><a class="blog-slider__title" href="2023/01/05/Study-MySQL高级部分学习/" alt="">MySQL高级部分学习</a><div class="blog-slider__text">用于学习MySQL后续的进阶部分</div><a class="blog-slider__button" href="2023/01/05/Study-MySQL高级部分学习/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/08/03/Study-Redis相关知识/" alt=""><img width="48" height="48" src="../img/redis.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-08-03</span><a class="blog-slider__title" href="2023/08/03/Study-Redis相关知识/" alt="">Redis相关知识</a><div class="blog-slider__text">用于学习Redis相关知识</div><a class="blog-slider__button" href="2023/08/03/Study-Redis相关知识/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/09/05/Study-Java集合/" alt=""><img width="48" height="48" src="../img/java集合.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-09-05</span><a class="blog-slider__title" href="2023/09/05/Study-Java集合/" alt="">Java集合</a><div class="blog-slider__text">Java集合底层实现原理学习</div><a class="blog-slider__button" href="2023/09/05/Study-Java集合/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>